liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v3.02_eval_paircomp/MLP.py --learner adam --reg_layers [0,0,0,0] --lr 0.001 --batch_size_random 1280000
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=1280000, epochs=100, layers='[64,32,16,8]', learner='adam', lr=0.001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [36.2 s]. #user=13679, #item=12922, #train=3914489, #test=316795
Time: [73.2], Init: NDCG = 
[ 0.90904636  0.83115981  0.80129991  0.78695222  0.77958068  0.77648324
  0.77600488  0.77643927  0.77841595  0.78175209]
Iteration 0 [100.6 s]: loss = 0.301212 [73.35 s], NDCG = 
[ 0.96729246  0.85951918  0.8219233   0.8038006   0.79478628  0.79041683
  0.78916812  0.78885429  0.79017079  0.79311626]
Iteration 1 [101.4 s]: loss = 0.248668 [71.55 s], NDCG = 
[ 0.95078525  0.85248427  0.81743609  0.80027853  0.79217097  0.78841472
  0.78745907  0.78728694  0.78884575  0.79192477]
Iteration 2 [100.9 s]: loss = 0.218018 [71.39 s], NDCG = 
[ 0.91941906  0.83646239  0.80707897  0.79331755  0.78708814  0.78488665
  0.78508143  0.78598995  0.78817624  0.79190329]
Iteration 3 [104.2 s]: loss = 0.200349 [71.14 s], NDCG = 
[ 0.89110252  0.8173949   0.79344622  0.78329822  0.77962381  0.77951729
  0.78124217  0.78315761  0.78638108  0.79072768]
Iteration 4 [109.0 s]: loss = 0.191566 [71.37 s], NDCG = 
[ 0.89599347  0.8179647   0.79190966  0.78165936  0.77804475  0.77823885
  0.78028808  0.78247609  0.78588264  0.79054968]
Iteration 5 [113.3 s]: loss = 0.186478 [71.20 s], NDCG = 
[ 0.87438716  0.8101995   0.78881099  0.78011115  0.77690382  0.77696658
  0.77927433  0.78195641  0.78559049  0.79038794]
Iteration 6 [116.6 s]: loss = 0.183328 [71.30 s], NDCG = 
[ 0.86024697  0.80002486  0.78044753  0.77276964  0.771278    0.77305324
  0.77657462  0.78005891  0.78414488  0.78912399]
Iteration 7 [120.9 s]: loss = 0.181469 [71.29 s], NDCG = 
[ 0.86902929  0.80277202  0.78262663  0.77444721  0.77256279  0.77395832
  0.77684677  0.77998746  0.78379421  0.78878677]
Iteration 8 [122.5 s]: loss = 0.179790 [71.33 s], NDCG = 
[ 0.84759434  0.79084366  0.77239122  0.76658715  0.76601528  0.76826617
  0.77188475  0.77552202  0.78009564  0.78580545]
Iteration 9 [125.0 s]: loss = 0.177944 [71.23 s], NDCG = 
[ 0.83111974  0.78088779  0.76659722  0.76292527  0.76385935  0.76664979
  0.77044989  0.77426109  0.77864462  0.78460993]
Iteration 10 [126.8 s]: loss = 0.177759 [71.99 s], NDCG = 
[ 0.83574445  0.78525735  0.76937849  0.76431112  0.76405045  0.76645447
  0.76975443  0.77316545  0.77754233  0.78378593]
Iteration 11 [128.4 s]: loss = 0.177210 [71.39 s], NDCG = 
[ 0.83068502  0.78111947  0.76473203  0.76041628  0.76076155  0.76317838
  0.76678803  0.77012283  0.77455777  0.78104449]
Iteration 12 [129.3 s]: loss = 0.176515 [65.92 s], NDCG = 
[ 0.82763533  0.77731298  0.76245825  0.7577717   0.75834016  0.76102417
  0.76430592  0.76732654  0.77173671  0.77868253]
Iteration 13 [126.1 s]: loss = 0.175935 [63.71 s], NDCG = 
[ 0.8235858   0.77804137  0.76294489  0.75941411  0.75987571  0.76170457
  0.7646069   0.76787268  0.77241541  0.77899166]
Iteration 14 [126.6 s]: loss = 0.175363 [65.31 s], NDCG = 
[ 0.82694358  0.77922131  0.76470497  0.75990712  0.75949495  0.76136589
  0.76383827  0.76642567  0.77049203  0.7772097 ]
Iteration 15 [134.0 s]: loss = 0.175418 [67.28 s], NDCG = 
[ 0.82839688  0.78133282  0.76587317  0.76130568  0.76050751  0.76120102
  0.76341326  0.76588126  0.76991191  0.77688896]
Iteration 16 [130.0 s]: loss = 0.174836 [67.22 s], NDCG = 
[ 0.85805225  0.79530345  0.77518956  0.76714076  0.76472397  0.76435433
  0.76557372  0.76706491  0.77056475  0.77678459]
Iteration 17 [135.6 s]: loss = 0.174595 [70.45 s], NDCG = 
[ 0.80457793  0.76545475  0.75388652  0.75140494  0.75229262  0.75441045
  0.75692137  0.75979462  0.76454718  0.77214185]
Iteration 18 [132.5 s]: loss = 0.174291 [69.65 s], NDCG = 
[ 0.82052514  0.77756823  0.76313202  0.75806104  0.75782948  0.75901057
  0.7606916   0.76286407  0.76704967  0.77402417]
Iteration 19 [133.5 s]: loss = 0.174282 [70.43 s], NDCG = 
[ 0.79970891  0.76324107  0.75241189  0.74934602  0.7503421   0.75185084
  0.75405127  0.75682031  0.76179753  0.76961888]
Iteration 20 [134.2 s]: loss = 0.173752 [69.64 s], NDCG = 
[ 0.83115253  0.78206144  0.76618723  0.76024444  0.75796889  0.75751164
  0.75811171  0.75992972  0.76400604  0.77123114]
Iteration 21 [134.3 s]: loss = 0.173331 [70.06 s], NDCG = 
[ 0.82938607  0.7825018   0.76615734  0.75988432  0.75778655  0.75695792
  0.75746749  0.75909686  0.76309608  0.77039979]
Iteration 22 [134.6 s]: loss = 0.173458 [70.31 s], NDCG = 
[ 0.83490587  0.78384612  0.76623085  0.75945118  0.75738303  0.75706319
  0.75772463  0.75950446  0.76317075  0.76999988]
Iteration 23 [137.9 s]: loss = 0.173045 [70.23 s], NDCG = 
[ 0.84185475  0.78581032  0.76800686  0.76114218  0.75855799  0.7573461
  0.75744482  0.75875598  0.76234389  0.76925946]
Iteration 24 [137.9 s]: loss = 0.172984 [70.43 s], NDCG = 
[ 0.82932884  0.78041293  0.76378618  0.75686774  0.7542212   0.75373837
  0.75430525  0.7557335   0.75950493  0.76726986]
Iteration 25 [137.7 s]: loss = 0.173216 [70.24 s], NDCG = 
[ 0.84570368  0.78809115  0.76928894  0.7609036   0.75754148  0.75631574
  0.75622676  0.75730402  0.76053804  0.76787687]
Iteration 26 [138.4 s]: loss = 0.172838 [69.90 s], NDCG = 
[ 0.85751427  0.79556515  0.77391014  0.76412092  0.75976837  0.75737154
  0.75698367  0.75793748  0.76122429  0.76800807]
Iteration 27 [139.8 s]: loss = 0.172562 [69.35 s], NDCG = 
[ 0.81961739  0.77434214  0.75931238  0.75302246  0.75077751  0.75015951
  0.75062282  0.75232277  0.75628765  0.76396554]
Iteration 28 [138.9 s]: loss = 0.172382 [71.37 s], NDCG = 
[ 0.81894734  0.77337561  0.75805932  0.75139078  0.74924198  0.74809967
  0.74853361  0.75025973  0.75462384  0.76280616]
Iteration 29 [140.2 s]: loss = 0.171993 [71.86 s], NDCG = 
[ 0.82069336  0.77278599  0.7559568   0.74933124  0.74618925  0.74494209
  0.74473222  0.7464133   0.75134766  0.76046133]
Iteration 30 [138.5 s]: loss = 0.172390 [71.69 s], NDCG = 
[ 0.83365256  0.78076619  0.76227881  0.75494005  0.7509058   0.74880643
  0.74828049  0.74928349  0.75346161  0.76181214]
Iteration 31 [143.2 s]: loss = 0.172231 [72.49 s], NDCG = 
[ 0.81229999  0.77000458  0.75414809  0.74791428  0.7456349   0.74494102
  0.74542979  0.74739722  0.75222233  0.76112321]
Iteration 32 [144.1 s]: loss = 0.171891 [72.55 s], NDCG = 
[ 0.86321738  0.79852471  0.77571564  0.76510829  0.75964823  0.75684719
  0.75601663  0.75638231  0.75967444  0.76654664]
Iteration 33 [142.6 s]: loss = 0.171900 [71.71 s], NDCG = 
[ 0.81048574  0.76545919  0.74903785  0.74195718  0.73924954  0.7377426
  0.73811157  0.74068164  0.74641582  0.75647836]
Iteration 34 [142.5 s]: loss = 0.171314 [71.92 s], NDCG = 
[ 0.86670377  0.79777771  0.77358025  0.76189978  0.75547465  0.75209166
  0.75069899  0.75113916  0.75463382  0.76211538]
Iteration 35 [143.8 s]: loss = 0.171627 [72.19 s], NDCG = 
[ 0.84513456  0.78626658  0.76544268  0.75593855  0.7508411   0.74778822
  0.74681     0.74743462  0.75130621  0.75944711]
Iteration 36 [143.5 s]: loss = 0.171880 [71.77 s], NDCG = 
[ 0.82890091  0.77371497  0.75438311  0.74539158  0.74032687  0.73758949
  0.73693244  0.73843915  0.74367854  0.75347464]
Iteration 37 [149.0 s]: loss = 0.171921 [72.65 s], NDCG = 
[ 0.83382392  0.77728078  0.75692312  0.74687523  0.74180598  0.73870604
  0.73812961  0.73966822  0.74480196  0.75443979]
Iteration 38 [148.2 s]: loss = 0.171159 [72.21 s], NDCG = 
[ 0.86495963  0.79491264  0.77032499  0.75849775  0.75220293  0.7489695
  0.74750319  0.74779247  0.75115087  0.75900568]
Iteration 39 [144.4 s]: loss = 0.171164 [71.84 s], NDCG = 
[ 0.84771225  0.7829786   0.76062202  0.74884539  0.74277423  0.73922046
  0.73785887  0.73876604  0.74348078  0.75266921]
Iteration 40 [145.5 s]: loss = 0.171619 [71.72 s], NDCG = 
[ 0.87440539  0.80066008  0.77424882  0.76092444  0.75408098  0.75023885
  0.74855049  0.74851596  0.75164597  0.75929058]
Iteration 41 [147.6 s]: loss = 0.170988 [71.45 s], NDCG = 
[ 0.85578428  0.78878463  0.76441947  0.75149238  0.74457207  0.74080191
  0.73944514  0.73990643  0.74414037  0.75308223]
Iteration 42 [152.7 s]: loss = 0.171073 [72.17 s], NDCG = 
[ 0.85927947  0.78924246  0.7635805   0.75037476  0.74283038  0.73871091
  0.73702186  0.73789405  0.74229941  0.75158041]
Iteration 43 [151.7 s]: loss = 0.171274 [72.06 s], NDCG = 
[ 0.83974494  0.7761329   0.7529651   0.74037871  0.7336986   0.72994328
  0.72875694  0.7301362   0.73589267  0.74653091]
Iteration 44 [152.3 s]: loss = 0.171232 [71.86 s], NDCG = 
[ 0.91941434  0.82758097  0.79577019  0.78026878  0.77191919  0.76732069
  0.76561044  0.76525621  0.76729157  0.77250197]
Iteration 45 [150.8 s]: loss = 0.170781 [71.56 s], NDCG = 
[ 0.85316351  0.78672154  0.76182414  0.74857517  0.74113295  0.73685353
  0.73524512  0.73579214  0.74055966  0.75016785]
Iteration 46 [150.1 s]: loss = 0.171250 [70.36 s], NDCG = 
[ 0.86677955  0.79354605  0.76732099  0.75370411  0.74579022  0.74188947
  0.74021416  0.74048708  0.7446409   0.75324575]
Iteration 47 [151.6 s]: loss = 0.171298 [71.08 s], NDCG = 
[ 0.88658858  0.80688332  0.77852561  0.76388319  0.75530052  0.75062027
  0.74880598  0.74879576  0.75218611  0.75968887]
Iteration 48 [147.2 s]: loss = 0.170616 [70.22 s], NDCG = 
[ 0.87683342  0.80046263  0.77128118  0.75587979  0.74722002  0.74207105
  0.73960161  0.739768    0.74396163  0.75271665]
Iteration 49 [149.8 s]: loss = 0.170793 [70.55 s], NDCG = 
[ 0.86245772  0.79221509  0.76542772  0.75147718  0.7435301   0.73884579
  0.73692667  0.73757824  0.74258855  0.75209367]
Iteration 50 [150.4 s]: loss = 0.170598 [70.64 s], NDCG = 
[ 0.88812048  0.80694649  0.77784961  0.76267675  0.75386032  0.74894408
  0.74654789  0.74658945  0.75009681  0.75758873]
Iteration 51 [149.8 s]: loss = 0.170471 [71.07 s], NDCG = 
[ 0.87086398  0.79596091  0.76739849  0.75245377  0.74400977  0.7394993
  0.73746608  0.73802153  0.74211735  0.75128682]
Iteration 52 [150.5 s]: loss = 0.170857 [71.22 s], NDCG = 
[ 0.87654005  0.80060942  0.7716629   0.75716344  0.74878969  0.74409533
  0.74191725  0.74215199  0.74583688  0.7540587 ]
Iteration 53 [149.7 s]: loss = 0.170796 [70.83 s], NDCG = 
[ 0.90352844  0.81563545  0.7832674   0.76672509  0.75742099  0.75200404
  0.74936718  0.74888851  0.7518802   0.75908952]
Iteration 54 [150.0 s]: loss = 0.170557 [70.59 s], NDCG = 
[ 0.87744058  0.79926375  0.77006832  0.75433208  0.74550639  0.74036158
  0.73816519  0.73837365  0.74264675  0.75153606]
Iteration 55 [151.1 s]: loss = 0.170891 [69.37 s], NDCG = 
[ 0.93949096  0.83990285  0.80476907  0.78744445  0.77840676  0.77367029
  0.77188204  0.77128364  0.77298784  0.7770224 ]
Iteration 56 [147.4 s]: loss = 0.170297 [68.88 s], NDCG = 
[ 0.9556982   0.850267    0.81358834  0.79558359  0.78617323  0.78136574
  0.7797045   0.779267    0.78069722  0.78396121]
Iteration 57 [151.7 s]: loss = 0.170599 [65.07 s], NDCG = 
[ 0.86352017  0.78857796  0.76062743  0.74550795  0.73660852  0.73143175
  0.7295478   0.7306017   0.73615134  0.7463594 ]
Iteration 58 [150.6 s]: loss = 0.170015 [67.78 s], NDCG = 
[ 0.86209581  0.78776017  0.76013734  0.74537906  0.7363862   0.73132041
  0.72948471  0.73051756  0.73567923  0.74607283]
Iteration 59 [155.5 s]: loss = 0.170668 [68.83 s], NDCG = 
[ 0.8774978   0.7984492   0.76854158  0.75272073  0.74348781  0.73819424
  0.73613534  0.73679438  0.74131262  0.75050104]
Iteration 60 [155.4 s]: loss = 0.170493 [67.48 s], NDCG = 
[ 0.86882271  0.79122996  0.76174534  0.74609822  0.73651004  0.73070343
  0.72850418  0.72929257  0.734695    0.74517675]
Iteration 61 [153.1 s]: loss = 0.170033 [64.19 s], NDCG = 
[ 0.84670577  0.78156775  0.75612698  0.7415111   0.73294846  0.72816325
  0.72655013  0.72812682  0.7341137   0.74479114]
Iteration 62 [155.2 s]: loss = 0.170256 [64.06 s], NDCG = 
[ 0.90694597  0.81674707  0.78516822  0.76927313  0.76056713  0.75600168
  0.75429349  0.75435701  0.75748265  0.76390496]
Iteration 63 [155.6 s]: loss = 0.170179 [63.98 s], NDCG = 
[ 0.85590942  0.78234444  0.75435812  0.73879626  0.72942598  0.72402953
  0.72269824  0.72448915  0.7308508   0.74241392]
Iteration 64 [156.8 s]: loss = 0.170446 [64.21 s], NDCG = 
[ 0.8657891   0.7930922   0.76545195  0.75061901  0.74232103  0.73787832
  0.73624415  0.73732645  0.7423956   0.75161412]
Iteration 65 [159.6 s]: loss = 0.170145 [64.62 s], NDCG = 
[ 0.87933281  0.79863421  0.76835885  0.7522514   0.7425299   0.73700561
  0.73489739  0.73525069  0.74008001  0.74953861]
Iteration 66 [168.7 s]: loss = 0.170704 [71.77 s], NDCG = 
[ 0.87644573  0.7962906   0.76612386  0.74951172  0.73940745  0.73348261
  0.73123811  0.73237949  0.73768962  0.74758743]
Iteration 67 [169.6 s]: loss = 0.170493 [71.76 s], NDCG = 
[ 0.88714669  0.80316586  0.77186586  0.7550759   0.74488872  0.73923125
  0.7369236   0.73754358  0.74243933  0.75154105]
Iteration 68 [169.3 s]: loss = 0.170352 [71.30 s], NDCG = 
[ 0.8602237   0.78756089  0.75958451  0.74435184  0.73500149  0.73006643
  0.72846532  0.73023995  0.73603682  0.74639116]
Iteration 69 [167.3 s]: loss = 0.170124 [69.96 s], NDCG = 
[ 0.8810955   0.80073532  0.77107929  0.75486205  0.74539052  0.7398202
  0.73781481  0.73808115  0.74260401  0.75167807]
Iteration 70 [164.1 s]: loss = 0.170432 [69.88 s], NDCG = 
[ 0.90000841  0.81266832  0.7803301   0.76367361  0.75391407  0.74808882
  0.74540249  0.74529806  0.74867528  0.7565199 ]
Iteration 71 [168.1 s]: loss = 0.170529 [70.00 s], NDCG = 
[ 0.90510814  0.81403665  0.78062806  0.76336182  0.75300212  0.74714443
  0.74462238  0.74452454  0.7482999   0.75623927]
Iteration 72 [166.0 s]: loss = 0.170496 [70.05 s], NDCG = 
[ 0.93940889  0.83835303  0.80254122  0.78515188  0.77595037  0.77137882
  0.76994824  0.76972537  0.77183966  0.77638133]
Iteration 73 [168.0 s]: loss = 0.170095 [70.06 s], NDCG = 
[ 0.88808212  0.80358096  0.77121444  0.75473078  0.74463989  0.73910103
  0.73723829  0.73816514  0.7429646   0.75195135]
Iteration 74 [166.6 s]: loss = 0.170202 [70.28 s], NDCG = 
[ 0.8612044   0.78693045  0.75678421  0.74025256  0.73022891  0.72486236
  0.72330502  0.7252711   0.73198149  0.74339224]
Iteration 75 [166.9 s]: loss = 0.170162 [70.12 s], NDCG = 
[ 0.86102329  0.78587664  0.75688195  0.74032952  0.73047766  0.72483945
  0.72297337  0.72486207  0.73173644  0.74315919]
Iteration 76 [169.6 s]: loss = 0.170374 [70.30 s], NDCG = 
[ 0.96252163  0.85443085  0.81643232  0.79789158  0.78818878  0.78330018
  0.78163552  0.78110217  0.78258055  0.78576047]
Iteration 77 [171.3 s]: loss = 0.170087 [68.29 s], NDCG = 
[ 0.87859831  0.79870988  0.76897864  0.7531675   0.74392846  0.73873234
  0.73683942  0.73791294  0.74319027  0.75242403]
Iteration 78 [168.9 s]: loss = 0.170365 [69.47 s], NDCG = 
[ 0.95210805  0.84673481  0.8091192   0.79070353  0.7807811   0.77546014
  0.77360125  0.77313269  0.7748818   0.77919215]
Iteration 79 [169.1 s]: loss = 0.170378 [70.31 s], NDCG = 
[ 0.88679076  0.80340454  0.77235778  0.75596099  0.74631307  0.7411444
  0.73917651  0.73963173  0.7444985   0.75336365]
Iteration 80 [171.9 s]: loss = 0.169936 [70.01 s], NDCG = 
[ 0.88506171  0.80180103  0.77023956  0.75448047  0.74540823  0.74032948
  0.73860664  0.73952183  0.74417735  0.75293385]
Iteration 81 [174.4 s]: loss = 0.170117 [69.65 s], NDCG = 
[ 0.93482231  0.83679278  0.80087143  0.78338654  0.77425322  0.76959341
  0.76791223  0.76781877  0.77016381  0.77509427]
Iteration 82 [172.2 s]: loss = 0.170067 [69.89 s], NDCG = 
[ 0.87808359  0.79678943  0.76536509  0.74824931  0.73800725  0.73202627
  0.72964221  0.73074996  0.73668102  0.74701827]
Iteration 83 [172.7 s]: loss = 0.170133 [70.10 s], NDCG = 
[ 0.88408258  0.80206482  0.77167311  0.75579375  0.74693571  0.74244524
  0.74068245  0.74117812  0.74572565  0.75420859]
Iteration 84 [175.5 s]: loss = 0.170236 [69.27 s], NDCG = 
[ 0.89446534  0.80923948  0.7778896   0.76172334  0.75242339  0.74783808
  0.74639679  0.74722305  0.75203275  0.76018126]
Iteration 85 [176.9 s]: loss = 0.170185 [70.43 s], NDCG = 
[ 0.86948678  0.7913251   0.76061618  0.7436519   0.73321138  0.7275886
  0.72584557  0.72769114  0.73440699  0.74512231]
Iteration 86 [172.9 s]: loss = 0.170230 [70.06 s], NDCG = 
[ 0.90664003  0.81802755  0.78632191  0.77066275  0.76227247  0.75784675
  0.75640614  0.75651451  0.75971296  0.76575768]
Iteration 87 [174.7 s]: loss = 0.170206 [69.92 s], NDCG = 
[ 0.92018941  0.82394647  0.78930733  0.77169344  0.76166317  0.75639585
  0.75447873  0.75498553  0.75874134  0.76579683]
Iteration 88 [172.7 s]: loss = 0.170125 [70.07 s], NDCG = 
[ 0.88879367  0.8026558   0.77019426  0.75314014  0.74377431  0.73904305
  0.73727989  0.73839552  0.74361151  0.75262176]
Iteration 89 [175.2 s]: loss = 0.170069 [69.85 s], NDCG = 
[ 0.9085112   0.81450155  0.77981317  0.76227643  0.75251569  0.74747608
  0.74516426  0.74548261  0.74937186  0.75718729]
Iteration 90 [175.3 s]: loss = 0.170289 [70.13 s], NDCG = 
[ 0.88832454  0.80420034  0.7718516   0.75455918  0.74454377  0.73910457
  0.73704185  0.73802504  0.74289034  0.75203032]
Iteration 91 [174.3 s]: loss = 0.170267 [69.98 s], NDCG = 
[ 0.91375965  0.82063426  0.78688779  0.77004132  0.76059455  0.75566781
  0.75405621  0.75421103  0.75734397  0.7639908 ]
Iteration 92 [173.0 s]: loss = 0.170079 [70.08 s], NDCG = 
[ 0.89349344  0.80936872  0.77851937  0.76184743  0.75219635  0.74669801
  0.7448775   0.74571616  0.75008199  0.75835094]
Iteration 93 [178.7 s]: loss = 0.170201 [69.88 s], NDCG = 
[ 0.8694261   0.78846062  0.75647851  0.73912693  0.7284028   0.72245801
  0.72042399  0.72229957  0.72915898  0.74074754]
Iteration 94 [180.1 s]: loss = 0.170302 [70.09 s], NDCG = 
[ 0.85150207  0.78053122  0.75139621  0.73482685  0.72473786  0.7190223
  0.7175216   0.72057607  0.72861609  0.74056479]
Iteration 95 [179.6 s]: loss = 0.170110 [70.40 s], NDCG = 
[ 0.90823167  0.8183993   0.78556488  0.76897579  0.75976181  0.75504324
  0.75345978  0.75399455  0.75760973  0.76411458]
Iteration 96 [179.5 s]: loss = 0.170093 [70.69 s], NDCG = 
[ 0.95529416  0.84933177  0.81190847  0.79384273  0.78440759  0.77966594
  0.77812378  0.77768175  0.77932872  0.78276459]
Iteration 97 [181.2 s]: loss = 0.169607 [70.00 s], NDCG = 
[ 0.91257771  0.8213      0.78790563  0.77093454  0.76139818  0.75636001
  0.75478305  0.75518289  0.75857839  0.76539861]
Iteration 98 [182.6 s]: loss = 0.169904 [70.05 s], NDCG = 
[ 0.84961801  0.77893205  0.7498303   0.73290139  0.72267468  0.71766617
  0.71728249  0.72071236  0.72890033  0.74153848]
Iteration 99 [183.5 s]: loss = 0.170199 [72.28 s], NDCG = 
[ 0.87376742  0.79186884  0.75989264  0.74173593  0.73116887  0.7257529
  0.7237754   0.72564077  0.73260829  0.74398206]
End. Best Iteration 0: NDCG = 0.7931. 

liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v3.02_eval_paircomp/MLP.py --learner adam --reg_layers [0,0,0,0] --lr 0.0001 --batch_size_random 1280000
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=1280000, epochs=100, layers='[64,32,16,8]', learner='adam', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [34.8 s]. #user=13679, #item=12922, #train=3914489, #test=316795
Time: [72.6], Init: NDCG = 
[ 0.95682291  0.84157088  0.80063078  0.7800979   0.76877696  0.76273595
  0.76025313  0.76011049  0.76295206  0.76998307]
Iteration 0 [98.6 s]: loss = 0.335927 [73.44 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 1 [100.6 s]: loss = 0.299228 [73.14 s], NDCG = 
[ 0.99154815  0.86832846  0.82612735  0.80581711  0.79518362  0.7899934
  0.78820886  0.78752729  0.78872448  0.79153773]
Iteration 2 [100.8 s]: loss = 0.287258 [73.63 s], NDCG = 
[ 0.97763466  0.86321832  0.82324842  0.80396357  0.79416637  0.78958253
  0.78816181  0.78794566  0.78936976  0.79260913]
Iteration 3 [101.1 s]: loss = 0.274662 [73.87 s], NDCG = 
[ 0.95250297  0.85244323  0.81738556  0.80011168  0.79150115  0.78793877
  0.78732632  0.78787087  0.79017676  0.79412035]
Iteration 4 [102.5 s]: loss = 0.263384 [73.48 s], NDCG = 
[ 0.93129064  0.84131058  0.80903855  0.79444847  0.78744798  0.78507408
  0.78545173  0.78660489  0.7893105   0.79357318]
Iteration 5 [103.4 s]: loss = 0.251829 [72.75 s], NDCG = 
[ 0.89936289  0.82748258  0.80136255  0.78927299  0.78367944  0.78229755
  0.78378517  0.78606433  0.78933932  0.79385135]
Iteration 6 [105.2 s]: loss = 0.239655 [71.58 s], NDCG = 
[ 0.87063853  0.81355718  0.7914299   0.78178647  0.77832137  0.77801925
  0.78021698  0.78323993  0.78706672  0.79203876]
Iteration 7 [108.2 s]: loss = 0.228536 [72.00 s], NDCG = 
[ 0.86309444  0.8099209   0.7890526   0.77992005  0.77663711  0.77664835
  0.77884135  0.78190328  0.78608602  0.7913154 ]
Iteration 8 [110.4 s]: loss = 0.218794 [72.26 s], NDCG = 
[ 0.85216771  0.80396432  0.78409351  0.77591882  0.77337742  0.77390218
  0.77667832  0.78015649  0.7845378   0.78996405]
Iteration 9 [110.6 s]: loss = 0.210845 [72.34 s], NDCG = 
[ 0.8379769   0.79673483  0.77955755  0.77216363  0.77022548  0.77099972
  0.7738273   0.77763303  0.78217642  0.78781242]
Iteration 10 [114.1 s]: loss = 0.204402 [71.41 s], NDCG = 
[ 0.82958573  0.79288226  0.77690364  0.7703416   0.76930012  0.77055352
  0.77357463  0.77774209  0.78270873  0.78824762]
Iteration 11 [116.7 s]: loss = 0.198012 [72.02 s], NDCG = 
[ 0.82199887  0.7872682   0.77239002  0.76593921  0.76495748  0.76709356
  0.7710577   0.77549555  0.78068078  0.78652565]
Iteration 12 [118.0 s]: loss = 0.193742 [72.48 s], NDCG = 
[ 0.8139976   0.78359462  0.76927938  0.76390718  0.76369137  0.76600183
  0.77007505  0.77459025  0.77960817  0.78560821]
Iteration 13 [120.6 s]: loss = 0.189796 [71.97 s], NDCG = 
[ 0.81615364  0.78406887  0.7706894   0.7661145   0.76565473  0.76779162
  0.77133559  0.77551502  0.78038412  0.78623803]
Iteration 14 [121.2 s]: loss = 0.186918 [71.57 s], NDCG = 
[ 0.80656827  0.77633005  0.76468871  0.75996155  0.76045621  0.76369731
  0.76834973  0.77343552  0.77915035  0.78578002]
Iteration 15 [122.5 s]: loss = 0.184877 [72.42 s], NDCG = 
[ 0.81130734  0.77907255  0.76559147  0.76073426  0.76120155  0.7640796
  0.76866839  0.77363927  0.77905835  0.78560589]
Iteration 16 [123.9 s]: loss = 0.182625 [72.55 s], NDCG = 
[ 0.80579351  0.77614347  0.76533661  0.76057388  0.7607095   0.76391731
  0.76808136  0.77232895  0.77719219  0.7832919 ]
Iteration 17 [125.2 s]: loss = 0.180724 [72.28 s], NDCG = 
[ 0.79908113  0.77176166  0.76078047  0.75763543  0.75856188  0.76241464
  0.76743375  0.77258337  0.77847352  0.78502785]
Iteration 18 [126.3 s]: loss = 0.179438 [72.18 s], NDCG = 
[ 0.80025979  0.77304967  0.76110654  0.75690889  0.75795697  0.7614343
  0.76631363  0.77164423  0.7772687   0.78385123]
Iteration 19 [127.2 s]: loss = 0.178584 [72.37 s], NDCG = 
[ 0.79966309  0.77067719  0.75872776  0.7548462   0.75672275  0.76066997
  0.76599855  0.77118203  0.77681879  0.78369916]
Iteration 20 [126.1 s]: loss = 0.177607 [71.11 s], NDCG = 
[ 0.79011833  0.76410503  0.75320424  0.74989428  0.75203907  0.75654288
  0.76256354  0.76879643  0.77545467  0.782937  ]
Iteration 21 [125.7 s]: loss = 0.177285 [68.88 s], NDCG = 
[ 0.79124448  0.76490049  0.75503155  0.75186244  0.75411277  0.7582691
  0.76357261  0.76948048  0.77583007  0.78322672]
Iteration 22 [126.5 s]: loss = 0.175943 [70.95 s], NDCG = 
[ 0.79541255  0.76731637  0.75655175  0.75306851  0.75439455  0.7582652
  0.76412891  0.76983532  0.77604595  0.78303737]
Iteration 23 [130.4 s]: loss = 0.175721 [69.63 s], NDCG = 
[ 0.80162221  0.77137068  0.75907763  0.75482182  0.75604193  0.75987828
  0.76508366  0.77067818  0.77683554  0.78406169]
Iteration 24 [126.8 s]: loss = 0.175467 [69.51 s], NDCG = 
[ 0.79609517  0.76595714  0.75495584  0.75161761  0.75310549  0.75755969
  0.76297882  0.7691531   0.7756867   0.78360221]
Iteration 25 [127.8 s]: loss = 0.175335 [68.98 s], NDCG = 
[ 0.78886488  0.76218091  0.75207     0.74959017  0.75123993  0.75565833
  0.76148853  0.76768824  0.77443697  0.7822495 ]
Iteration 26 [128.2 s]: loss = 0.174398 [69.01 s], NDCG = 
[ 0.78884318  0.76047792  0.75070605  0.74839866  0.75090909  0.7560842
  0.7621098   0.76791915  0.77461133  0.78253236]
Iteration 27 [129.0 s]: loss = 0.174393 [69.58 s], NDCG = 
[ 0.78134782  0.75658593  0.74646983  0.745466    0.74801415  0.75344564
  0.76010545  0.76613552  0.77277285  0.7810881 ]
Iteration 28 [129.3 s]: loss = 0.174164 [68.98 s], NDCG = 
[ 0.78969371  0.761722    0.75102667  0.74835159  0.75073622  0.75601388
  0.7620828   0.76792206  0.77459398  0.78241384]
Iteration 29 [131.3 s]: loss = 0.174479 [71.86 s], NDCG = 
[ 0.79035684  0.76098772  0.75062644  0.74804805  0.74989995  0.75478638
  0.76059181  0.76672173  0.7733423   0.78148778]
Iteration 30 [132.5 s]: loss = 0.173754 [72.38 s], NDCG = 
[ 0.80162818  0.76797242  0.75570582  0.75245608  0.75395434  0.75781299
  0.76280806  0.76818124  0.7742576   0.78200979]
Iteration 31 [133.4 s]: loss = 0.173607 [72.22 s], NDCG = 
[ 0.78504079  0.75809635  0.74870849  0.74651103  0.74892852  0.75373903
  0.75922249  0.76468579  0.77127455  0.77957208]
Iteration 32 [134.0 s]: loss = 0.173492 [71.57 s], NDCG = 
[ 0.78641044  0.75829353  0.74901526  0.74734413  0.74946531  0.75345608
  0.75929778  0.76518135  0.77170232  0.78003837]
Iteration 33 [134.9 s]: loss = 0.173260 [72.23 s], NDCG = 
[ 0.78851272  0.75977281  0.74919392  0.74731509  0.74943351  0.75374476
  0.75895138  0.7640957   0.77066772  0.77894294]
Iteration 34 [135.5 s]: loss = 0.172905 [71.97 s], NDCG = 
[ 0.79374544  0.76318417  0.75101147  0.74810466  0.74993006  0.75358347
  0.75871978  0.76407439  0.77079817  0.77907276]
Iteration 35 [135.5 s]: loss = 0.172673 [72.46 s], NDCG = 
[ 0.79894956  0.7651967   0.75222661  0.74893133  0.75028627  0.75384045
  0.75883751  0.76389813  0.77012623  0.77859744]
Iteration 36 [135.9 s]: loss = 0.173311 [72.25 s], NDCG = 
[ 0.79403     0.76236931  0.75047744  0.74767247  0.74888796  0.75305497
  0.75824402  0.76323645  0.76962682  0.77796677]
Iteration 37 [136.7 s]: loss = 0.172348 [72.56 s], NDCG = 
[ 0.79517924  0.7627318   0.75103716  0.74750452  0.74924396  0.75276307
  0.75759842  0.76240563  0.76865809  0.7769191 ]
Iteration 38 [136.4 s]: loss = 0.172318 [72.46 s], NDCG = 
[ 0.78796529  0.7585029   0.74715179  0.74455434  0.74627982  0.75036574
  0.75523741  0.76064673  0.76730592  0.77618297]
Iteration 39 [136.7 s]: loss = 0.172326 [72.76 s], NDCG = 
[ 0.80084337  0.76597256  0.75308738  0.74940328  0.75034339  0.75377184
  0.75765746  0.76206885  0.76821889  0.77663682]
Iteration 40 [137.5 s]: loss = 0.172584 [72.18 s], NDCG = 
[ 0.79921808  0.76347425  0.74985755  0.74651785  0.74807204  0.75163836
  0.75619635  0.76080927  0.76709507  0.77549823]
Iteration 41 [136.7 s]: loss = 0.172390 [72.65 s], NDCG = 
[ 0.80665716  0.76781855  0.75419953  0.74973378  0.75029208  0.75339531
  0.7571376   0.76111965  0.76698487  0.77558834]
Iteration 42 [137.7 s]: loss = 0.172407 [72.20 s], NDCG = 
[ 0.80389207  0.76686303  0.75363314  0.74920565  0.74951893  0.75221871
  0.75611322  0.7605939   0.76689103  0.77543234]
Iteration 43 [137.5 s]: loss = 0.172120 [72.28 s], NDCG = 
[ 0.79539085  0.76052408  0.74776673  0.74475631  0.74599235  0.74878043
  0.75292792  0.75753281  0.76389897  0.77289905]
Iteration 44 [137.8 s]: loss = 0.171656 [72.60 s], NDCG = 
[ 0.80144204  0.76597673  0.75290652  0.74801972  0.74799978  0.75055995
  0.75421515  0.75863934  0.76475092  0.77338981]
Iteration 45 [140.0 s]: loss = 0.172031 [72.33 s], NDCG = 
[ 0.80631192  0.76632267  0.75276503  0.74832069  0.74889313  0.75068616
  0.75362698  0.75742095  0.76369345  0.7724351 ]
Iteration 46 [139.6 s]: loss = 0.172044 [72.56 s], NDCG = 
[ 0.81114312  0.76922615  0.75497656  0.75015846  0.74986963  0.751484
  0.75425852  0.75802346  0.76361567  0.77234854]
Iteration 47 [138.6 s]: loss = 0.171951 [72.30 s], NDCG = 
[ 0.81171632  0.77017786  0.75581011  0.75015508  0.74960761  0.75119579
  0.75373315  0.75698038  0.76247373  0.77118326]
Iteration 48 [139.3 s]: loss = 0.171837 [72.75 s], NDCG = 
[ 0.8105391   0.76902371  0.75493951  0.74941467  0.74876867  0.75047988
  0.75301693  0.75666942  0.76236753  0.7711391 ]
Iteration 49 [140.3 s]: loss = 0.171856 [71.88 s], NDCG = 
[ 0.80749103  0.76786885  0.75360548  0.74825942  0.74791752  0.74966062
  0.75260997  0.75604273  0.76202225  0.77126729]
Iteration 50 [140.1 s]: loss = 0.171617 [72.14 s], NDCG = 
[ 0.81347838  0.77164549  0.75680094  0.75127891  0.74972224  0.75061955
  0.75248413  0.75561231  0.76139679  0.77017307]
Iteration 51 [141.3 s]: loss = 0.171121 [72.49 s], NDCG = 
[ 0.8157973   0.77171769  0.7563328   0.75109884  0.74978241  0.7504244
  0.75243825  0.75560356  0.76122428  0.76981984]
Iteration 52 [140.6 s]: loss = 0.171724 [71.93 s], NDCG = 
[ 0.82268118  0.77509432  0.75874701  0.75209443  0.75030593  0.75068168
  0.75250377  0.75548476  0.76071272  0.76934549]
Iteration 53 [141.1 s]: loss = 0.171488 [72.49 s], NDCG = 
[ 0.81680253  0.77132621  0.75624518  0.74983849  0.74793484  0.74849928
  0.75037041  0.75354154  0.75895983  0.76784802]
Iteration 54 [140.6 s]: loss = 0.171765 [72.10 s], NDCG = 
[ 0.82896442  0.77942556  0.76232484  0.75479182  0.75189431  0.75144748
  0.75245219  0.75530289  0.76052052  0.76884487]
Iteration 55 [141.1 s]: loss = 0.171687 [71.78 s], NDCG = 
[ 0.82735423  0.77809138  0.76095778  0.7534448   0.7503153   0.74999937
  0.75118951  0.75347169  0.75853701  0.76722528]
Iteration 56 [141.5 s]: loss = 0.171702 [72.21 s], NDCG = 
[ 0.82401373  0.77552324  0.75923312  0.75114828  0.74842664  0.74824458
  0.74923591  0.75170211  0.757198    0.766233  ]
Iteration 57 [140.2 s]: loss = 0.171633 [71.68 s], NDCG = 
[ 0.83509327  0.78187255  0.76310906  0.75409911  0.75050326  0.74944226
  0.75036787  0.75261226  0.75783812  0.76660024]
Iteration 58 [141.5 s]: loss = 0.171392 [72.64 s], NDCG = 
[ 0.82721274  0.77600337  0.75851719  0.75088597  0.7479716   0.74706693
  0.74776328  0.75011584  0.75552115  0.76459447]
Iteration 59 [141.9 s]: loss = 0.171168 [72.47 s], NDCG = 
[ 0.8387004   0.78247351  0.76280516  0.75370002  0.74953117  0.74792792
  0.74837062  0.75052416  0.75567326  0.76457197]
Iteration 60 [141.9 s]: loss = 0.171109 [72.41 s], NDCG = 
[ 0.83081829  0.77875423  0.76018105  0.75173588  0.74779857  0.7465332
  0.74705262  0.74933307  0.75430343  0.76347789]
Iteration 61 [141.9 s]: loss = 0.171356 [72.30 s], NDCG = 
[ 0.83647456  0.78191396  0.76264506  0.75320079  0.74879202  0.7469204
  0.74729247  0.74901916  0.75428597  0.7633134 ]
Iteration 62 [142.0 s]: loss = 0.171081 [71.81 s], NDCG = 
[ 0.83952106  0.78395693  0.76390691  0.75445507  0.74930414  0.74706101
  0.74667228  0.74846181  0.75360502  0.76254045]
Iteration 63 [142.0 s]: loss = 0.170894 [69.24 s], NDCG = 
[ 0.83836616  0.78181841  0.76276791  0.75375334  0.74853173  0.74605485
  0.74563589  0.74737356  0.7524022   0.7615572 ]
Iteration 64 [137.3 s]: loss = 0.171193 [67.77 s], NDCG = 
[ 0.84236853  0.7844028   0.76376406  0.75359888  0.74839718  0.74607189
  0.7457538   0.74761326  0.75276417  0.76178749]
Iteration 65 [139.5 s]: loss = 0.171064 [65.76 s], NDCG = 
[ 0.83032244  0.77744177  0.75869944  0.74959528  0.744782    0.74255124
  0.7425189   0.74457151  0.75010049  0.75961721]
Iteration 66 [138.8 s]: loss = 0.171051 [65.80 s], NDCG = 
[ 0.84322409  0.78369069  0.76234614  0.75213481  0.74677545  0.74387683
  0.74344687  0.74522593  0.75029222  0.75961644]
Iteration 67 [137.6 s]: loss = 0.171436 [65.54 s], NDCG = 
[ 0.83641796  0.78026635  0.76001005  0.74968102  0.74428316  0.7415694
  0.74110164  0.74298446  0.74829316  0.7577745 ]
Iteration 68 [138.5 s]: loss = 0.171338 [65.65 s], NDCG = 
[ 0.84822037  0.78673504  0.76464743  0.75393898  0.74777958  0.74469493
  0.74385684  0.74526762  0.75019779  0.75937069]
Iteration 69 [139.3 s]: loss = 0.170853 [65.92 s], NDCG = 
[ 0.84378158  0.78435491  0.76356909  0.75293361  0.74711578  0.7437733
  0.74300887  0.74436163  0.7495475   0.75857003]
Iteration 70 [139.5 s]: loss = 0.170981 [65.58 s], NDCG = 
[ 0.84754844  0.78599979  0.76460981  0.75389955  0.74799228  0.74473202
  0.74377417  0.74492212  0.7498091   0.7589994 ]
Iteration 71 [138.7 s]: loss = 0.171235 [65.49 s], NDCG = 
[ 0.8466608   0.7849035   0.76333496  0.7523144   0.74628394  0.74303592
  0.74211878  0.74362726  0.74859874  0.75782361]
Iteration 72 [139.8 s]: loss = 0.170910 [65.60 s], NDCG = 
[ 0.84794021  0.78526744  0.76330111  0.75213985  0.74603593  0.74250244
  0.74146784  0.7424229   0.74754679  0.7570216 ]
Iteration 73 [138.9 s]: loss = 0.170911 [65.88 s], NDCG = 
[ 0.8517687   0.7891821   0.76562475  0.75395923  0.74695242  0.74326196
  0.74222155  0.74350098  0.74858733  0.75795765]
Iteration 74 [139.1 s]: loss = 0.171098 [65.65 s], NDCG = 
[ 0.8564015   0.79097582  0.76685035  0.75440127  0.74800613  0.74419489
  0.74290255  0.74365362  0.74855272  0.75759492]
Iteration 75 [139.7 s]: loss = 0.170978 [65.78 s], NDCG = 
[ 0.85266828  0.78882649  0.76550723  0.75392474  0.74697274  0.7430237
  0.74186323  0.74291207  0.74790218  0.75700128]
Iteration 76 [140.1 s]: loss = 0.170517 [65.35 s], NDCG = 
[ 0.85938197  0.79210013  0.76772217  0.75517148  0.74756685  0.74374662
  0.74233844  0.74316435  0.74788634  0.75711431]
Iteration 77 [140.7 s]: loss = 0.171502 [65.50 s], NDCG = 
[ 0.85827393  0.79170656  0.7673694   0.75500285  0.74770085  0.74378933
  0.74213257  0.74314695  0.74759576  0.75676243]
Iteration 78 [141.4 s]: loss = 0.170919 [65.45 s], NDCG = 
[ 0.85644741  0.78934164  0.76514124  0.75304975  0.7457495   0.74199805
  0.74029644  0.74155175  0.74636979  0.75575478]
Iteration 79 [140.7 s]: loss = 0.171061 [65.53 s], NDCG = 
[ 0.85881915  0.79136094  0.76745039  0.75494886  0.74720591  0.74297537
  0.74131061  0.74237886  0.74728985  0.75664208]
Iteration 80 [140.7 s]: loss = 0.170782 [65.87 s], NDCG = 
[ 0.85805383  0.7902396   0.76676398  0.7543144   0.74698327  0.74255415
  0.74088044  0.74157424  0.74655425  0.75566901]
Iteration 81 [140.4 s]: loss = 0.171125 [65.69 s], NDCG = 
[ 0.85864841  0.79034804  0.76697864  0.75442233  0.74713029  0.74277486
  0.74097002  0.74191633  0.74673188  0.75581262]
Iteration 82 [141.3 s]: loss = 0.170514 [65.61 s], NDCG = 
[ 0.86086545  0.79208684  0.76687221  0.75368635  0.74585767  0.74170078
  0.74001431  0.7411442   0.74600922  0.75528551]
Iteration 83 [140.8 s]: loss = 0.170651 [65.50 s], NDCG = 
[ 0.86041676  0.79161942  0.76677149  0.75365776  0.7461565   0.74192142
  0.74032371  0.74134284  0.74617215  0.75519372]
Iteration 84 [141.3 s]: loss = 0.171214 [65.64 s], NDCG = 
[ 0.86412702  0.7937722   0.76809918  0.75454233  0.74691959  0.74241832
  0.74056455  0.7413102   0.74619845  0.75558967]
Iteration 85 [142.8 s]: loss = 0.170715 [66.11 s], NDCG = 
[ 0.86046141  0.7908683   0.76590861  0.75295943  0.74547482  0.74105008
  0.73935029  0.7403014   0.74517274  0.75462202]
Iteration 86 [142.6 s]: loss = 0.171111 [67.00 s], NDCG = 
[ 0.86527437  0.79269422  0.76738944  0.75466022  0.74697897  0.74243535
  0.74056131  0.74141444  0.74608189  0.75497449]
Iteration 87 [142.1 s]: loss = 0.170826 [65.89 s], NDCG = 
[ 0.86460496  0.79365523  0.76820866  0.75494523  0.74710323  0.74233704
  0.74046745  0.74108234  0.74584282  0.75511549]
Iteration 88 [142.2 s]: loss = 0.170740 [65.79 s], NDCG = 
[ 0.87246788  0.79743323  0.77037156  0.7561674   0.7483215   0.74353235
  0.74151932  0.74220654  0.74696824  0.75577921]
Iteration 89 [142.0 s]: loss = 0.170704 [66.11 s], NDCG = 
[ 0.86855167  0.79511737  0.76896271  0.75511153  0.74722745  0.74235124
  0.74073977  0.74126151  0.74572178  0.75485881]
Iteration 90 [143.8 s]: loss = 0.170741 [65.94 s], NDCG = 
[ 0.87186041  0.79712736  0.77032461  0.75615572  0.74770422  0.74260066
  0.74053333  0.74116309  0.74597214  0.75505083]
Iteration 91 [142.4 s]: loss = 0.170377 [65.62 s], NDCG = 
[ 0.8650766   0.79281813  0.76712008  0.75323046  0.74502241  0.7403166
  0.73849794  0.73936067  0.74413902  0.75361547]
Iteration 92 [142.4 s]: loss = 0.170983 [65.55 s], NDCG = 
[ 0.86935315  0.79514313  0.76818673  0.75388862  0.74566593  0.74088223
  0.73907401  0.73974336  0.74443289  0.75378628]
Iteration 93 [142.5 s]: loss = 0.170605 [65.62 s], NDCG = 
[ 0.87181513  0.7954053   0.76812021  0.75371533  0.74544124  0.74044196
  0.73847309  0.73905011  0.74381953  0.7532174 ]
Iteration 94 [143.5 s]: loss = 0.170872 [65.85 s], NDCG = 
[ 0.87382307  0.7970332   0.76921543  0.75446538  0.7457111   0.74079993
  0.73904537  0.7398473   0.74462927  0.75381649]
Iteration 95 [142.3 s]: loss = 0.170963 [65.99 s], NDCG = 
[ 0.86863531  0.79417201  0.76715243  0.75247646  0.74412538  0.73936901
  0.73761809  0.73834289  0.74337727  0.7529321 ]
Iteration 96 [143.1 s]: loss = 0.170792 [65.74 s], NDCG = 
[ 0.87219307  0.79607927  0.76906786  0.75416633  0.74514078  0.74015773
  0.73835354  0.73905444  0.74410414  0.75368763]
Iteration 97 [142.1 s]: loss = 0.170844 [65.92 s], NDCG = 
[ 0.86771529  0.79416549  0.76722391  0.75274689  0.74394052  0.73891205
  0.73698923  0.73772201  0.7429383   0.75266803]
Iteration 98 [142.6 s]: loss = 0.170400 [65.82 s], NDCG = 
[ 0.87445696  0.79772508  0.77035613  0.75551012  0.74632732  0.74090389
  0.73900583  0.73970213  0.74457643  0.75388604]
Iteration 99 [142.1 s]: loss = 0.170894 [65.91 s], NDCG = 
[ 0.87697837  0.79983331  0.77194186  0.75630709  0.7472066   0.74164016
  0.73965078  0.740342    0.74511186  0.75422594]
End. Best Iteration 3: NDCG = 0.7941. 


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v3.02_eval_paircomp/MLP.py --learner adam --reg_layers [0.000001,0.0001,0.0005,0.001] --lr 0.0001 --batch_size_random 1280000
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=1280000, epochs=100, layers='[64,32,16,8]', learner='adam', lr=0.0001, path='Data/yelp/', reg_layers='[0.000001,0.0001,0.0005,0.001]', verbose=1) 
Load data done [32.1 s]. #user=13679, #item=12922, #train=3914489, #test=316795
Time: [64.9], Init: NDCG = 
[ 0.7357861   0.68863596  0.67053314  0.66370215  0.66426422  0.67026204
  0.68055898  0.69453417  0.71091626  0.72889092]
Iteration 0 [161.1 s]: loss = 0.370115 [197.19 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 1 [296.3 s]: loss = 0.315037 [435.29 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 2 [309.6 s]: loss = 0.310129 [445.99 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 3 [319.9 s]: loss = 0.307844 [418.75 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 4 [332.8 s]: loss = 0.306480 [373.57 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 5 [402.2 s]: loss = 0.306193 [374.90 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 6 [400.5 s]: loss = 0.302583 [370.67 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 7 [401.4 s]: loss = 0.298099 [369.27 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 8 [404.2 s]: loss = 0.294376 [365.95 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 9 [432.2 s]: loss = 0.291206 [365.34 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 10 [473.0 s]: loss = 0.289122 [364.39 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 11 [476.5 s]: loss = 0.286902 [364.72 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 12 [476.2 s]: loss = 0.284547 [363.88 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 13 [490.3 s]: loss = 0.283493 [365.08 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 14 [512.8 s]: loss = 0.280521 [363.82 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 15 [514.8 s]: loss = 0.278543 [364.89 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 16 [515.3 s]: loss = 0.275898 [364.99 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 17 [514.5 s]: loss = 0.273789 [364.98 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 18 [514.5 s]: loss = 0.272209 [364.11 s], NDCG = 
[ 1.          0.87128941  0.82744837  0.80644012  0.79547822  0.7898905
  0.78779062  0.78679905  0.78770103  0.79027628]
Iteration 19 [521.4 s]: loss = 0.270661 [364.58 s], NDCG = 
[ 1.          0.871304    0.82746839  0.80645678  0.79549269  0.78989935
  0.7877952   0.78680627  0.78770774  0.79028257]
Iteration 20 [514.9 s]: loss = 0.269089 [365.61 s], NDCG = 
[ 0.99984907  0.87133188  0.82748752  0.80647903  0.79550708  0.78991015
  0.78780155  0.78681061  0.78771177  0.79028394]
Iteration 21 [515.3 s]: loss = 0.268125 [364.44 s], NDCG = 
[ 0.999684    0.87137299  0.82752539  0.80650124  0.79552053  0.78991747
  0.78781041  0.78682348  0.78772494  0.79029614]
Iteration 22 [514.7 s]: loss = 0.266592 [363.06 s], NDCG = 
[ 0.99878788  0.8713148   0.8275154   0.80648668  0.79550273  0.78989535
  0.78779108  0.78680235  0.78770542  0.79027938]
Iteration 23 [514.9 s]: loss = 0.265235 [364.06 s], NDCG = 
[ 0.99747545  0.87098995  0.82730413  0.80630967  0.7953433   0.78976547
  0.78766875  0.78669407  0.78760701  0.79018428]
Iteration 24 [515.4 s]: loss = 0.263797 [364.62 s], NDCG = 
[ 0.98776902  0.86936306  0.82644368  0.80562969  0.79475765  0.78923613
  0.7871452   0.78620869  0.78714515  0.78973759]
Iteration 25 [514.7 s]: loss = 0.263499 [363.88 s], NDCG = 
[ 0.97965801  0.86715469  0.82521221  0.80465535  0.79391812  0.78846071
  0.78644324  0.78555964  0.78654939  0.78916329]
Iteration 26 [514.4 s]: loss = 0.261868 [365.64 s], NDCG = 
[ 0.96226411  0.86339569  0.82331549  0.80334305  0.79278563  0.78743568
  0.78549204  0.78466684  0.78575239  0.78838844]
Iteration 27 [514.3 s]: loss = 0.260941 [364.50 s], NDCG = 
[ 0.95525643  0.86114185  0.82186047  0.80211931  0.79184572  0.78661841
  0.78474712  0.78398194  0.78510232  0.78776096]
Iteration 28 [514.3 s]: loss = 0.259645 [366.40 s], NDCG = 
[ 0.94204663  0.85612087  0.81871956  0.79990007  0.79000572  0.78510234
  0.78339387  0.78273289  0.78398704  0.78670726]
Iteration 29 [514.3 s]: loss = 0.258543 [363.85 s], NDCG = 
[ 0.94156021  0.85460573  0.81784071  0.79924955  0.78952064  0.78463666
  0.78295203  0.78236752  0.78363112  0.78639116]
Iteration 30 [514.8 s]: loss = 0.257134 [364.76 s], NDCG = 
[ 0.93079699  0.85117718  0.81621722  0.79810583  0.7885771   0.78379468
  0.78219678  0.78167903  0.78300248  0.78580487]
Iteration 31 [514.6 s]: loss = 0.255830 [365.34 s], NDCG = 
[ 0.92580826  0.84914798  0.81498658  0.7969728   0.78768735  0.78300341
  0.78148987  0.78105822  0.78243411  0.78526984]
Iteration 32 [514.5 s]: loss = 0.255372 [365.35 s], NDCG = 
[ 0.93559644  0.85335028  0.81727617  0.79879775  0.78914726  0.78423543
  0.78256605  0.78204593  0.78337062  0.78614412]
Iteration 33 [514.5 s]: loss = 0.253694 [366.10 s], NDCG = 
[ 0.93681894  0.8535535   0.81786322  0.79944572  0.78965466  0.78468797
  0.78297736  0.78240407  0.78370755  0.78649632]
Iteration 34 [514.2 s]: loss = 0.253465 [364.88 s], NDCG = 
[ 0.9499256   0.85866052  0.82088694  0.80158727  0.79141769  0.78621474
  0.78433408  0.78362726  0.78478571  0.78752048]
Iteration 35 [514.2 s]: loss = 0.252851 [363.86 s], NDCG = 
[ 0.9297512   0.85174652  0.81670248  0.79878801  0.78912893  0.78429204
  0.78261931  0.78206622  0.78337834  0.78618277]
Iteration 36 [514.7 s]: loss = 0.251614 [369.23 s], NDCG = 
[ 0.94843269  0.85851154  0.8203976   0.80136146  0.79118041  0.78603177
  0.78424315  0.78350651  0.7846597   0.78738595]
Iteration 37 [523.2 s]: loss = 0.250907 [365.07 s], NDCG = 
[ 0.93481225  0.85298916  0.81740758  0.79906042  0.78931541  0.7843898
  0.78271151  0.78210312  0.78338257  0.78616957]
Iteration 38 [514.4 s]: loss = 0.250410 [364.70 s], NDCG = 
[ 0.95482315  0.86010652  0.82165076  0.80211854  0.79183655  0.78659142
  0.78471796  0.78395933  0.78506574  0.78778417]
Iteration 39 [514.7 s]: loss = 0.250046 [364.98 s], NDCG = 
[ 0.94431524  0.85673243  0.81953842  0.8006784   0.79071288  0.78559049
  0.78380969  0.7831295   0.78432531  0.78705908]
Iteration 40 [518.2 s]: loss = 0.249394 [376.56 s], NDCG = 
[ 0.94205198  0.85677448  0.81951835  0.80058427  0.79058523  0.78542291
  0.78362967  0.78295688  0.78414516  0.78691201]
Iteration 41 [530.2 s]: loss = 0.248605 [392.55 s], NDCG = 
[ 0.95033593  0.85925167  0.82110473  0.80186892  0.79160026  0.78635337
  0.78449869  0.78374941  0.78488152  0.78761884]
Iteration 42 [530.6 s]: loss = 0.248584 [392.79 s], NDCG = 
[ 0.96166135  0.86257306  0.82266261  0.80280021  0.79233543  0.78702691
  0.78515864  0.78435367  0.78547819  0.78820371]
Iteration 43 [528.9 s]: loss = 0.247774 [390.88 s], NDCG = 
[ 0.95207283  0.85885001  0.82052191  0.80129097  0.79104104  0.78592008
  0.78413618  0.78343665  0.78458723  0.78737054]
Iteration 44 [531.2 s]: loss = 0.247408 [393.43 s], NDCG = 
[ 0.9453865   0.85655946  0.8191959   0.80011934  0.79018181  0.78514596
  0.78345028  0.78284289  0.78407972  0.7868717 ]
Iteration 45 [530.5 s]: loss = 0.247235 [389.83 s], NDCG = 
[ 0.95503413  0.8594544   0.82077532  0.80138728  0.79116015  0.78603739
  0.7842796   0.78358919  0.78473127  0.78752936]
Iteration 46 [532.5 s]: loss = 0.246446 [392.50 s], NDCG = 
[ 0.95788443  0.86066807  0.82146715  0.80186721  0.79159079  0.78642248
  0.78459876  0.78386434  0.78499536  0.7877823 ]


