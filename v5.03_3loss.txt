liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0,1.,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0,1.,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [4.9 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [84.7], Init: NDCG = 
(array([ 0.56567414,  0.5685128 ,  0.57499039,  0.58372158,  0.59618066,
        0.6108895 ,  0.62769614,  0.64625339,  0.66664712,  0.68859224]), array([ 0.56163566,  0.56774734,  0.57494539,  0.58502049,  0.59748512,
        0.61182743,  0.62781441,  0.6460626 ,  0.66654052,  0.68837213]), array([ 0.56560528,  0.5698116 ,  0.5771288 ,  0.58718201,  0.60000261,
        0.61447891,  0.63048345,  0.64853004,  0.66875106,  0.69079079]))
Iteration 0 [34.8 s]: loss = 8.507995 [84.85 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.66951375  0.66571469  0.66538079  0.670267    0.67910891  0.68858944
  0.70089318  0.7153902   0.73174515  0.74956198]
NDCG_rating2: [ 0.56661522  0.57116685  0.57786352  0.58785836  0.59989842  0.61395048
  0.62973814  0.64754138  0.6675906   0.69002025]
Iteration 1 [24.4 s]: loss = 1.185571 [85.71 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.74500436  0.73098136  0.7270227   0.72889248  0.73418012  0.7427006
  0.75322495  0.76553398  0.77917951  0.79377829]
NDCG_rating2: [ 0.56863103  0.57168506  0.57783039  0.58843319  0.60021522  0.61451587
  0.63016654  0.6481016   0.66805661  0.6901116 ]
Iteration 2 [29.5 s]: loss = 1.017088 [85.58 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.76176123  0.74863336  0.74375772  0.744064    0.74947177  0.75754013
  0.76749391  0.7791052   0.79178916  0.80577235]
NDCG_rating2: [ 0.56893885  0.57275953  0.57836134  0.58833333  0.6001589   0.6146381
  0.63050984  0.64833706  0.668354    0.69032489]
Iteration 3 [35.5 s]: loss = 0.980421 [85.66 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.7713271   0.75454556  0.75008708  0.75024667  0.75460199  0.76193849
  0.77202696  0.78318812  0.79578312  0.80941099]
NDCG_rating2: [ 0.56968437  0.57198269  0.57830616  0.58821821  0.59998886  0.61446351
  0.63056695  0.64856383  0.66845814  0.69047565]
Iteration 4 [25.1 s]: loss = 0.968381 [85.64 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77555429  0.75890218  0.7532362   0.75303579  0.75719117  0.76442586
  0.7739538   0.78512052  0.79753759  0.81092783]
NDCG_rating2: [ 0.56944729  0.57202892  0.578068    0.58810955  0.5996448   0.61450117
  0.63048774  0.64851184  0.66852876  0.69034495]
Iteration 5 [26.6 s]: loss = 0.962486 [85.05 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77507352  0.75927812  0.75391859  0.75349563  0.75766295  0.7650026
  0.77439893  0.7853158   0.79781165  0.81123985]
NDCG_rating2: [ 0.56935422  0.57183568  0.57866219  0.58821582  0.59981015  0.61471807
  0.63086467  0.64855304  0.66876079  0.69057469]
Iteration 6 [35.3 s]: loss = 0.958947 [83.04 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77645355  0.75994639  0.7541993   0.75357001  0.75759096  0.76505399
  0.77462277  0.78545743  0.79800328  0.8115147 ]
NDCG_rating2: [ 0.56898539  0.57172194  0.57808015  0.5880538   0.60006789  0.61463444
  0.63070245  0.64864523  0.6685743   0.69052373]
Iteration 7 [18.2 s]: loss = 0.956269 [75.17 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77523891  0.75994505  0.75448229  0.75362007  0.75821405  0.76531538
  0.77455024  0.7855483   0.79819954  0.81160781]
NDCG_rating2: [ 0.56852978  0.5718449   0.57822792  0.58818645  0.59990434  0.61469447
  0.63059299  0.64852125  0.66853868  0.69053058]
Iteration 8 [17.9 s]: loss = 0.954063 [75.21 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77524677  0.75938624  0.75350921  0.75349156  0.75766308  0.76495365
  0.77414789  0.78525893  0.79796755  0.81136401]
NDCG_rating2: [ 0.56909575  0.57211344  0.57850087  0.58861407  0.60019532  0.61492224
  0.63080985  0.64863343  0.66888595  0.69081881]
Iteration 9 [18.0 s]: loss = 0.951960 [74.33 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77552069  0.76048375  0.75439587  0.75412113  0.75811854  0.76532041
  0.77440952  0.78564353  0.79817669  0.81169333]
NDCG_rating2: [ 0.56902721  0.57159874  0.57852788  0.58853731  0.6002101   0.61464611
  0.63070133  0.64849848  0.66878899  0.69066985]
Iteration 10 [18.0 s]: loss = 0.950137 [74.15 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77485908  0.76026536  0.75408904  0.75338435  0.75781784  0.76520153
  0.77429323  0.78545573  0.79809275  0.81155579]
NDCG_rating2: [ 0.5685279   0.5713629   0.57856725  0.58861279  0.59994105  0.61480739
  0.63065079  0.64861256  0.66872479  0.6905362 ]
Iteration 11 [18.2 s]: loss = 0.948229 [74.34 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77604857  0.7600159   0.75394845  0.75331845  0.75750896  0.76491748
  0.77435225  0.78564101  0.7982768   0.81174644]
NDCG_rating2: [ 0.56878919  0.57119721  0.57872029  0.58862285  0.59994783  0.61452192
  0.63058526  0.64852999  0.66854976  0.69046879]
Iteration 12 [19.3 s]: loss = 0.946216 [77.13 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77550806  0.7600882   0.75505232  0.75384187  0.75843957  0.76560377
  0.77450737  0.78568728  0.79832092  0.81186161]
NDCG_rating2: [ 0.56918851  0.57153694  0.57902766  0.58890883  0.60002696  0.61468875
  0.63068536  0.64895187  0.66870973  0.69053181]
Iteration 13 [19.5 s]: loss = 0.943863 [77.40 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.7751122   0.75975758  0.75460219  0.75392874  0.75827195  0.76534136
  0.7745274   0.78563689  0.79820615  0.81183511]
NDCG_rating2: [ 0.56934258  0.57199083  0.57883376  0.58919369  0.60041158  0.61469355
  0.63085494  0.64884725  0.66857392  0.69070676]
Iteration 14 [19.9 s]: loss = 0.940748 [76.83 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77436103  0.75962374  0.75377325  0.75314374  0.7580083   0.76504571
  0.77433061  0.78533934  0.79793429  0.8115717 ]
NDCG_rating2: [ 0.56994125  0.57223846  0.57826527  0.58883448  0.60005129  0.61456559
  0.63058619  0.64889618  0.66852602  0.69066192]
Iteration 15 [19.5 s]: loss = 0.936292 [76.81 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77757669  0.76059823  0.75454794  0.7538339   0.75825792  0.76549987
  0.77496464  0.78588241  0.79825708  0.81187963]
NDCG_rating2: [ 0.56974065  0.57201758  0.5780484   0.5884469   0.60028123  0.61467472
  0.63054753  0.64860284  0.66868715  0.69072551]
Iteration 16 [20.5 s]: loss = 0.929109 [76.57 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77681357  0.76049074  0.75426066  0.75418229  0.75833826  0.76549843
  0.77508446  0.78564208  0.79829993  0.81188873]
NDCG_rating2: [ 0.56887031  0.5716675   0.57784173  0.5883824   0.60013192  0.61437494
  0.63027352  0.64845642  0.66877185  0.69048812]
Iteration 17 [19.7 s]: loss = 0.918580 [78.25 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77627716  0.76042435  0.75420016  0.75426018  0.75818124  0.76523471
  0.77489255  0.7857068   0.7982182   0.8116859 ]
NDCG_rating2: [ 0.56822851  0.57170758  0.57813696  0.58828012  0.60014449  0.61479291
  0.63035923  0.648402    0.66858203  0.69045641]
Iteration 18 [19.8 s]: loss = 0.905590 [77.28 s],
NDCG_rank: [ 0.54718167  0.55719729  0.5667166   0.5774181   0.59029927  0.60571231
  0.62303576  0.64155557  0.66213137  0.6849771 ]
NDCG_rating1: [ 0.77733081  0.76146761  0.75405243  0.75422675  0.75834087  0.76521622
  0.77497559  0.78574834  0.79836961  0.81193378]
NDCG_rating2: [ 0.56944661  0.57111317  0.57842227  0.58819324  0.60045828  0.61460572
  0.63037254  0.64833256  0.66862832  0.6906017 ]
Iteration 19 [19.6 s]: loss = 0.891415 [77.35 s],
NDCG_rank: [ 0.5471628   0.55715106  0.56665687  0.5773803   0.59027385  0.60568564
  0.62301746  0.64153623  0.66210573  0.68494969]
NDCG_rating1: [ 0.77796124  0.76143708  0.75432822  0.75430912  0.75808964  0.76504436
  0.77468109  0.78572365  0.79837914  0.81179911]
NDCG_rating2: [ 0.56931204  0.57152531  0.57785904  0.5883958   0.60031086  0.61478918
  0.63058146  0.64841488  0.66871322  0.69086042]
Iteration 20 [19.7 s]: loss = 0.877070 [77.53 s],
NDCG_rank: [ 0.54712507  0.55713522  0.56664696  0.57737285  0.59025707  0.60566993
  0.62300664  0.64152191  0.66209515  0.68493576]
NDCG_rating1: [ 0.77481416  0.76032306  0.75344496  0.75355367  0.75779378  0.7646025
  0.77392526  0.78503052  0.79750943  0.81096867]
NDCG_rating2: [ 0.56798326  0.57108796  0.57766622  0.58778206  0.59985568  0.61444792
  0.63004292  0.64837249  0.66827038  0.6903899 ]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.5,0.5,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.5,0.5,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.0 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [80.9], Init: NDCG = 
(array([ 0.56082596,  0.56739494,  0.57496219,  0.58603774,  0.59812808,
        0.61283544,  0.62953311,  0.64788218,  0.66789253,  0.68983253]), array([ 0.56212769,  0.56620293,  0.57503003,  0.58574096,  0.59892259,
        0.61339053,  0.62967848,  0.64792391,  0.66766611,  0.68950465]), array([ 0.56909288,  0.5726528 ,  0.58007295,  0.58901322,  0.6012253 ,
        0.61558211,  0.63164352,  0.64900718,  0.66941474,  0.69145802]))
Iteration 0 [28.4 s]: loss = 4.656864 [77.62 s],
NDCG_rank: [ 0.56644108  0.5704024   0.57816826  0.58820804  0.59945509  0.61222803
  0.62739269  0.64491465  0.66433467  0.68606355]
NDCG_rating1: [ 0.67012622  0.66545821  0.66575389  0.6701941   0.67766147  0.68803399
  0.70055016  0.71407659  0.73017097  0.74804992]
NDCG_rating2: [ 0.72718943  0.71920523  0.71748669  0.71955113  0.72558375  0.73456883
  0.74559066  0.75830028  0.77199086  0.78717345]
Iteration 1 [22.5 s]: loss = 0.933800 [79.23 s],
NDCG_rank: [ 0.62764501  0.63338519  0.63900128  0.64987706  0.6624074   0.67599127
  0.69034235  0.7054477   0.72172436  0.74000999]
NDCG_rating1: [ 0.74418936  0.73103289  0.72721388  0.72810936  0.7334968   0.74185103
  0.75242608  0.76430429  0.77801089  0.79302054]
NDCG_rating2: [ 0.72252771  0.71986635  0.71982876  0.72280823  0.72900685  0.73785753
  0.74909024  0.76171877  0.77563593  0.79055903]
Iteration 2 [21.6 s]: loss = 0.840006 [78.50 s],
NDCG_rank: [ 0.71297414  0.708007    0.70866553  0.71381902  0.72211585  0.73212082
  0.74382904  0.75667682  0.77094852  0.78643524]
NDCG_rating1: [ 0.76027806  0.74699483  0.74244426  0.74309857  0.74819601  0.75591836
  0.76634068  0.77840915  0.79068719  0.80476702]
NDCG_rating2: [ 0.70478075  0.70789522  0.71080184  0.7157861   0.72328946  0.73318252
  0.74452702  0.75765283  0.77173544  0.7870206 ]
Iteration 3 [22.0 s]: loss = 0.815196 [78.42 s],
NDCG_rank: [ 0.74785937  0.73647809  0.73438834  0.73686059  0.74326012  0.75144
  0.76155543  0.77318132  0.78661322  0.80107833]
NDCG_rating1: [ 0.77071019  0.75517713  0.75036777  0.75061353  0.75516723  0.76207901
  0.7720898   0.78320078  0.79581386  0.80958949]
NDCG_rating2: [ 0.69730488  0.70030584  0.70504303  0.71055198  0.71897621  0.72930659
  0.74121921  0.75456935  0.76907952  0.78434341]
Iteration 4 [21.7 s]: loss = 0.804018 [78.97 s],
NDCG_rank: [ 0.76180807  0.7515073   0.74670949  0.74733083  0.75201213  0.75904674
  0.76887634  0.78014315  0.79321825  0.8072756 ]
NDCG_rating1: [ 0.77611743  0.75889256  0.75343299  0.75334764  0.75756156  0.76454269
  0.77414084  0.78514288  0.79746573  0.81110474]
NDCG_rating2: [ 0.69175207  0.69453193  0.69870528  0.70547264  0.71504487  0.72513553
  0.73742174  0.75132977  0.76608309  0.7816004 ]
Iteration 5 [22.0 s]: loss = 0.797654 [78.26 s],
NDCG_rank: [ 0.76682106  0.75464022  0.75029223  0.75036457  0.75455602  0.76173903
  0.77148579  0.78269155  0.79541046  0.80941388]
NDCG_rating1: [ 0.77569892  0.75966861  0.75387949  0.75385633  0.75780632  0.76509004
  0.77455946  0.7856329   0.79802499  0.81160456]
NDCG_rating2: [ 0.67257876  0.67780829  0.68380845  0.69276104  0.70255918  0.71435991
  0.72759444  0.74217612  0.75779575  0.77354507]
Iteration 6 [21.4 s]: loss = 0.793543 [78.37 s],
NDCG_rank: [ 0.76616108  0.7550505   0.75046078  0.75071196  0.75531792  0.7621878
  0.77204039  0.7828881   0.79579965  0.8094599 ]
NDCG_rating1: [ 0.77520248  0.76039501  0.75438464  0.75433715  0.75845365  0.76534605
  0.77482239  0.78596878  0.79838931  0.81181105]
NDCG_rating2: [ 0.64805581  0.65248999  0.66095234  0.67067192  0.68332182  0.69656654
  0.71094368  0.72686096  0.74370922  0.76055949]
Iteration 7 [22.7 s]: loss = 0.790685 [78.92 s],
NDCG_rank: [ 0.76808633  0.75453463  0.74975969  0.75041103  0.75453925  0.76203947
  0.77153757  0.78286571  0.79563579  0.80958878]
NDCG_rating1: [ 0.77470191  0.760383    0.75409028  0.7537269   0.75810511  0.76510483
  0.7744491   0.78582456  0.79822077  0.81155075]
NDCG_rating2: [ 0.62941268  0.63627837  0.64433684  0.65615674  0.66880982  0.68378442
  0.69962243  0.71616329  0.73348678  0.75084681]
Iteration 8 [22.2 s]: loss = 0.788420 [78.45 s],
NDCG_rank: [ 0.76856866  0.75507983  0.75075486  0.75095535  0.75523298  0.76248167
  0.77203956  0.78327457  0.79593768  0.80971451]
NDCG_rating1: [ 0.77621993  0.75982356  0.75385499  0.75424044  0.7580893   0.76476755
  0.77440907  0.7855385   0.79828598  0.81173067]
NDCG_rating2: [ 0.60399581  0.61244265  0.6225091   0.63509123  0.64860197  0.66470715
  0.68231124  0.70041683  0.71897293  0.73748223]
Iteration 9 [22.6 s]: loss = 0.786280 [78.73 s],
NDCG_rank: [ 0.76643809  0.75499026  0.75051384  0.75054872  0.75513087  0.76268432
  0.77195702  0.78304686  0.79567894  0.80941873]
NDCG_rating1: [ 0.77463772  0.75989021  0.75410227  0.75375174  0.75800971  0.76532697
  0.77440392  0.78554207  0.79827625  0.81152967]
NDCG_rating2: [ 0.57716369  0.58461681  0.59674177  0.61130426  0.62769416  0.64552259
  0.66454767  0.68423754  0.70393404  0.72317751]
Iteration 10 [22.2 s]: loss = 0.784236 [78.30 s],
NDCG_rank: [ 0.76669278  0.75542583  0.7509539   0.75092717  0.75553532  0.76254776
  0.77188956  0.78339231  0.79592071  0.80960699]
NDCG_rating1: [ 0.77403151  0.75924471  0.75383899  0.75396072  0.75779786  0.76512731
  0.77446974  0.785548    0.79819952  0.81162111]
NDCG_rating2: [ 0.55804007  0.56941551  0.58306014  0.59851518  0.61540059  0.63447955
  0.65413671  0.67427796  0.69430592  0.71432589]
Iteration 11 [23.1 s]: loss = 0.782065 [84.07 s],
NDCG_rank: [ 0.76781686  0.75588772  0.75160085  0.75226333  0.75553733  0.76278813
  0.77197127  0.78305348  0.79587678  0.80961359]
NDCG_rating1: [ 0.77525589  0.76057662  0.75488866  0.75413878  0.75819049  0.76562754
  0.77466058  0.7857897   0.79851018  0.81177343]
NDCG_rating2: [ 0.54771143  0.55812933  0.57298868  0.58879333  0.60683482  0.62529316
  0.6448523   0.66542441  0.68661286  0.70705865]
Iteration 12 [22.6 s]: loss = 0.779578 [84.32 s],
NDCG_rank: [ 0.77080331  0.75748713  0.75184182  0.75168176  0.7556794   0.7632915
  0.77222613  0.78341934  0.79594981  0.80960768]
NDCG_rating1: [ 0.77678087  0.76027264  0.75437051  0.75434647  0.75845442  0.7654475
  0.77501552  0.78601956  0.79867128  0.81180263]
NDCG_rating2: [ 0.54324906  0.55562696  0.57074079  0.58734846  0.60578518  0.6246941
  0.6436699   0.66372579  0.68468626  0.70522872]
Iteration 13 [22.7 s]: loss = 0.776517 [84.14 s],
NDCG_rank: [ 0.76756815  0.75558292  0.75074072  0.75084738  0.7554215   0.76236097
  0.7714517   0.78264585  0.79527813  0.80925859]
NDCG_rating1: [ 0.77679628  0.76042343  0.75443787  0.75447347  0.75833982  0.76540278
  0.77497585  0.78586991  0.79844579  0.81187922]
NDCG_rating2: [ 0.54359807  0.55787036  0.57287668  0.58952887  0.60698673  0.6259237
  0.6450644   0.66532425  0.68614704  0.70625478]
Iteration 14 [23.1 s]: loss = 0.772486 [85.56 s],
NDCG_rank: [ 0.76911419  0.75689762  0.75108096  0.75121622  0.75576988  0.76271146
  0.7718872   0.78300875  0.79541783  0.80932141]
NDCG_rating1: [ 0.77625578  0.7607898   0.7548547   0.75433491  0.75869494  0.76564994
  0.77510582  0.78592474  0.79850035  0.81195867]
NDCG_rating2: [ 0.53493838  0.55181719  0.56672634  0.58436956  0.60218742  0.62126768
  0.64100568  0.66105909  0.68176287  0.70248732]
Iteration 15 [22.8 s]: loss = 0.766907 [84.65 s],
NDCG_rank: [ 0.76910413  0.75587988  0.75105165  0.75108344  0.75546051  0.76238167
  0.7716715   0.78280109  0.79527612  0.80917355]
NDCG_rating1: [ 0.77695507  0.76068783  0.75522768  0.75460269  0.75912522  0.76564313
  0.7749257   0.78621337  0.79866472  0.81213122]
NDCG_rating2: [ 0.53337279  0.55046452  0.56583958  0.58325249  0.60104685  0.62028106
  0.63971627  0.66024481  0.68099996  0.70185216]
Iteration 16 [23.1 s]: loss = 0.759837 [78.86 s],
NDCG_rank: [ 0.76952484  0.75619342  0.7502542   0.75071117  0.75496055  0.76201105
  0.77140439  0.78244195  0.79528917  0.80915403]
NDCG_rating1: [ 0.77736823  0.76089467  0.75476125  0.75435895  0.75880749  0.76554355
  0.77493334  0.78593306  0.79863166  0.81214718]
NDCG_rating2: [ 0.53299139  0.5515235   0.56780635  0.58531653  0.60269799  0.62139122
  0.6412997   0.66147892  0.68201065  0.70302121]
Iteration 17 [22.2 s]: loss = 0.751636 [78.06 s],
NDCG_rank: [ 0.7693997   0.75643362  0.7513599   0.75079449  0.75541938  0.7621538
  0.77169319  0.78264908  0.7952882   0.80940151]
NDCG_rating1: [ 0.77642211  0.76050397  0.75470567  0.75444037  0.75848431  0.76537411
  0.77484933  0.78585783  0.79840874  0.81199352]
NDCG_rating2: [ 0.53612562  0.5542242   0.57074133  0.58850271  0.60591125  0.62466732
  0.64470485  0.66445818  0.68474865  0.70567521]
Iteration 18 [21.4 s]: loss = 0.742855 [81.71 s],
NDCG_rank: [ 0.76795144  0.75548424  0.75053032  0.7507055   0.75488794  0.76208217
  0.77104194  0.7825571   0.7951548   0.80888636]
NDCG_rating1: [ 0.77704091  0.7610599   0.75533121  0.75458342  0.75857105  0.76553191
  0.77500692  0.78575549  0.79841669  0.81207093]
NDCG_rating2: [ 0.53836247  0.55580419  0.5724484   0.59028865  0.60832325  0.62699506
  0.64626284  0.66592817  0.68654864  0.70706857]
Iteration 19 [23.0 s]: loss = 0.734128 [84.82 s],
NDCG_rank: [ 0.7678068   0.75554359  0.75010541  0.75084217  0.75453901  0.76173323
  0.77086781  0.78209312  0.79483779  0.80879922]
NDCG_rating1: [ 0.77618566  0.7600797   0.75435912  0.75425301  0.75804499  0.76501498
  0.77409073  0.78552577  0.7980025   0.81134164]
NDCG_rating2: [ 0.54105587  0.55958134  0.57643087  0.59377457  0.61141397  0.63043587
  0.64948214  0.66895887  0.6889017   0.70954354]
Iteration 20 [23.0 s]: loss = 0.725398 [84.40 s],
NDCG_rank: [ 0.76979022  0.7556415   0.75045563  0.75002644  0.75382156  0.76099902
  0.77016128  0.78190674  0.79502591  0.80886619]
NDCG_rating1: [ 0.7761857   0.76012564  0.75417994  0.75378906  0.75728633  0.76455613
  0.77380805  0.78502627  0.79725448  0.81084991]
NDCG_rating2: [ 0.54224881  0.55974571  0.57693785  0.59437181  0.61240121  0.63115891
  0.64969195  0.66966704  0.68972413  0.71008476]
Iteration 21 [22.7 s]: loss = 0.716699 [83.63 s],
NDCG_rank: [ 0.76704053  0.754495    0.74926172  0.7490183   0.75310598  0.76053761
  0.76978788  0.78129802  0.79417519  0.80819849]
NDCG_rating1: [ 0.7742875   0.75931841  0.75315107  0.75267135  0.75595937  0.76300839
  0.77257429  0.78366819  0.79619519  0.80989551]
NDCG_rating2: [ 0.54774943  0.56589174  0.58250087  0.60015811  0.61805013  0.63624132
  0.65465861  0.67370567  0.69363969  0.71360595]




liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [1.,0,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[1.,0,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.3 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [81.3], Init: NDCG = 
(array([ 0.55673874,  0.56174019,  0.57002639,  0.57953904,  0.59238671,
        0.6079016 ,  0.62477049,  0.64359488,  0.66402156,  0.68671037]), array([ 0.56168902,  0.56808148,  0.5763024 ,  0.58585142,  0.59857992,
        0.61294456,  0.62957237,  0.64769686,  0.6679674 ,  0.6901559 ]), array([ 0.56845401,  0.57146345,  0.57751683,  0.5875327 ,  0.59921792,
        0.61322179,  0.62949173,  0.64825039,  0.6681213 ,  0.69030277]))
Iteration 0 [25.0 s]: loss = 0.685922 [77.58 s],
NDCG_rank: [ 0.7187785   0.71421384  0.71541139  0.71956655  0.72728986  0.73616724
  0.74762648  0.76024544  0.77385994  0.78908402]
NDCG_rating1: [ 0.39352862  0.41201353  0.42953922  0.44806977  0.46730142  0.48737045
  0.51001426  0.53415594  0.56058245  0.58976216]
NDCG_rating2: [ 0.39795861  0.41600516  0.4343159   0.45193164  0.47110452  0.49186212
  0.51445251  0.53905686  0.56547584  0.59372545]
Iteration 1 [20.1 s]: loss = 0.642417 [78.94 s],
NDCG_rank: [ 0.73762507  0.73309578  0.73192773  0.73448975  0.7402723   0.74838803
  0.75900914  0.77121916  0.78446294  0.79898625]
NDCG_rating1: [ 0.37036275  0.39171887  0.41097851  0.43066757  0.45131151  0.47367406
  0.49687876  0.52195916  0.54917041  0.57911358]
NDCG_rating2: [ 0.38039681  0.40030828  0.41950465  0.43934428  0.45922677  0.48080258
  0.50380556  0.5282194   0.55543591  0.58486603]
Iteration 2 [19.9 s]: loss = 0.623584 [77.38 s],
NDCG_rank: [ 0.74710605  0.73985709  0.73671982  0.73866217  0.74385536  0.7517904
  0.76162136  0.7735773   0.78706989  0.80118049]
NDCG_rating1: [ 0.3663544   0.38823978  0.408114    0.42883688  0.44993202  0.47167769
  0.49537113  0.52043299  0.54803694  0.57758736]
NDCG_rating2: [ 0.37750024  0.39748639  0.4179847   0.43755624  0.45747518  0.47903284
  0.50267738  0.52741263  0.55442819  0.58387379]
Iteration 3 [19.7 s]: loss = 0.610499 [77.63 s],
NDCG_rank: [ 0.75005916  0.74055938  0.73763352  0.73848053  0.74462522  0.75218188
  0.76220317  0.77393234  0.7874889   0.80187202]
NDCG_rating1: [ 0.36635723  0.38776967  0.407999    0.42838375  0.44973735  0.47160404
  0.49535969  0.52101314  0.5486264   0.57830512]
NDCG_rating2: [ 0.37692735  0.3983468   0.41767365  0.43788507  0.45813155  0.47988422
  0.50323573  0.52826662  0.55534003  0.58468915]
Iteration 4 [19.6 s]: loss = 0.596895 [77.55 s],
NDCG_rank: [ 0.74787199  0.73880379  0.73555477  0.73689913  0.74234907  0.75049211
  0.76057105  0.77249697  0.78583816  0.80040061]
NDCG_rating1: [ 0.36884437  0.38967963  0.40980173  0.42992321  0.45141055  0.47405431
  0.49795643  0.52306331  0.55043601  0.58011799]
NDCG_rating2: [ 0.37908276  0.40005621  0.42060294  0.4408547   0.46163484  0.48300086
  0.50632639  0.5313241   0.55841049  0.58731529]
Iteration 5 [19.6 s]: loss = 0.581828 [77.69 s],
NDCG_rank: [ 0.74562131  0.73521021  0.73181139  0.73379088  0.73910094  0.74705243
  0.7579576   0.76998743  0.7833833   0.79840505]
NDCG_rating1: [ 0.37119787  0.39169243  0.41286257  0.43291057  0.45392919  0.47717806
  0.50110048  0.5261415   0.55322676  0.58266397]
NDCG_rating2: [ 0.38507515  0.40592114  0.42675673  0.44617432  0.46698403  0.48875408
  0.51196793  0.53697714  0.56351783  0.59184781]
Iteration 6 [19.6 s]: loss = 0.564641 [77.72 s],
NDCG_rank: [ 0.73992794  0.72783266  0.72472667  0.72668804  0.73297283  0.74125461
  0.75216885  0.76504774  0.77861662  0.79365123]
NDCG_rating1: [ 0.37441668  0.39538995  0.41613612  0.43658432  0.45816149  0.48090663
  0.5047323   0.52997659  0.55667613  0.58597827]
NDCG_rating2: [ 0.39473661  0.41543541  0.43574367  0.45514457  0.47526272  0.49674345
  0.51949117  0.54351922  0.56975127  0.59815358]
Iteration 7 [19.6 s]: loss = 0.545484 [77.36 s],
NDCG_rank: [ 0.72952223  0.71974839  0.71593411  0.71845944  0.72397317  0.73289261
  0.74435483  0.75729467  0.77173431  0.78718372]
NDCG_rating1: [ 0.37907778  0.40150926  0.42225816  0.44274319  0.46397301  0.48600955
  0.50985987  0.53456766  0.56141344  0.59006257]
NDCG_rating2: [ 0.40284637  0.42325911  0.44390668  0.46348041  0.48269827  0.50322844
  0.52601634  0.54979028  0.57576233  0.60340593]
Iteration 8 [19.7 s]: loss = 0.524619 [77.04 s],
NDCG_rank: [ 0.71935799  0.70889725  0.70657988  0.70869599  0.71516464  0.72487053
  0.73646825  0.74977676  0.76462267  0.78024451]
NDCG_rating1: [ 0.38291035  0.40666083  0.42772214  0.44784752  0.46852784  0.49058476
  0.51357427  0.5380069   0.5644886   0.59305262]
NDCG_rating2: [ 0.41182646  0.43337604  0.45172371  0.47071752  0.49042247  0.51101656
  0.53248665  0.55616833  0.58120677  0.60877525]
Iteration 9 [19.7 s]: loss = 0.503073 [77.92 s],
NDCG_rank: [ 0.70823282  0.69958256  0.69751718  0.70058518  0.7075981   0.71711079
  0.72940751  0.74304019  0.75802629  0.77418458]
NDCG_rating1: [ 0.38612539  0.41007887  0.43073495  0.44986322  0.47108881  0.49287177
  0.5156898   0.54030782  0.56623127  0.59452821]
NDCG_rating2: [ 0.417955    0.43900018  0.45741702  0.47638445  0.49473707  0.51509807
  0.53712973  0.56032616  0.58497532  0.61237424]
Iteration 10 [19.6 s]: loss = 0.481938 [77.40 s],
NDCG_rank: [ 0.69561069  0.6906915   0.68967889  0.69367708  0.70039352  0.7104855
  0.72283997  0.73677151  0.75226742  0.76860412]
NDCG_rating1: [ 0.3886795   0.412485    0.43251047  0.45256238  0.47296427  0.49399828
  0.51711139  0.54114088  0.5672008   0.59556852]
NDCG_rating2: [ 0.42470925  0.44485733  0.46267949  0.48093402  0.499897    0.51987762
  0.54138762  0.56417688  0.58864866  0.61569844]
Iteration 11 [19.8 s]: loss = 0.461480 [77.36 s],
NDCG_rank: [ 0.68336588  0.68051887  0.68139852  0.68507898  0.69307172  0.70388254
  0.71658761  0.73010948  0.74573269  0.76285298]
NDCG_rating1: [ 0.38999381  0.41316698  0.43423317  0.45390554  0.47346156  0.49470902
  0.51755519  0.5417389   0.56807624  0.59599508]
NDCG_rating2: [ 0.43075069  0.44927212  0.46614655  0.48379939  0.50211045  0.52215395
  0.54390994  0.56645913  0.59111178  0.6179866 ]
Iteration 12 [19.6 s]: loss = 0.442014 [79.98 s],
NDCG_rank: [ 0.67552559  0.6738821   0.67568325  0.68017288  0.68783376  0.69893278
  0.71208343  0.72644452  0.74241581  0.75972296]
NDCG_rating1: [ 0.39327425  0.4144019   0.43564624  0.45484647  0.47492052  0.49543437
  0.51798272  0.54204033  0.56799292  0.59652239]
NDCG_rating2: [ 0.43213607  0.45238524  0.4686817   0.48646331  0.50461929  0.52477693
  0.54588176  0.5685604   0.59293437  0.61953803]
Iteration 13 [20.7 s]: loss = 0.423569 [87.34 s],
NDCG_rank: [ 0.66715926  0.66823301  0.6694613   0.67512619  0.68283366  0.69431276
  0.70742324  0.72238174  0.73852368  0.75628042]
NDCG_rating1: [ 0.3955243   0.41640908  0.43588193  0.45568621  0.475458    0.49596947
  0.5183734   0.54211898  0.568331    0.59648494]
NDCG_rating2: [ 0.4338997   0.45334507  0.47024952  0.48813627  0.50656817  0.52637971
  0.54769749  0.57025224  0.5946057   0.62096882]
Iteration 14 [20.5 s]: loss = 0.406340 [85.54 s],
NDCG_rank: [ 0.66503283  0.66255455  0.66461251  0.67074638  0.67919388  0.69110701
  0.7044135   0.71962544  0.73592277  0.75358337]
NDCG_rating1: [ 0.3964286   0.41721114  0.43719514  0.45706198  0.47603691  0.49639392
  0.5185891   0.54283529  0.56859205  0.59689725]
NDCG_rating2: [ 0.43753041  0.45522054  0.4723352   0.49000555  0.5080286   0.52785573
  0.54898031  0.57164299  0.59583386  0.6220443 ]
Iteration 15 [19.9 s]: loss = 0.390229 [78.06 s],
NDCG_rank: [ 0.65902975  0.65810296  0.66019278  0.66645103  0.67550645  0.68723307
  0.70077252  0.71637452  0.73272621  0.75054513]
NDCG_rating1: [ 0.39710368  0.41741955  0.43713712  0.45718779  0.4762891   0.49629666
  0.51854701  0.54258134  0.56877808  0.59683728]
NDCG_rating2: [ 0.43873719  0.45525575  0.47259439  0.49007274  0.5084268   0.5281538
  0.54953793  0.57229019  0.59630251  0.62274737]
Iteration 16 [19.7 s]: loss = 0.375328 [77.77 s],
NDCG_rank: [ 0.65498147  0.65384619  0.65657255  0.66352994  0.673199    0.68505572
  0.69913196  0.71434773  0.7310455   0.74900158]
NDCG_rating1: [ 0.39667103  0.41734146  0.43753423  0.45731238  0.47619677  0.49627589
  0.51868659  0.54248268  0.5685279   0.59679923]
NDCG_rating2: [ 0.43902489  0.45638268  0.47289115  0.49024111  0.50858439  0.52849965
  0.5501307   0.5724379   0.59666114  0.62294763]
Iteration 17 [19.8 s]: loss = 0.361715 [77.95 s],
NDCG_rank: [ 0.64730154  0.64792807  0.65141516  0.65903826  0.66858225  0.68136847
  0.69556103  0.71113607  0.72825185  0.74636149]
NDCG_rating1: [ 0.3982655   0.41948237  0.43871572  0.45762938  0.47694521  0.4968102
  0.5189775   0.54335838  0.56932091  0.59726631]
NDCG_rating2: [ 0.44122783  0.4579753   0.47389988  0.49140626  0.50980908  0.52980888
  0.55086496  0.57344021  0.5974545   0.62396993]
Iteration 18 [20.0 s]: loss = 0.349349 [77.93 s],
NDCG_rank: [ 0.64530555  0.64582991  0.65022443  0.65772612  0.66797474  0.68052168
  0.69465173  0.71015512  0.72734167  0.74547088]
NDCG_rating1: [ 0.39866388  0.41919738  0.43829441  0.45761088  0.47695294  0.49717973
  0.51907715  0.54325785  0.56893121  0.59718111]
NDCG_rating2: [ 0.44252449  0.45892949  0.47612183  0.49299979  0.51062644  0.53079154
  0.55204512  0.57480045  0.59884621  0.62484901]
Iteration 19 [20.4 s]: loss = 0.338326 [80.49 s],
NDCG_rank: [ 0.64653056  0.64430177  0.64937118  0.65681483  0.66663444  0.67936472
  0.6934354   0.70903602  0.72599272  0.74445458]
NDCG_rating1: [ 0.40000115  0.42018218  0.43952444  0.45864836  0.47792508  0.49767044
  0.51983673  0.54379793  0.56945222  0.59789005]
NDCG_rating2: [ 0.44500156  0.46102627  0.47695441  0.49352873  0.51216427  0.53169872
  0.5529267   0.57561075  0.5994374   0.62580096]
Iteration 20 [19.7 s]: loss = 0.328628 [77.75 s],
NDCG_rank: [ 0.64066552  0.64280461  0.64688904  0.65456144  0.66493791  0.6773282
  0.69155375  0.70734461  0.72430864  0.74288425]
NDCG_rating1: [ 0.39904874  0.420348    0.43905786  0.45813582  0.47728254  0.49766214
  0.51968035  0.54360201  0.56926395  0.59756952]
NDCG_rating2: [ 0.44457834  0.46172988  0.47785062  0.49418643  0.51273458  0.53194046
  0.55321454  0.5756043   0.59987561  0.62600471]
Iteration 21 [19.9 s]: loss = 0.319793 [77.91 s],
NDCG_rank: [ 0.64142926  0.63988813  0.6440608   0.65289056  0.66338872  0.67604934
  0.69019243  0.70580223  0.7232354   0.74169092]
NDCG_rating1: [ 0.39943549  0.42108894  0.44010479  0.45862429  0.47774445  0.49792021
  0.51998145  0.54380042  0.56945865  0.59775379]
NDCG_rating2: [ 0.44757642  0.46328504  0.47901178  0.4955498   0.51376961  0.53326483
  0.55399467  0.57666503  0.60085678  0.62678545]
Iteration 22 [19.7 s]: loss = 0.312080 [78.38 s],
NDCG_rank: [ 0.6382812   0.63889842  0.64312739  0.65138549  0.66197126  0.67487418
  0.68941599  0.70492937  0.72234151  0.74097602]
NDCG_rating1: [ 0.39894215  0.42144277  0.43973658  0.45898037  0.47775253  0.49830352
  0.52018525  0.54394871  0.56970519  0.59794358]
NDCG_rating2: [ 0.44661458  0.46251568  0.47847783  0.4953628   0.51350009  0.53304531
  0.55394723  0.57624238  0.60018983  0.62643767]
Iteration 23 [19.7 s]: loss = 0.305539 [77.74 s],
NDCG_rank: [ 0.63632262  0.63733375  0.64143499  0.6498393   0.660478    0.67333669
  0.68840293  0.70419902  0.72159164  0.74004866]
NDCG_rating1: [ 0.40101958  0.42221706  0.44090295  0.45936548  0.47856107  0.49860206
  0.52072421  0.54427566  0.57010241  0.59834618]
NDCG_rating2: [ 0.44829898  0.46439889  0.47990612  0.49612769  0.51466449  0.5338576
  0.554873    0.5774277   0.60145127  0.62742549]
Iteration 24 [19.8 s]: loss = 0.299558 [78.12 s],
NDCG_rank: [ 0.63675936  0.6358897   0.64071786  0.64886798  0.66009104  0.67282585
  0.68719445  0.70343473  0.72088636  0.73964838]
NDCG_rating1: [ 0.40154656  0.42236359  0.44057697  0.45937041  0.47821222  0.49858685
  0.52086791  0.54442442  0.57013291  0.59861927]
NDCG_rating2: [ 0.44965448  0.46557869  0.4812239   0.49740481  0.51584509  0.53482236
  0.55564927  0.57772744  0.60164301  0.62799716]
Iteration 25 [20.0 s]: loss = 0.294575 [77.54 s],
NDCG_rank: [ 0.63369179  0.63487744  0.6397045   0.64936049  0.65965165  0.67213567
  0.68688598  0.70290444  0.72050318  0.73907598]
NDCG_rating1: [ 0.40074383  0.42196016  0.4408493   0.45949167  0.47855072  0.49888798
  0.52068741  0.54436987  0.57003451  0.59855082]
NDCG_rating2: [ 0.44906587  0.465204    0.48061206  0.49698388  0.51568544  0.53471961
  0.55529243  0.5779138   0.60197062  0.62803011]
Iteration 26 [19.8 s]: loss = 0.290029 [77.74 s],
NDCG_rank: [ 0.63252589  0.63424425  0.63979474  0.64795404  0.65888912  0.67209117
  0.68674348  0.70277564  0.72045409  0.73922814]
NDCG_rating1: [ 0.40226975  0.42127102  0.44004964  0.4592896   0.4781407   0.49887664
  0.52057284  0.54414025  0.56989068  0.5983684 ]
NDCG_rating2: [ 0.44990917  0.46483382  0.48074192  0.4974036   0.51558592  0.53470573
  0.55558365  0.57773449  0.60185211  0.62804209]
Iteration 27 [19.9 s]: loss = 0.286378 [77.95 s],
NDCG_rank: [ 0.63117227  0.63271274  0.63907856  0.64869413  0.65881112  0.67141784
  0.68620203  0.70264592  0.71993803  0.73887913]
NDCG_rating1: [ 0.40028004  0.42177137  0.440039    0.45880198  0.47774721  0.49859795
  0.52069353  0.54386916  0.56972395  0.59826637]
NDCG_rating2: [ 0.45008022  0.46575173  0.48148132  0.49773843  0.51552742  0.53475808
  0.55563105  0.57808167  0.60226462  0.62808177]
Iteration 28 [19.8 s]: loss = 0.282818 [78.21 s],
NDCG_rank: [ 0.63135401  0.63218821  0.63832521  0.6466835   0.65727362  0.67066256
  0.68533075  0.70124659  0.71865017  0.73773679]
NDCG_rating1: [ 0.40320046  0.42204002  0.44017066  0.45921718  0.47807933  0.49861615
  0.52076751  0.54455257  0.57017318  0.59869323]
NDCG_rating2: [ 0.45084617  0.46627068  0.48161689  0.49789506  0.51631207  0.53565385
  0.55613808  0.57860208  0.60230926  0.62857002]
Iteration 29 [19.8 s]: loss = 0.279925 [78.07 s],
NDCG_rank: [ 0.63232686  0.63303496  0.63854042  0.64813287  0.65908062  0.67158342
  0.68625653  0.70229506  0.71986499  0.73858718]
NDCG_rating1: [ 0.40053159  0.42078367  0.43995803  0.45896611  0.47797088  0.49840565
  0.52061009  0.54427568  0.56976768  0.59836647]
NDCG_rating2: [ 0.44815057  0.46457721  0.48048915  0.4977892   0.51575629  0.53500627
  0.55550498  0.57811527  0.60257706  0.62817582]
Iteration 30 [19.9 s]: loss = 0.277037 [77.93 s],
NDCG_rank: [ 0.63083458  0.63244232  0.6381568   0.64723674  0.65747947  0.67052028
  0.68548364  0.70170142  0.71924191  0.73798007]
NDCG_rating1: [ 0.40146135  0.42216839  0.43984829  0.45892264  0.47794908  0.49883815
  0.52086497  0.54429411  0.57013824  0.59868881]
NDCG_rating2: [ 0.45198597  0.46625598  0.48199041  0.49856327  0.5165164   0.53522986
  0.55630084  0.57883451  0.60284486  0.62882098]
Iteration 31 [19.8 s]: loss = 0.274740 [78.18 s],
NDCG_rank: [ 0.63098739  0.63093634  0.63694729  0.64626334  0.65695975  0.66978292
  0.68476755  0.70096743  0.71857346  0.73731179]
NDCG_rating1: [ 0.40011214  0.42107324  0.43915351  0.45835328  0.47774338  0.49851352
  0.52035124  0.54412025  0.56970058  0.59830287]
NDCG_rating2: [ 0.44866717  0.46543723  0.48172089  0.49821135  0.51596531  0.53512629
  0.55600069  0.57831664  0.60279397  0.62844033]



liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [1.,0,0] --lr 0.00001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[1.,0,0]', lr=1e-05, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.0 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [76.3], Init: NDCG = 
(array([ 0.55978708,  0.56432176,  0.57150681,  0.58210417,  0.59463271,
        0.60941591,  0.62604102,  0.64480224,  0.66544178,  0.68777472]), array([ 0.55591642,  0.56177242,  0.57200724,  0.5819572 ,  0.59452261,
        0.60923065,  0.62587946,  0.64459937,  0.66476218,  0.68706953]), array([ 0.56242168,  0.56710307,  0.57411973,  0.58408934,  0.59658543,
        0.61121199,  0.62761443,  0.64533024,  0.66570712,  0.68810606]))
Iteration 0 [24.3 s]: loss = 0.693114 [75.19 s],
NDCG_rank: [ 0.59940452  0.59986038  0.60424538  0.61205267  0.62191104  0.63450546
  0.65035585  0.66717777  0.68634438  0.70711105]
NDCG_rating1: [ 0.54469134  0.55217473  0.56204639  0.57272273  0.58503361  0.59984944
  0.6170392   0.63598524  0.6566004   0.67909777]
NDCG_rating2: [ 0.59741229  0.59676638  0.60026097  0.60821701  0.61907877  0.63165211
  0.64715323  0.6641121   0.6828918   0.70359465]
Iteration 1 [20.4 s]: loss = 0.692877 [75.65 s],
NDCG_rank: [ 0.63781077  0.63562179  0.63771079  0.64386135  0.65290163  0.66409346
  0.6774238   0.69300689  0.71089515  0.73029476]
NDCG_rating1: [ 0.51197715  0.52157918  0.53240999  0.54428089  0.55851496  0.57405688
  0.59228755  0.61215294  0.63455696  0.65862457]
NDCG_rating2: [ 0.6360987   0.63087323  0.63167359  0.63814692  0.64678648  0.6577655
  0.67102194  0.686682    0.70410153  0.72377656]
Iteration 2 [20.3 s]: loss = 0.692359 [76.16 s],
NDCG_rank: [ 0.67667829  0.67050258  0.66914168  0.67422436  0.68187593  0.69159512
  0.70410099  0.71849779  0.73474783  0.75263941]
NDCG_rating1: [ 0.47468901  0.48704629  0.49788446  0.51200478  0.52797355  0.54559794
  0.56494379  0.58619108  0.60934549  0.63523702]
NDCG_rating2: [ 0.6686528   0.6597511   0.65909363  0.66268673  0.67009666  0.68029796
  0.69302067  0.70785746  0.72431545  0.74262125]
Iteration 3 [20.2 s]: loss = 0.691153 [75.76 s],
NDCG_rank: [ 0.69963947  0.69253311  0.69198455  0.6953599   0.70212802  0.71176775
  0.72384875  0.73738977  0.7523059   0.76929671]
NDCG_rating1: [ 0.44514813  0.45723126  0.47110688  0.48702166  0.50430738  0.52281044
  0.54322326  0.5655929   0.59032043  0.61717218]
NDCG_rating2: [ 0.69363797  0.68410161  0.68282247  0.68532182  0.69226922  0.70205587
  0.71432459  0.72837839  0.74403281  0.76128477]
Iteration 4 [20.2 s]: loss = 0.688635 [75.60 s],
NDCG_rank: [ 0.7116123   0.70456763  0.70490233  0.70820584  0.71511008  0.72461886
  0.73607598  0.74901604  0.76332004  0.77895937]
NDCG_rating1: [ 0.42752779  0.44045005  0.456153    0.47275097  0.49039992  0.50996884
  0.53055783  0.55334627  0.5783824   0.6064704 ]
NDCG_rating2: [ 0.70858372  0.70094128  0.69833629  0.70068591  0.70796421  0.71738789
  0.72910083  0.74234034  0.7574559   0.77343683]
Iteration 5 [20.1 s]: loss = 0.684383 [75.80 s],
NDCG_rank: [ 0.71786037  0.71162505  0.71126803  0.71442102  0.7217861   0.7311069
  0.74240993  0.75467771  0.7691517   0.78453112]
NDCG_rating1: [ 0.4193039   0.43247734  0.44769297  0.46400542  0.48188901  0.50151839
  0.52255124  0.54637069  0.57181046  0.60014539]
NDCG_rating2: [ 0.7162473   0.70869656  0.70600795  0.70856365  0.71576275  0.72497573
  0.73628389  0.74950761  0.76415868  0.77964977]
Iteration 6 [20.1 s]: loss = 0.678241 [75.61 s],
NDCG_rank: [ 0.72140807  0.71481429  0.71539412  0.71859044  0.72541278  0.73513495
  0.74614369  0.75872702  0.7729469   0.7879259 ]
NDCG_rating1: [ 0.41536693  0.42760786  0.44252584  0.45864272  0.47683927  0.49699726
  0.51848565  0.54212387  0.56799168  0.59650871]
NDCG_rating2: [ 0.72038582  0.71348396  0.7109316   0.71385918  0.72033635  0.7295429
  0.74080605  0.7537711   0.76795541  0.78329422]
Iteration 7 [20.1 s]: loss = 0.670404 [75.75 s],
NDCG_rank: [ 0.72585284  0.71842271  0.71892714  0.72171567  0.72831479  0.73778727
  0.74908401  0.76170031  0.77543965  0.79031694]
NDCG_rating1: [ 0.41406709  0.42773013  0.44151228  0.45723727  0.47479561  0.4948967
  0.51662048  0.54026598  0.56631782  0.59505166]
NDCG_rating2: [ 0.72340276  0.71666771  0.714633    0.71735326  0.72370335  0.73294548
  0.74365159  0.7566531   0.77072468  0.78590247]
Iteration 8 [20.1 s]: loss = 0.661440 [75.50 s],
NDCG_rank: [ 0.72915781  0.72183828  0.72170591  0.72462375  0.73092097  0.74024375
  0.75126078  0.76364944  0.77729149  0.79225634]
NDCG_rating1: [ 0.41531663  0.42660397  0.44042154  0.45616998  0.47374433  0.49374933
  0.5154244   0.53900035  0.56526848  0.59395534]
NDCG_rating2: [ 0.72710014  0.71947923  0.71773527  0.72002396  0.72647171  0.73523334
  0.74605427  0.75893208  0.77272168  0.78773179]
Iteration 9 [20.5 s]: loss = 0.652147 [79.80 s],
NDCG_rank: [ 0.73100728  0.7235196   0.72374335  0.72710687  0.73286069  0.74170207
  0.75290775  0.76517151  0.77883142  0.79367641]
NDCG_rating1: [ 0.41490472  0.42600653  0.43959147  0.45535922  0.47283336  0.49269335
  0.51441775  0.53802421  0.56430589  0.59307662]
NDCG_rating2: [ 0.72978882  0.72168745  0.71959315  0.72205213  0.72852446  0.73704604
  0.74780391  0.76056154  0.77429467  0.78916031]
Iteration 10 [20.0 s]: loss = 0.643417 [75.05 s],
NDCG_rank: [ 0.73303094  0.72473063  0.72509579  0.72867748  0.73497431  0.74352038
  0.75450914  0.76653826  0.77988687  0.79444959]
NDCG_rating1: [ 0.41450068  0.42553601  0.43944455  0.45430927  0.47189646  0.49185109
  0.51332699  0.53705783  0.56336485  0.59247591]
NDCG_rating2: [ 0.73188858  0.72360274  0.72160133  0.72360522  0.72996931  0.73858867
  0.74948239  0.76194639  0.77573863  0.79045039]
Iteration 11 [19.8 s]: loss = 0.635913 [74.00 s],
NDCG_rank: [ 0.73664845  0.72775576  0.72695273  0.73033641  0.73638683  0.74500049
  0.75595039  0.76792446  0.78136186  0.7958305 ]
NDCG_rating1: [ 0.41286156  0.42412659  0.43863238  0.45294079  0.47069882  0.49063235
  0.51230113  0.53621365  0.56224029  0.59153313]
NDCG_rating2: [ 0.73471215  0.72518547  0.72349828  0.72553899  0.73151998  0.73996499
  0.75051545  0.76303726  0.77682806  0.79148239]
Iteration 12 [19.7 s]: loss = 0.629875 [74.41 s],
NDCG_rank: [ 0.73752036  0.73027361  0.72850086  0.73175984  0.73786427  0.74600572
  0.75689288  0.76892128  0.78207115  0.79670265]
NDCG_rating1: [ 0.41149631  0.42274026  0.43707882  0.45179247  0.46958445  0.48958722
  0.51128797  0.53516254  0.56128353  0.59048085]
NDCG_rating2: [ 0.7367094   0.72664929  0.72526187  0.72739357  0.7330366   0.74132901
  0.75154405  0.76426629  0.77795063  0.79262211]
Iteration 13 [19.8 s]: loss = 0.625209 [73.86 s],
NDCG_rank: [ 0.73976067  0.73083283  0.72990818  0.7322384   0.73918537  0.74671464
  0.75758189  0.76995213  0.78292726  0.79757202]
NDCG_rating1: [ 0.40938618  0.42058955  0.43437384  0.44980421  0.46780065  0.48793366
  0.50986349  0.53381047  0.55997804  0.58923903]
NDCG_rating2: [ 0.7386705   0.72867843  0.72652952  0.72845466  0.73431324  0.74249997
  0.75269663  0.7651428   0.77880969  0.7932988 ]
Iteration 14 [19.9 s]: loss = 0.621700 [74.77 s],
NDCG_rank: [ 0.74135011  0.7334718   0.73187913  0.73362832  0.74008037  0.74789796
  0.75882754  0.7707037   0.78365864  0.79844702]
NDCG_rating1: [ 0.40700411  0.41862555  0.43213231  0.44821064  0.46653539  0.4866134
  0.5085405   0.53251135  0.55890374  0.58813004]
NDCG_rating2: [ 0.73974679  0.73021684  0.7276774   0.72933999  0.73526674  0.74331419
  0.75341024  0.76590609  0.77940629  0.7937414 ]
Iteration 15 [19.7 s]: loss = 0.618969 [74.25 s],
NDCG_rank: [ 0.74599988  0.73503787  0.73352583  0.73493392  0.74103748  0.74906638
  0.7597112   0.77134625  0.7847475   0.79938696]
NDCG_rating1: [ 0.40619477  0.41630685  0.4303329   0.44631877  0.46483912  0.48527633
  0.50704754  0.53132633  0.5577729   0.58712992]
NDCG_rating2: [ 0.73997789  0.73057617  0.72820898  0.730073    0.73573598  0.74365962
  0.75410916  0.76613479  0.77977251  0.79411028]
Iteration 16 [19.6 s]: loss = 0.616782 [73.92 s],
NDCG_rank: [ 0.74733998  0.73714723  0.73438233  0.73639547  0.74203762  0.75016159
  0.76019839  0.77213368  0.78544063  0.79993086]
NDCG_rating1: [ 0.40264612  0.41375973  0.42836144  0.44473545  0.46325581  0.48377552
  0.50594089  0.52996825  0.55652424  0.58597346]
NDCG_rating2: [ 0.74076145  0.73137055  0.72838076  0.73050574  0.73604592  0.74423473
  0.75435955  0.76662125  0.78013336  0.79445642]
Iteration 17 [19.7 s]: loss = 0.614973 [73.95 s],
NDCG_rank: [ 0.75000225  0.73868234  0.73560632  0.73703243  0.74259081  0.75093279
  0.7611479   0.77288965  0.78628559  0.80061603]
NDCG_rating1: [ 0.40203959  0.41276663  0.42703016  0.44377385  0.46232601  0.48297916
  0.50528536  0.52944136  0.55597365  0.58538047]
NDCG_rating2: [ 0.74146483  0.73152055  0.72866689  0.73080377  0.73632292  0.744322
  0.7546113   0.76683904  0.78026583  0.79469609]
Iteration 18 [19.6 s]: loss = 0.613440 [74.27 s],
NDCG_rank: [ 0.75184732  0.73994088  0.73614675  0.73743833  0.74312429  0.75136321
  0.76139872  0.7730994   0.78645389  0.80110921]
NDCG_rating1: [ 0.40161857  0.41121015  0.42571932  0.44317105  0.46178816  0.48232967
  0.50459147  0.52885037  0.55543502  0.58489962]
NDCG_rating2: [ 0.74224839  0.73132564  0.72904246  0.73107159  0.73653333  0.7445697
  0.75480342  0.76710588  0.78037945  0.79500717]
Iteration 19 [19.8 s]: loss = 0.612095 [74.54 s],
NDCG_rank: [ 0.75106754  0.74127897  0.73753659  0.7383584   0.74390044  0.75159436
  0.76161626  0.77344177  0.78668725  0.80120818]
NDCG_rating1: [ 0.39978891  0.40979711  0.42446224  0.44223415  0.46070902  0.48149692
  0.50395944  0.52816374  0.55467693  0.58424096]
NDCG_rating2: [ 0.74217418  0.73167075  0.72892307  0.73113711  0.73661335  0.7446725
  0.75504215  0.76713856  0.78055415  0.79506987]
Iteration 20 [19.6 s]: loss = 0.610906 [74.78 s],
NDCG_rank: [ 0.75171023  0.74158493  0.73743101  0.7382446   0.74396226  0.7514257
  0.76200046  0.77366472  0.78701489  0.80143867]
NDCG_rating1: [ 0.39830386  0.40914181  0.42377534  0.44138055  0.4601853   0.48097825
  0.50343378  0.52772974  0.55434318  0.58386334]
NDCG_rating2: [ 0.74140037  0.73138013  0.72854874  0.73076416  0.73636723  0.74453387
  0.75493709  0.7669835   0.78054337  0.79494858]
Iteration 21 [19.7 s]: loss = 0.609839 [74.53 s],
NDCG_rank: [ 0.75378924  0.741498    0.73747689  0.73851413  0.74404861  0.75200276
  0.76239393  0.77391738  0.78722801  0.8016774 ]
NDCG_rating1: [ 0.39556204  0.40749116  0.42211542  0.44031826  0.45922104  0.47979354
  0.50278291  0.52700494  0.55366364  0.583244  ]
NDCG_rating2: [ 0.74128718  0.73111771  0.72851716  0.7307236   0.73629444  0.74447645
  0.75489044  0.76699855  0.78044728  0.79491119]
Iteration 22 [19.7 s]: loss = 0.608861 [74.56 s],
NDCG_rank: [ 0.75428855  0.74179365  0.73815709  0.73889914  0.74393911  0.75204328
  0.76256204  0.77417714  0.7874329   0.8019775 ]
NDCG_rating1: [ 0.39420842  0.40668403  0.42187471  0.4399695   0.45870207  0.47950534
  0.50236216  0.52665403  0.55340648  0.58293308]
NDCG_rating2: [ 0.7421267   0.73082601  0.72861575  0.73066891  0.73620239  0.74450709
  0.75489289  0.76695144  0.78055439  0.79499812]
Iteration 23 [19.7 s]: loss = 0.607961 [74.42 s],
NDCG_rank: [ 0.75402883  0.74202206  0.7382921   0.73847638  0.74371999  0.75207718
  0.76262264  0.77424496  0.78743245  0.80200111]
NDCG_rating1: [ 0.39388298  0.40650748  0.42193961  0.43966445  0.45855657  0.47921446
  0.50218942  0.52641712  0.5533058   0.58283039]
NDCG_rating2: [ 0.74130856  0.73066466  0.72841576  0.73021961  0.73586292  0.74437541
  0.75460558  0.76678769  0.78046306  0.79489063]
Iteration 24 [19.6 s]: loss = 0.607126 [75.91 s],
NDCG_rank: [ 0.75250857  0.74194478  0.73791124  0.73855745  0.74396345  0.75212782
  0.76246304  0.77394143  0.78723378  0.80169181]
NDCG_rating1: [ 0.39228191  0.40582553  0.42152216  0.43916015  0.45802277  0.47880648
  0.50166633  0.52600085  0.55298812  0.58248595]
NDCG_rating2: [ 0.74077183  0.73034831  0.72813332  0.7298867   0.73560235  0.74439652
  0.75452521  0.76670174  0.7803165   0.79467072]
Iteration 25 [19.9 s]: loss = 0.606331 [74.04 s],
NDCG_rank: [ 0.75375874  0.74191899  0.73830243  0.73908458  0.74412446  0.75236241
  0.76255235  0.77397701  0.7873285   0.80181944]
NDCG_rating1: [ 0.3915625   0.405056    0.42103184  0.4390482   0.45764002  0.47848327
  0.50126473  0.52565751  0.5528385   0.58227449]
NDCG_rating2: [ 0.74045425  0.72975726  0.72785876  0.72972834  0.73545638  0.74418419
  0.75445473  0.7665639   0.78027274  0.794619  ]
Iteration 26 [19.7 s]: loss = 0.605568 [74.32 s],
NDCG_rank: [ 0.75362668  0.74201751  0.73853373  0.73944468  0.74436079  0.75249906
  0.76267154  0.77412021  0.78740837  0.80192091]
NDCG_rating1: [ 0.39146031  0.40523138  0.42095838  0.43875878  0.45735198  0.47842272
  0.50108182  0.52556168  0.55265569  0.58220102]
NDCG_rating2: [ 0.74065706  0.72939851  0.7279352   0.72960518  0.73530305  0.74416553
  0.75432541  0.76653003  0.78023188  0.79469835]
Iteration 27 [19.6 s]: loss = 0.604838 [74.56 s],
NDCG_rank: [ 0.75283746  0.74213421  0.73842005  0.73923556  0.74420661  0.75212148
  0.76250028  0.77389279  0.78721444  0.80170743]
NDCG_rating1: [ 0.39143421  0.40536204  0.42088044  0.43874376  0.45724534  0.47833243
  0.50097083  0.52553468  0.55264674  0.582117  ]
NDCG_rating2: [ 0.74062876  0.72952996  0.72759008  0.72954949  0.7353107   0.74409743
  0.75440528  0.76646642  0.78022645  0.79460534]
Iteration 28 [19.6 s]: loss = 0.604132 [74.44 s],
NDCG_rank: [ 0.75408983  0.74200345  0.73881002  0.73944939  0.74476176  0.75264182
  0.76284889  0.77439119  0.78763796  0.80204268]
NDCG_rating1: [ 0.39102923  0.40542786  0.42064148  0.43859653  0.45726954  0.47829234
  0.50085934  0.52551304  0.55244374  0.58206486]
NDCG_rating2: [ 0.73989551  0.72912618  0.72720526  0.72915552  0.73505788  0.74368239
  0.75407469  0.76619842  0.7799422   0.79438115]
Iteration 29 [19.6 s]: loss = 0.603438 [74.56 s],
NDCG_rank: [ 0.7527686   0.74179475  0.73840634  0.73961874  0.74435574  0.75220378
  0.76241403  0.77398613  0.78733741  0.80177894]
NDCG_rating1: [ 0.39176688  0.40553508  0.42073939  0.43866566  0.45732492  0.47829225
  0.50087489  0.52554818  0.55250704  0.58205977]
NDCG_rating2: [ 0.74013857  0.72920014  0.72721973  0.72902013  0.73480471  0.74357754
  0.75414346  0.7662578   0.77998816  0.79445833]
Iteration 30 [19.7 s]: loss = 0.602748 [74.94 s],
NDCG_rank: [ 0.7524809   0.74184807  0.73818059  0.73940979  0.74436432  0.75204896
  0.76224987  0.7738557   0.78740851  0.8019245 ]
NDCG_rating1: [ 0.39263879  0.40540455  0.42062403  0.43853989  0.45713153  0.47833809
  0.50088491  0.52546052  0.55249688  0.58207004]
NDCG_rating2: [ 0.74065863  0.72932702  0.72704437  0.72879921  0.73470758  0.74370701
  0.75422236  0.76617606  0.78000065  0.794466  ]
Iteration 31 [22.2 s]: loss = 0.602064 [74.50 s],
NDCG_rank: [ 0.75300788  0.74214674  0.73776067  0.73953489  0.74411397  0.7519809
  0.76230432  0.77398797  0.787346    0.80183763]
NDCG_rating1: [ 0.39336449  0.4055495   0.42071459  0.43855319  0.45734994  0.47841466
  0.50087563  0.52559981  0.55256337  0.58212742]
NDCG_rating2: [ 0.73928143  0.72912087  0.72661956  0.72837821  0.73451339  0.74357407
  0.75395811  0.76602252  0.77984139  0.79432586]
Iteration 32 [19.7 s]: loss = 0.601380 [74.49 s],
NDCG_rank: [ 0.75241958  0.74221205  0.73748783  0.73888859  0.74399236  0.7519735
  0.76220789  0.77396284  0.78722756  0.80173615]
NDCG_rating1: [ 0.39383865  0.40568395  0.4208709   0.43849176  0.45718152  0.47844025
  0.50084203  0.52565243  0.55262622  0.58214498]
NDCG_rating2: [ 0.73835921  0.7282582   0.72613647  0.72815766  0.73416397  0.74332698
  0.75376669  0.765735    0.77954209  0.79406465]
Iteration 33 [19.6 s]: loss = 0.600696 [74.20 s],
NDCG_rank: [ 0.75307171  0.74226724  0.73760529  0.73892155  0.74415325  0.75190801
  0.76214478  0.77379879  0.78716438  0.80177427]
NDCG_rating1: [ 0.39321671  0.40589283  0.42066461  0.43830613  0.45715629  0.47836279
  0.50074439  0.52560955  0.55257436  0.58212598]
NDCG_rating2: [ 0.73793002  0.72813748  0.72602161  0.72799408  0.73414004  0.74329325
  0.75356159  0.76556355  0.7794903   0.79405764]
Iteration 34 [19.7 s]: loss = 0.599993 [74.29 s],
NDCG_rank: [ 0.75182185  0.74182061  0.73708865  0.73857237  0.74365882  0.75169905
  0.76200767  0.77372596  0.78703593  0.80151909]
NDCG_rating1: [ 0.39390059  0.40633816  0.42089227  0.43842758  0.45727826  0.47845135
  0.50086955  0.52566987  0.55271982  0.5823058 ]
NDCG_rating2: [ 0.73751151  0.72771292  0.72567775  0.72793511  0.73402455  0.74308262
  0.75337304  0.7654961   0.77943511  0.79400042]
Iteration 35 [19.6 s]: loss = 0.599297 [74.36 s],
NDCG_rank: [ 0.75228281  0.74221507  0.7371491   0.73889877  0.74383427  0.75156367
  0.7621704   0.77378196  0.78701712  0.8016155 ]
NDCG_rating1: [ 0.39424363  0.40663861  0.42121024  0.43858145  0.45755741  0.47866734
  0.50104908  0.52587018  0.55286075  0.58237687]
NDCG_rating2: [ 0.73789354  0.72787362  0.72567066  0.72792827  0.73401497  0.74306934
  0.75337774  0.76548299  0.77938142  0.79393995]
Iteration 36 [19.7 s]: loss = 0.598582 [73.93 s],
NDCG_rank: [ 0.75199793  0.74202497  0.7366445   0.73859942  0.74367785  0.75133039
  0.76201464  0.773694    0.78693509  0.8015575 ]
NDCG_rating1: [ 0.39457504  0.40706209  0.42113592  0.43868875  0.45769725  0.47879377
  0.50099461  0.525938    0.55285573  0.58245356]
NDCG_rating2: [ 0.73706942  0.72709713  0.7252955   0.72763335  0.73370148  0.74294634
  0.7531177   0.76529133  0.77920228  0.79376087]
Iteration 37 [19.7 s]: loss = 0.597848 [74.21 s],
NDCG_rank: [ 0.7514873   0.74158645  0.73665769  0.73834109  0.74352537  0.75136813
  0.76160993  0.77356194  0.78686058  0.80165733]
NDCG_rating1: [ 0.39430558  0.40703878  0.4212204   0.43861325  0.45773897  0.47876737
  0.50113053  0.5258823   0.55289898  0.58246192]
NDCG_rating2: [ 0.73665784  0.72683298  0.72500595  0.72758982  0.73372436  0.74281688
  0.75307263  0.76517134  0.77910777  0.79370775]
Iteration 38 [19.6 s]: loss = 0.597100 [73.98 s],
NDCG_rank: [ 0.7527381   0.74170502  0.73692519  0.73863258  0.74341772  0.7511408
  0.7617999   0.77359099  0.78681773  0.80145648]
NDCG_rating1: [ 0.39489733  0.40744571  0.42160189  0.4389686   0.45797482  0.47893241
  0.50123919  0.52601772  0.55308707  0.58265431]
NDCG_rating2: [ 0.73654496  0.7269863   0.72497877  0.72765686  0.73375004  0.7429239
  0.75299034  0.76511576  0.77908227  0.79370753]
Iteration 39 [19.7 s]: loss = 0.596328 [73.92 s],
NDCG_rank: [ 0.75205264  0.74127423  0.73655801  0.73813754  0.7432285   0.75090255
  0.76145606  0.77341354  0.78664066  0.80144653]
NDCG_rating1: [ 0.39444393  0.40749549  0.42174567  0.43889151  0.45781808  0.47892614
  0.50144418  0.52601623  0.5530994   0.58259431]
NDCG_rating2: [ 0.73589409  0.72674121  0.72460415  0.72737702  0.73365235  0.74270724
  0.75290633  0.76509138  0.77901972  0.79361745]
Iteration 40 [19.7 s]: loss = 0.595547 [74.32 s],
NDCG_rank: [ 0.75073959  0.74006721  0.73606903  0.73760091  0.74284872  0.75091834
  0.76108589  0.77317638  0.78655291  0.80101987]
NDCG_rating1: [ 0.3960406   0.40856498  0.42283702  0.43976496  0.45861871  0.47959957
  0.50201919  0.52646488  0.55346163  0.58300484]
NDCG_rating2: [ 0.73598653  0.72662476  0.72471396  0.72731841  0.73347109  0.74287674
  0.75281839  0.76504911  0.77899504  0.79362776]
Iteration 41 [19.7 s]: loss = 0.594743 [74.00 s],
NDCG_rank: [ 0.7512889   0.74035752  0.73647992  0.73761481  0.74310254  0.75092771
  0.76107054  0.77321073  0.78658163  0.80113915]
NDCG_rating1: [ 0.39536206  0.40879012  0.42300908  0.43979949  0.45866907  0.47963854
  0.50202854  0.52668737  0.55349782  0.58310262]
NDCG_rating2: [ 0.73609375  0.72689478  0.72450773  0.72728203  0.73355775  0.74281037
  0.75284043  0.76508879  0.77902441  0.79359869]
Iteration 42 [19.6 s]: loss = 0.593925 [73.98 s],
NDCG_rank: [ 0.75086976  0.74035523  0.736321    0.73747257  0.74296629  0.75068936
  0.76090156  0.77318788  0.78640317  0.80104952]
NDCG_rating1: [ 0.39618335  0.40889331  0.42298422  0.4398925   0.4589387   0.47970536
  0.50228418  0.52684741  0.55358317  0.58313565]
NDCG_rating2: [ 0.73536679  0.72640881  0.72441637  0.72704725  0.73338948  0.74252719
  0.75281627  0.76496993  0.77894918  0.7934612 ]
Iteration 43 [19.6 s]: loss = 0.593074 [74.07 s],
NDCG_rank: [ 0.75002332  0.74011969  0.73593906  0.73736943  0.74272048  0.75045781
  0.76102262  0.77298787  0.786383    0.80090366]
NDCG_rating1: [ 0.39719644  0.40972672  0.42351748  0.44023653  0.45933972  0.48010251
  0.50264152  0.52713182  0.55386507  0.58337587]
NDCG_rating2: [ 0.73574096  0.72642222  0.72436872  0.72711717  0.73334945  0.74249064
  0.7527357   0.76486775  0.77894534  0.79348381]
Iteration 44 [19.7 s]: loss = 0.592219 [73.98 s],
NDCG_rank: [ 0.74982774  0.74042422  0.73614318  0.73716909  0.74250194  0.75044523
  0.76084691  0.77288563  0.78625372  0.80088605]
NDCG_rating1: [ 0.39776147  0.41017889  0.4242109   0.44062109  0.45970251  0.48051237
  0.50315808  0.52751685  0.5542136   0.58372092]
NDCG_rating2: [ 0.73509009  0.72639804  0.72427887  0.72686154  0.73305516  0.74234735
  0.75252649  0.76466908  0.77879568  0.79340597]
Iteration 45 [19.7 s]: loss = 0.591342 [73.99 s],
NDCG_rank: [ 0.74939886  0.73971986  0.73590396  0.73671674  0.74219276  0.75015725
  0.76059427  0.77289112  0.7862267   0.80078336]
NDCG_rating1: [ 0.39810797  0.41031496  0.42463219  0.44114451  0.45994767  0.48078145
  0.50350886  0.52793648  0.55446011  0.58393523]
NDCG_rating2: [ 0.7351926   0.72618181  0.72440652  0.72681168  0.73309453  0.74228228
  0.75243629  0.76452383  0.77864581  0.79330469]
Iteration 46 [19.6 s]: loss = 0.590440 [74.02 s],
NDCG_rank: [ 0.74971706  0.73900947  0.73574713  0.7365718   0.74217849  0.74999277
  0.7605535   0.77284864  0.78592093  0.80059763]
NDCG_rating1: [ 0.39930877  0.4108617   0.42501441  0.44134969  0.46026764  0.48113136
  0.50378278  0.52823002  0.55471115  0.58424299]
NDCG_rating2: [ 0.73424774  0.72575602  0.72403522  0.72643448  0.7327559   0.74206571
  0.75229842  0.76438097  0.77846812  0.79310523]
Iteration 47 [19.7 s]: loss = 0.589521 [74.03 s],
NDCG_rank: [ 0.75056948  0.73938276  0.73591687  0.73697962  0.74252041  0.75039133
  0.76066855  0.77283566  0.78615135  0.80074611]
NDCG_rating1: [ 0.3998433   0.41158072  0.42533636  0.44188309  0.46073876  0.48139786
  0.5042021   0.52846969  0.5549542   0.58451708]
NDCG_rating2: [ 0.73334438  0.72521261  0.72366331  0.72615152  0.73258622  0.74190548
  0.75207615  0.76425284  0.77831723  0.79291052]
Iteration 48 [19.6 s]: loss = 0.588581 [74.16 s],
NDCG_rank: [ 0.75059621  0.73931652  0.73618495  0.73715657  0.74263064  0.75032317
  0.7606615   0.77274286  0.78608533  0.80077422]
NDCG_rating1: [ 0.40100543  0.41203077  0.4261372   0.44235505  0.46136033  0.48199125
  0.5045026   0.52888195  0.55538519  0.58489431]
NDCG_rating2: [ 0.73327961  0.72496587  0.72342411  0.72622727  0.73223814  0.74172174
  0.75193614  0.76410538  0.77817921  0.79277179]
Iteration 49 [19.6 s]: loss = 0.587624 [74.12 s],
NDCG_rank: [ 0.75039906  0.73912527  0.73590072  0.73706592  0.74249594  0.75024553
  0.76064733  0.77270215  0.78617821  0.80075865]
NDCG_rating1: [ 0.40157738  0.41244367  0.42654208  0.44270688  0.46190591  0.48239282
  0.50478871  0.5290584   0.55545656  0.58508332]
NDCG_rating2: [ 0.73298248  0.72485077  0.72320825  0.72612452  0.73212895  0.74159362
  0.75191277  0.76406056  0.77811497  0.79260793]
Iteration 50 [19.7 s]: loss = 0.586632 [74.34 s],
NDCG_rank: [ 0.74923442  0.7380953   0.73570333  0.73660952  0.74223801  0.75000742
  0.76062024  0.77252567  0.78581676  0.80042069]
NDCG_rating1: [ 0.40346961  0.41323338  0.42712182  0.44309377  0.46250163  0.48293888
  0.50543327  0.52958642  0.5559459   0.58548999]
NDCG_rating2: [ 0.7328174   0.72473     0.7232445   0.72587633  0.73199607  0.74145178
  0.7516667   0.7640096   0.77802821  0.7925744 ]
Iteration 51 [19.6 s]: loss = 0.585640 [74.15 s],
NDCG_rank: [ 0.74920392  0.73809993  0.73527147  0.73642584  0.74193084  0.74985011
  0.76047898  0.7725066   0.78569909  0.80038414]
NDCG_rating1: [ 0.4036023   0.41360274  0.42755074  0.44352063  0.46288474  0.48309788
  0.50575855  0.52987324  0.5561516   0.58569417]
NDCG_rating2: [ 0.73275609  0.72453523  0.72318744  0.72584427  0.73197995  0.74125414
  0.7516427   0.76395731  0.77798766  0.79245666]
Iteration 52 [19.8 s]: loss = 0.584611 [74.17 s],
NDCG_rank: [ 0.7492231   0.73859765  0.73506582  0.73617751  0.74144879  0.74968533
  0.76025386  0.77230067  0.78544495  0.8001423 ]
NDCG_rating1: [ 0.40509867  0.41540662  0.42895975  0.44464155  0.4638525   0.48405208
  0.50642831  0.53046075  0.55687578  0.58631154]
NDCG_rating2: [ 0.73275137  0.72478612  0.72300241  0.72576869  0.73202513  0.74127105
  0.75146019  0.76379037  0.77792631  0.79240398]
Iteration 53 [20.2 s]: loss = 0.583568 [74.11 s],
NDCG_rank: [ 0.74873164  0.73817417  0.73479071  0.73635776  0.74128462  0.74968054
  0.76021111  0.77218092  0.78534877  0.80021188]
NDCG_rating1: [ 0.40631488  0.41591854  0.42988137  0.44531296  0.4644501   0.48450931
  0.5068714   0.53100754  0.55730544  0.58670787]
NDCG_rating2: [ 0.73307083  0.72515931  0.72297421  0.72585821  0.73209143  0.74102055
  0.75141589  0.76366775  0.77797727  0.79234138]
Iteration 54 [19.8 s]: loss = 0.582510 [73.81 s],
NDCG_rank: [ 0.74817605  0.73842994  0.73485077  0.73590405  0.7411809   0.74939404
  0.76008778  0.77194841  0.7852396   0.79994213]
NDCG_rating1: [ 0.40675634  0.41674818  0.43063523  0.4460994   0.46533373  0.48504434
  0.50755909  0.53157101  0.55773243  0.58707288]
NDCG_rating2: [ 0.73295575  0.72485794  0.72283273  0.7256979   0.73204613  0.74101651
  0.75133862  0.76361613  0.7777768   0.79230287]
Iteration 55 [19.7 s]: loss = 0.581435 [73.96 s],
NDCG_rank: [ 0.7479745   0.73809129  0.7346999   0.73584615  0.74084654  0.74927721
  0.75976255  0.7718357   0.785143    0.79977193]
NDCG_rating1: [ 0.40618597  0.41812389  0.43132672  0.44717221  0.465939    0.4857057
  0.50798368  0.5319191   0.55812968  0.58740958]
NDCG_rating2: [ 0.73266616  0.72474121  0.72280991  0.72564567  0.73169419  0.74089116
  0.751263    0.7634948   0.77760276  0.79220451]
Iteration 56 [19.8 s]: loss = 0.580324 [74.09 s],
NDCG_rank: [ 0.74831723  0.73848619  0.73456254  0.73608632  0.74075987  0.74915008
  0.75978315  0.77167634  0.78497936  0.79976521]
NDCG_rating1: [ 0.40744557  0.41891981  0.43232692  0.448015    0.466615    0.48630145
  0.50844606  0.5324409   0.55859702  0.58788712]
NDCG_rating2: [ 0.73270892  0.72439289  0.72286005  0.72561286  0.73163907  0.74075004
  0.75123929  0.7633346   0.77746664  0.79210107]
Iteration 57 [19.7 s]: loss = 0.579189 [73.92 s],
NDCG_rank: [ 0.74786005  0.73826614  0.73444513  0.73572916  0.74083882  0.74917661
  0.75967122  0.77152715  0.78489867  0.79961442]
NDCG_rating1: [ 0.40761536  0.41968064  0.4329686   0.44877893  0.46717851  0.48678211
  0.50900884  0.53279943  0.55899106  0.5882237 ]
NDCG_rating2: [ 0.73273942  0.72419059  0.72276932  0.72557841  0.73160474  0.74057602
  0.75104328  0.76332901  0.77739048  0.79208044]
Iteration 58 [19.8 s]: loss = 0.578036 [74.32 s],
NDCG_rank: [ 0.74653661  0.73783153  0.73392996  0.73512918  0.74031697  0.74875833
  0.75935931  0.77129814  0.784529    0.7994444 ]
NDCG_rating1: [ 0.4091526   0.42019479  0.43347205  0.4493034   0.46790642  0.48746412
  0.50949525  0.53323507  0.5594047   0.58852211]
NDCG_rating2: [ 0.73264981  0.72394013  0.72272702  0.72534224  0.73121589  0.74044028
  0.75084171  0.76318786  0.77722149  0.79193109]
Iteration 59 [19.8 s]: loss = 0.576872 [74.25 s],
NDCG_rank: [ 0.74691299  0.73721824  0.73366968  0.73496102  0.74023065  0.74869649
  0.75938239  0.77148193  0.78450848  0.79947399]
NDCG_rating1: [ 0.40997955  0.42081646  0.43405139  0.44979235  0.46830271  0.48784543
  0.50982561  0.53350802  0.55964023  0.58883938]
NDCG_rating2: [ 0.73254259  0.72395248  0.72250794  0.72527892  0.73111632  0.74033716
  0.75072063  0.76317267  0.77716344  0.79178065]
Iteration 60 [19.7 s]: loss = 0.575694 [73.97 s],
NDCG_rank: [ 0.74716673  0.73719198  0.73364721  0.73453712  0.73999338  0.7484797
  0.75913551  0.77109137  0.78429969  0.79927383]
NDCG_rating1: [ 0.41065778  0.42150186  0.43485994  0.45068951  0.46896436  0.48851746
  0.51026659  0.53409964  0.56006819  0.58929693]
NDCG_rating2: [ 0.73179268  0.72393236  0.72245649  0.72494252  0.73084609  0.74006659
  0.75068319  0.76289903  0.77691594  0.79164738]
Iteration 61 [19.8 s]: loss = 0.574493 [74.01 s],
NDCG_rank: [ 0.74660453  0.73724391  0.73361958  0.73407046  0.73979641  0.74837917
  0.75911067  0.77101736  0.78437061  0.79920998]
NDCG_rating1: [ 0.41043264  0.42252803  0.43545344  0.45143157  0.46929123  0.48905822
  0.51090551  0.53444306  0.56047391  0.58971147]
NDCG_rating2: [ 0.73165118  0.72369929  0.72222781  0.72462222  0.73078285  0.73997997
  0.75059749  0.76274667  0.77694191  0.79156741]
Iteration 62 [19.7 s]: loss = 0.573275 [74.40 s],
NDCG_rank: [ 0.74655328  0.73709322  0.73342572  0.73410319  0.73968566  0.74832624
  0.75921065  0.77108425  0.78443136  0.79927905]
NDCG_rating1: [ 0.41268396  0.4232492   0.4359647   0.45174866  0.46987859  0.48969829
  0.51129947  0.53489276  0.56088666  0.59011275]
NDCG_rating2: [ 0.73016834  0.72300934  0.72184808  0.72432796  0.730484    0.73956427
  0.75029945  0.7624494   0.77656676  0.79135292]
Iteration 63 [19.8 s]: loss = 0.572033 [74.05 s],
NDCG_rank: [ 0.74650706  0.73679578  0.73322996  0.73402515  0.73981739  0.74828095
  0.75928528  0.77110526  0.78443667  0.7993065 ]
NDCG_rating1: [ 0.41391652  0.42428704  0.4364714   0.45252217  0.470616    0.49013452
  0.51199385  0.53542925  0.5614128   0.59060963]
NDCG_rating2: [ 0.73035479  0.72299619  0.72157036  0.72416824  0.73025675  0.73942069
  0.74994396  0.76213931  0.77636706  0.79128703]
Iteration 64 [19.6 s]: loss = 0.570756 [74.50 s],
NDCG_rank: [ 0.74646147  0.73614023  0.73262091  0.73396293  0.73963943  0.74793771
  0.75873654  0.77061732  0.78423425  0.7989769 ]
NDCG_rating1: [ 0.41535566  0.42582464  0.43801043  0.45405638  0.47167945  0.49107066
  0.51290275  0.53625185  0.5622286   0.59133065]
NDCG_rating2: [ 0.73066262  0.72251086  0.72152562  0.72415593  0.73010779  0.73930131
  0.74977661  0.76201226  0.77615309  0.79116353]
Iteration 65 [19.7 s]: loss = 0.569478 [74.69 s],
NDCG_rank: [ 0.74501698  0.73659888  0.73283673  0.73360428  0.73957097  0.74788765
  0.75869194  0.77059005  0.78404627  0.79887775]
NDCG_rating1: [ 0.41565814  0.4261427   0.43844988  0.45427109  0.4719756   0.49136
  0.51315379  0.53640546  0.56249589  0.5914648 ]
NDCG_rating2: [ 0.73095409  0.72278774  0.72128397  0.72395637  0.72996647  0.73919795
  0.74955567  0.76192235  0.77604185  0.79111501]
Iteration 66 [19.6 s]: loss = 0.568174 [74.22 s],
NDCG_rank: [ 0.74579676  0.73705423  0.7330369   0.73358324  0.73946427  0.74788756
  0.75865875  0.77050286  0.78396312  0.79883866]
NDCG_rating1: [ 0.41747837  0.42753608  0.43943325  0.45516253  0.47290336  0.49224011
  0.5136119   0.5370797   0.56305212  0.59197949]
NDCG_rating2: [ 0.73094812  0.7227028   0.72093902  0.72356172  0.72996722  0.7389169
  0.74933505  0.76184111  0.77583894  0.79099564]
Iteration 67 [19.7 s]: loss = 0.566827 [74.06 s],
NDCG_rank: [ 0.74539021  0.73601665  0.7324944   0.7332811   0.73920618  0.74773257
  0.75841614  0.77029946  0.78379788  0.79853187]
NDCG_rating1: [ 0.41651779  0.42739227  0.43970745  0.45552935  0.47328523  0.49240378
  0.51386082  0.53726761  0.56332996  0.59213522]
NDCG_rating2: [ 0.72994037  0.72203041  0.72055294  0.72330896  0.72942432  0.73849824
  0.74899607  0.76139132  0.77552493  0.79074351]
Iteration 68 [19.7 s]: loss = 0.565467 [74.42 s],
NDCG_rank: [ 0.74506477  0.73547728  0.73229173  0.73336211  0.73921773  0.74763329
  0.75815694  0.77002131  0.78369968  0.79847451]
NDCG_rating1: [ 0.41687121  0.4283834   0.44023346  0.45578756  0.47359312  0.49263976
  0.51410508  0.53737561  0.56361931  0.59240925]
NDCG_rating2: [ 0.72956778  0.72179738  0.72041256  0.72292618  0.72927713  0.73826248
  0.74871944  0.76132899  0.77529878  0.79046948]
Iteration 69 [19.7 s]: loss = 0.564083 [75.04 s],
NDCG_rank: [ 0.74466325  0.73465886  0.73202058  0.73307637  0.73881153  0.74720969
  0.75781227  0.76996608  0.78341451  0.7983199 ]
NDCG_rating1: [ 0.41727525  0.42870597  0.44044654  0.45586071  0.47353305  0.49261235
  0.5142072   0.53749683  0.56364345  0.59250449]
NDCG_rating2: [ 0.72985611  0.72170966  0.72027063  0.72281419  0.72896945  0.73799885
  0.74853835  0.7612357   0.77521263  0.79028808]
Iteration 70 [19.6 s]: loss = 0.562674 [76.41 s],
NDCG_rank: [ 0.74377498  0.73452971  0.7313569   0.73284815  0.73846101  0.74680683
  0.75748319  0.76970074  0.78309976  0.79802098]
NDCG_rating1: [ 0.41736581  0.42861688  0.44090118  0.45644371  0.4741581   0.49315219
  0.51458536  0.53763401  0.56405185  0.59279779]
NDCG_rating2: [ 0.72939453  0.72148989  0.71978097  0.72241351  0.72860345  0.73763703
  0.74817027  0.76097411  0.77487568  0.79004194]
Iteration 71 [19.6 s]: loss = 0.561243 [73.97 s],
NDCG_rank: [ 0.74371241  0.73485054  0.73109932  0.73253343  0.73857772  0.74660253
  0.75731703  0.76930334  0.78288083  0.79787418]
NDCG_rating1: [ 0.4189194   0.42945573  0.44165285  0.45703966  0.47478053  0.49371578
  0.51501302  0.53812606  0.56447119  0.59321851]
NDCG_rating2: [ 0.72880088  0.72107402  0.7196105   0.72211411  0.7280988   0.73753697
  0.74792582  0.7606212   0.77448419  0.78971264]
Iteration 72 [19.6 s]: loss = 0.559780 [74.01 s],
NDCG_rank: [ 0.74227893  0.73389285  0.73012537  0.73185825  0.73779402  0.74604567
  0.75701606  0.76912185  0.78240522  0.79751256]
NDCG_rating1: [ 0.41926527  0.42964265  0.44190222  0.4572496   0.47504966  0.49382007
  0.51535543  0.53839953  0.56455703  0.59320985]
NDCG_rating2: [ 0.72825724  0.72092146  0.71939204  0.72172009  0.72790258  0.73717625
  0.74780753  0.76033847  0.77427248  0.78933469]
Iteration 73 [19.6 s]: loss = 0.558285 [74.56 s],
NDCG_rank: [ 0.74143437  0.73325785  0.72998611  0.73149148  0.73762274  0.74579375
  0.75655462  0.76876896  0.78217707  0.79714113]
NDCG_rating1: [ 0.42000072  0.43059439  0.44258215  0.45762658  0.4753264   0.49431345
  0.51579516  0.53885423  0.5648993   0.59346372]
NDCG_rating2: [ 0.72786923  0.72081416  0.71931519  0.7213181   0.72748928  0.73674303
  0.74755861  0.76003969  0.77399124  0.78916583]
Iteration 74 [19.6 s]: loss = 0.556771 [74.77 s],
NDCG_rank: [ 0.7401971   0.73254275  0.72961142  0.73092229  0.73696764  0.74536169
  0.75621856  0.76840973  0.78199272  0.79687451]
NDCG_rating1: [ 0.4202268   0.43108808  0.44298432  0.45803494  0.47573992  0.49465549
  0.51609156  0.53919035  0.5652098   0.59371895]
NDCG_rating2: [ 0.72737275  0.72033154  0.71891195  0.72093485  0.72711426  0.73636601
  0.74736235  0.75967708  0.7736823   0.78876467]
Iteration 75 [19.6 s]: loss = 0.555241 [74.88 s],
NDCG_rank: [ 0.74038229  0.7323991   0.72924844  0.73105399  0.7367613   0.7448419
  0.75582707  0.76806965  0.78171399  0.79675119]
NDCG_rating1: [ 0.42025069  0.43094966  0.44314739  0.4581488   0.47568826  0.49470512
  0.51608387  0.5391089   0.56508833  0.59380647]
NDCG_rating2: [ 0.7269294   0.71992866  0.71849547  0.72071546  0.72688831  0.73601288
  0.74700304  0.75944691  0.77340418  0.7884634 ]
Iteration 76 [19.8 s]: loss = 0.553676 [73.91 s],
NDCG_rank: [ 0.73893215  0.73167117  0.7285513   0.73019399  0.73624841  0.74450337
  0.75535932  0.76777835  0.78153166  0.79640183]
NDCG_rating1: [ 0.42122448  0.43115538  0.44365764  0.45833539  0.47597476  0.49495763
  0.51646971  0.53955111  0.56535633  0.59419747]
NDCG_rating2: [ 0.72713692  0.72013823  0.71825027  0.7204806   0.72672884  0.73581832
  0.74672818  0.75921602  0.77316817  0.78829339]
Iteration 77 [19.8 s]: loss = 0.552098 [74.11 s],
NDCG_rank: [ 0.7390793   0.73163866  0.72836238  0.73019894  0.73621744  0.74468012
  0.75526588  0.76762389  0.78133793  0.79641038]
NDCG_rating1: [ 0.42014567  0.43096062  0.44358325  0.45815299  0.47579346  0.49502774
  0.51642044  0.53951326  0.56530579  0.59417987]
NDCG_rating2: [ 0.72645776  0.71992005  0.71776207  0.71989872  0.72642648  0.73550771
  0.74648241  0.75881713  0.77280594  0.78797442]
Iteration 78 [19.8 s]: loss = 0.550474 [73.88 s],
NDCG_rank: [ 0.7385998   0.73196061  0.7284412   0.73000106  0.73605824  0.74417051
  0.75513805  0.76746457  0.78118105  0.79629093]
NDCG_rating1: [ 0.42093866  0.43127445  0.44390287  0.45825039  0.47609398  0.49531202
  0.51651015  0.53958363  0.56550523  0.59436625]
NDCG_rating2: [ 0.72651561  0.7193923   0.71764586  0.71962753  0.72589547  0.73510128
  0.7460477   0.75844455  0.77255317  0.78767866]
Iteration 79 [19.7 s]: loss = 0.548847 [74.11 s],
NDCG_rank: [ 0.73806841  0.73090049  0.72822961  0.72945182  0.73572332  0.74407417
  0.75486928  0.7672257   0.78103107  0.79607291]
NDCG_rating1: [ 0.42016077  0.43065035  0.44350379  0.45805364  0.47595157  0.49528705
  0.51660085  0.53953774  0.56537071  0.59424489]
NDCG_rating2: [ 0.72613138  0.71924947  0.7171026   0.71922403  0.72545556  0.73468787
  0.74579262  0.75825543  0.77215441  0.78741219]
Iteration 80 [19.7 s]: loss = 0.547195 [73.87 s],
NDCG_rank: [ 0.73873343  0.73078896  0.7279956   0.72934089  0.73547573  0.7437752
  0.75449124  0.76721823  0.7808856   0.79595794]
NDCG_rating1: [ 0.42128265  0.43148624  0.44387943  0.45854707  0.47642646  0.4956399
  0.51685448  0.53988768  0.56563572  0.59458859]
NDCG_rating2: [ 0.72583896  0.71868802  0.71671785  0.71868561  0.72502888  0.734281
  0.74531044  0.75787364  0.77181946  0.78706031]
Iteration 81 [19.8 s]: loss = 0.545514 [73.90 s],
NDCG_rank: [ 0.73826084  0.73000144  0.72741126  0.72907149  0.73527256  0.74363306
  0.75432211  0.76684503  0.78054062  0.79568161]
NDCG_rating1: [ 0.42075567  0.4306934   0.44331002  0.45820822  0.47615688  0.49547104
  0.51674986  0.53968877  0.56553255  0.59458711]
NDCG_rating2: [ 0.72593801  0.71861941  0.71660402  0.71854814  0.72461414  0.73384536
  0.7449096   0.75758904  0.77148131  0.78680066]
Iteration 82 [19.8 s]: loss = 0.543823 [73.86 s],
NDCG_rank: [ 0.73741     0.72965095  0.7277257   0.72869113  0.73514009  0.74308412
  0.75371537  0.76647022  0.78026791  0.79515057]
NDCG_rating1: [ 0.4211204   0.43107612  0.4435992   0.45857639  0.47666116  0.49567656
  0.51693055  0.53986806  0.56572741  0.59475374]
NDCG_rating2: [ 0.72472714  0.71840946  0.71590168  0.71804049  0.72409687  0.73347316
  0.74455278  0.75718083  0.77112491  0.78638298]
Iteration 83 [19.8 s]: loss = 0.542095 [74.12 s],
NDCG_rank: [ 0.73708551  0.73000302  0.72759647  0.72883661  0.73497954  0.74304915
  0.75350855  0.76614483  0.78002041  0.79499805]
NDCG_rating1: [ 0.42099966  0.43060391  0.44325755  0.45830997  0.47642083  0.49564268
  0.51685593  0.53997263  0.56578427  0.5947405 ]
NDCG_rating2: [ 0.72482084  0.71782629  0.71567545  0.71777711  0.72392812  0.73316442
  0.74399     0.75676264  0.77077137  0.78606596]
Iteration 84 [19.6 s]: loss = 0.540366 [74.22 s],
NDCG_rank: [ 0.7366299   0.72955607  0.72712153  0.72860475  0.73437512  0.74274225
  0.75331274  0.76598728  0.77977868  0.79464396]
NDCG_rating1: [ 0.42162726  0.43108595  0.44357785  0.45838939  0.47660729  0.49581166
  0.51718832  0.54018894  0.56605771  0.5950903 ]
NDCG_rating2: [ 0.72427814  0.71734776  0.71516907  0.71723049  0.72356163  0.73274
  0.74360235  0.75643936  0.77044707  0.78560258]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0.000001,0.00001,0.00005,0.0001] --loss_weights [1.,0,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[1.,0,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0.000001,0.00001,0.00005,0.0001]', verbose=1) 
Load data done [4.9 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [76.1], Init: NDCG = 
(array([ 0.55082177,  0.55804727,  0.56769102,  0.57927002,  0.59251138,
        0.60770712,  0.62470264,  0.6435035 ,  0.6641662 ,  0.68652492]), array([ 0.56524827,  0.56882018,  0.57407147,  0.58420063,  0.59615749,
        0.61134346,  0.6277152 ,  0.64576484,  0.66583815,  0.68828228]), array([ 0.5689884 ,  0.57207339,  0.57815966,  0.5877155 ,  0.59969542,
        0.61393391,  0.6302593 ,  0.64797169,  0.66817497,  0.6895022 ]))
Iteration 0 [30.4 s]: loss = 0.690924 [76.19 s],
NDCG_rank: [ 0.71697871  0.71436128  0.7153089   0.71905977  0.72613427  0.7355396
  0.74699089  0.75956861  0.77377779  0.78874599]
NDCG_rating1: [ 0.38901028  0.40917113  0.42750902  0.44602472  0.46582217  0.48621233
  0.50901835  0.53340683  0.55998907  0.58911107]
NDCG_rating2: [ 0.7170177   0.71193966  0.71162819  0.71557423  0.7218977   0.73006886
  0.74006587  0.75158101  0.76509211  0.78071518]
Iteration 1 [23.0 s]: loss = 0.647232 [76.92 s],
NDCG_rank: [ 0.7447167   0.73588794  0.73336845  0.73638519  0.74173346  0.74974527
  0.75978994  0.77210087  0.78529409  0.79964505]
NDCG_rating1: [ 0.36804761  0.39103039  0.4108071   0.43087407  0.45153846  0.47343613
  0.49694978  0.52239509  0.54969913  0.57967283]
NDCG_rating2: [ 0.73375633  0.72330465  0.71891933  0.71893542  0.72149073  0.72807971
  0.73739444  0.74857751  0.76229931  0.77872773]
Iteration 2 [23.0 s]: loss = 0.629120 [78.30 s],
NDCG_rank: [ 0.75004187  0.74145769  0.73717536  0.73926923  0.74469313  0.75251275
  0.76246031  0.77392244  0.78734252  0.80200166]
NDCG_rating1: [ 0.36525925  0.38825065  0.40888904  0.42927431  0.45027033  0.47297938
  0.49660606  0.52234363  0.54981413  0.57973463]
NDCG_rating2: [ 0.71095923  0.70289277  0.69897736  0.70116674  0.70518262  0.7125801
  0.72313502  0.73564619  0.74983452  0.76652863]
Iteration 3 [23.0 s]: loss = 0.617961 [79.12 s],
NDCG_rank: [ 0.75187185  0.7421003   0.73716114  0.73907077  0.74432796  0.75281775
  0.7628492   0.77457084  0.78781614  0.80230806]
NDCG_rating1: [ 0.37052373  0.39312474  0.41454499  0.43499327  0.45689168  0.47935292
  0.50309595  0.52860536  0.55565395  0.58475811]
NDCG_rating2: [ 0.6902384   0.6843715   0.68271162  0.68587442  0.69231165  0.70142561
  0.71254902  0.72566491  0.74073009  0.75815323]
Iteration 4 [23.1 s]: loss = 0.608639 [84.19 s],
NDCG_rank: [ 0.75006828  0.7405473   0.73662538  0.73832158  0.74392006  0.75186288
  0.76198737  0.77394031  0.78693365  0.80145248]
NDCG_rating1: [ 0.38082758  0.40317905  0.42426361  0.44392441  0.46541545  0.48808861
  0.51127313  0.53639133  0.5632883   0.59187868]
NDCG_rating2: [ 0.68543581  0.6779733   0.67621986  0.67915766  0.68663072  0.69554222
  0.70720067  0.72114876  0.73708541  0.75472955]
Iteration 5 [23.5 s]: loss = 0.600101 [93.07 s],
NDCG_rank: [ 0.74968405  0.73926281  0.7360978   0.73699388  0.74246425  0.75033046
  0.76054507  0.77254734  0.78569801  0.80049026]
NDCG_rating1: [ 0.39487344  0.41606612  0.43534149  0.45509132  0.4759521   0.4977285
  0.52092325  0.54526869  0.57136013  0.59979388]
NDCG_rating2: [ 0.68010341  0.67081797  0.66703276  0.67053549  0.67755154  0.68749586
  0.69992429  0.71412928  0.73044986  0.7485042 ]
Iteration 6 [23.5 s]: loss = 0.591252 [119.01 s],
NDCG_rank: [ 0.74844268  0.73770406  0.73299778  0.73411422  0.73971593  0.74809949
  0.75863439  0.77091912  0.78415144  0.79858025]
NDCG_rating1: [ 0.41152874  0.43246285  0.45054665  0.46927471  0.48935831  0.50974711
  0.53213577  0.55558352  0.58112655  0.60876177]
NDCG_rating2: [ 0.6778848   0.66550393  0.66156123  0.6637895   0.67026327  0.68051368
  0.69320864  0.70750042  0.72384991  0.74226218]
Iteration 7 [25.3 s]: loss = 0.581800 [230.51 s],
NDCG_rank: [ 0.74557761  0.73320389  0.72891705  0.73024973  0.73540423  0.74408983
  0.7549542   0.76700591  0.78093461  0.79553108]
NDCG_rating1: [ 0.43518544  0.45177403  0.46775154  0.48509586  0.5030518   0.52262911
  0.54402613  0.56699984  0.59163878  0.61870999]
NDCG_rating2: [ 0.67440596  0.65903497  0.65422996  0.65593653  0.66237085  0.67202946
  0.68453026  0.69898264  0.71577788  0.73489381]
Iteration 8 [26.6 s]: loss = 0.571911 [279.34 s],
NDCG_rank: [ 0.74149129  0.72925255  0.72501491  0.72621263  0.7322401   0.74051017
  0.75139386  0.76419957  0.77823885  0.79290622]
NDCG_rating1: [ 0.45194573  0.46795415  0.48302043  0.49913079  0.51619961  0.53501045
  0.55522682  0.57752441  0.6013913   0.6279464 ]
NDCG_rating2: [ 0.66510074  0.65255138  0.64811848  0.65017104  0.65700402  0.66648525
  0.67863227  0.69293492  0.70991361  0.72931515]
Iteration 9 [27.2 s]: loss = 0.562119 [288.69 s],
NDCG_rank: [ 0.73176191  0.72245756  0.71921243  0.72125655  0.72715534  0.73562309
  0.74681127  0.75954809  0.77385871  0.788988  ]
NDCG_rating1: [ 0.46376354  0.47958605  0.49414349  0.51000105  0.52713913  0.54531318
  0.56506426  0.58609508  0.60963525  0.63561405]
NDCG_rating2: [ 0.65798364  0.64410443  0.64138636  0.64436154  0.65158656  0.66070493
  0.67341926  0.68825682  0.70501413  0.72437897]
Iteration 10 [27.4 s]: loss = 0.552814 [295.85 s],
NDCG_rank: [ 0.72787997  0.71722904  0.71424981  0.71651565  0.72308014  0.73137185
  0.7428471   0.75592128  0.7704911   0.78596454]
NDCG_rating1: [ 0.47530089  0.48982417  0.50345407  0.5196204   0.53605958  0.55310451
  0.57241078  0.59370939  0.61683616  0.64210603]
NDCG_rating2: [ 0.64206814  0.63357083  0.63094182  0.63566714  0.64295589  0.65279573
  0.66546487  0.68049842  0.69782613  0.71797363]
Iteration 11 [27.5 s]: loss = 0.543703 [295.64 s],
NDCG_rank: [ 0.724015    0.71474106  0.71110081  0.71394155  0.71931154  0.72844372
  0.73989842  0.75286779  0.76749176  0.78328764]
NDCG_rating1: [ 0.48507105  0.49861669  0.51201549  0.52684804  0.54285397  0.55958925
  0.57871662  0.59941728  0.62172312  0.64712434]
NDCG_rating2: [ 0.62896934  0.62200547  0.62240195  0.62741572  0.63537401  0.64570419
  0.65890409  0.67424512  0.6916481   0.71228611]
Iteration 12 [27.5 s]: loss = 0.534862 [295.61 s],
NDCG_rank: [ 0.71887566  0.70926309  0.70660507  0.70923198  0.71583792  0.72489175
  0.73659957  0.75009798  0.76496734  0.78063102]
NDCG_rating1: [ 0.49410177  0.50693119  0.51897192  0.53328255  0.54788869  0.5650274
  0.58362754  0.60413938  0.62612268  0.65090282]
NDCG_rating2: [ 0.61334284  0.60937991  0.61028206  0.61641112  0.62581468  0.63704672
  0.65077437  0.66632055  0.68423903  0.70541592]
Iteration 13 [27.5 s]: loss = 0.526156 [295.26 s],
NDCG_rank: [ 0.71645519  0.7069657   0.70435429  0.70685737  0.71337222  0.72236038
  0.73410821  0.74739235  0.76288688  0.77884807]
NDCG_rating1: [ 0.49544344  0.50871419  0.51980616  0.53352089  0.5486031   0.56539585
  0.58348782  0.60390884  0.62639745  0.65128162]
NDCG_rating2: [ 0.60268024  0.59900721  0.60229929  0.6078796   0.61758845  0.6294529
  0.64326023  0.65952756  0.6780484   0.69960616]
Iteration 14 [27.6 s]: loss = 0.517510 [294.29 s],
NDCG_rank: [ 0.71213493  0.70353853  0.70115942  0.7036041   0.71090717  0.72016589
  0.73205314  0.74563965  0.76087647  0.77696722]
NDCG_rating1: [ 0.50037054  0.51271931  0.52346134  0.53687588  0.55158215  0.56793444
  0.58629055  0.60638772  0.62888466  0.65334472]
NDCG_rating2: [ 0.58990782  0.58953537  0.59321127  0.59984322  0.61028814  0.62241259
  0.63682908  0.65382321  0.67232073  0.69380543]
Iteration 15 [27.7 s]: loss = 0.508975 [293.73 s],
NDCG_rank: [ 0.70868434  0.70103627  0.69880583  0.70198233  0.70879924  0.7181009
  0.73061654  0.74414219  0.75907373  0.77516592]
NDCG_rating1: [ 0.50050049  0.51153207  0.52324091  0.53641618  0.55123261  0.56773393
  0.58572213  0.60585827  0.62799252  0.65281927]
NDCG_rating2: [ 0.57876508  0.57926864  0.5837243   0.59106313  0.60193599  0.61489679
  0.62957375  0.64659851  0.66563329  0.68804119]
Iteration 16 [27.8 s]: loss = 0.500508 [293.38 s],
NDCG_rank: [ 0.70473574  0.69923188  0.69670335  0.70016903  0.70693438  0.71689743
  0.72875585  0.74259687  0.75759004  0.77395644]
NDCG_rating1: [ 0.50073506  0.51100245  0.5229562   0.53599016  0.55079055  0.5669526
  0.58542738  0.60557729  0.62764816  0.65243618]
NDCG_rating2: [ 0.56846029  0.56910455  0.57402739  0.58338798  0.59415673  0.60718249
  0.62256595  0.64037856  0.65988432  0.68233025]
Iteration 17 [27.7 s]: loss = 0.492074 [293.98 s],
NDCG_rank: [ 0.70227318  0.69675049  0.69578221  0.69936268  0.70539766  0.71514954
  0.72721627  0.74104041  0.75635023  0.77295667]
NDCG_rating1: [ 0.49716754  0.50779951  0.51972662  0.53356601  0.54834441  0.56476314
  0.58333739  0.60351281  0.62568445  0.65082235]
NDCG_rating2: [ 0.56058416  0.56194708  0.56803775  0.57727946  0.58913238  0.60263818
  0.61853934  0.6359541   0.65576308  0.67835658]
Iteration 18 [27.5 s]: loss = 0.483650 [295.01 s],
NDCG_rank: [ 0.70209171  0.69418746  0.69348327  0.69684807  0.7032375   0.71322194
  0.72540119  0.73951816  0.75482096  0.77132495]
NDCG_rating1: [ 0.49824541  0.50934196  0.52132395  0.53425446  0.54979591  0.56599765
  0.58411965  0.60432963  0.62662509  0.65140059]
NDCG_rating2: [ 0.55197918  0.55371511  0.56066714  0.57121395  0.58324381  0.59700235
  0.61304427  0.6310423   0.65109503  0.67413297]
Iteration 19 [27.5 s]: loss = 0.475345 [294.75 s],
NDCG_rank: [ 0.69738097  0.69197253  0.69166155  0.69500102  0.70223442  0.71162211
  0.72373831  0.73790228  0.75317051  0.76996423]
NDCG_rating1: [ 0.4986583   0.5087201   0.52141889  0.53417785  0.5491734   0.56553422
  0.58373972  0.60426877  0.62645221  0.65150488]
NDCG_rating2: [ 0.5458607   0.54809884  0.556173    0.56583477  0.57847784  0.59303488
  0.60924853  0.62740618  0.64773191  0.67092508]
Iteration 20 [27.6 s]: loss = 0.467177 [294.86 s],
NDCG_rank: [ 0.69658542  0.68928661  0.68940509  0.69296988  0.70027495  0.70998843
  0.72243391  0.73654715  0.75204675  0.76873318]
NDCG_rating1: [ 0.49792725  0.50901472  0.52133058  0.53427788  0.54922097  0.56569012
  0.58406479  0.60442147  0.626427    0.6515227 ]
NDCG_rating2: [ 0.54056352  0.5437273   0.55058898  0.56152925  0.57435985  0.58887513
  0.6054749   0.62426514  0.64463027  0.66808461]
Iteration 21 [27.5 s]: loss = 0.458982 [293.31 s],
NDCG_rank: [ 0.6941172   0.68772927  0.68682728  0.69133442  0.69889928  0.70852991
  0.72069696  0.73525491  0.7504919   0.76738679]
NDCG_rating1: [ 0.49446413  0.50655474  0.51923536  0.53200554  0.54724775  0.56377864
  0.58218724  0.60269002  0.62492208  0.6497824 ]
NDCG_rating2: [ 0.53399384  0.53885211  0.54632968  0.55773695  0.57067849  0.58551794
  0.60234367  0.62144228  0.64200919  0.66559725]
Iteration 22 [27.5 s]: loss = 0.450978 [294.44 s],
NDCG_rank: [ 0.69192437  0.68640333  0.68624497  0.69086532  0.69828704  0.70802641
  0.72028714  0.73407043  0.74952107  0.76661066]
NDCG_rating1: [ 0.49518669  0.50757621  0.51987691  0.53313067  0.5477845   0.56423398
  0.58271017  0.60324866  0.6254073   0.6503939 ]
NDCG_rating2: [ 0.52891141  0.53459986  0.54246241  0.5542569   0.56740789  0.58226081
  0.59967606  0.6187271   0.63958536  0.66333923]
Iteration 23 [27.6 s]: loss = 0.443019 [292.59 s],
NDCG_rank: [ 0.68863949  0.68331154  0.68359281  0.68846692  0.69611616  0.70577967
  0.71806639  0.73242657  0.74795895  0.76491158]
NDCG_rating1: [ 0.49673085  0.50847282  0.52054059  0.53376187  0.54805157  0.5647966
  0.58315111  0.60350813  0.62581475  0.65075225]
NDCG_rating2: [ 0.52678398  0.53196461  0.540341    0.55156242  0.56520234  0.5803347
  0.59782202  0.61708566  0.63795384  0.66167799]
Iteration 24 [27.5 s]: loss = 0.435161 [292.75 s],
NDCG_rank: [ 0.68750503  0.68315791  0.68234103  0.68678215  0.69478942  0.70479863
  0.71697641  0.73133778  0.74691389  0.7638386 ]
NDCG_rating1: [ 0.49461505  0.50672198  0.51822597  0.53116284  0.54590152  0.56300233
  0.58143753  0.60163834  0.62420122  0.64929956]
NDCG_rating2: [ 0.52510996  0.52986673  0.53897907  0.55029579  0.5639609   0.57901539
  0.59671671  0.61597397  0.63696708  0.66108592]
Iteration 25 [27.6 s]: loss = 0.427404 [290.70 s],
NDCG_rank: [ 0.68727774  0.68029703  0.68036923  0.68500189  0.69257778  0.70311349
  0.71530447  0.73015177  0.74583568  0.76285582]
NDCG_rating1: [ 0.49492382  0.50773156  0.51874408  0.53143366  0.54666488  0.56326683
  0.58169993  0.60213776  0.62443267  0.64940648]
NDCG_rating2: [ 0.52337965  0.5280329   0.53729513  0.54863524  0.56216408  0.57743363
  0.59496986  0.61421274  0.63566276  0.65979536]
Iteration 26 [27.6 s]: loss = 0.420141 [290.70 s],
NDCG_rank: [ 0.68145043  0.67728224  0.67783922  0.68338027  0.69089694  0.70097608
  0.7135942   0.72821674  0.74439749  0.76151335]
NDCG_rating1: [ 0.49361737  0.50649568  0.51801539  0.53031838  0.54499633  0.56226909
  0.58082063  0.60107536  0.62355657  0.64873203]
NDCG_rating2: [ 0.52109533  0.52639974  0.53529925  0.54720162  0.56096221  0.576154
  0.59361796  0.61318948  0.63479356  0.65887358]
Iteration 27 [27.6 s]: loss = 0.412739 [290.56 s],
NDCG_rank: [ 0.68292195  0.67692137  0.67651437  0.68114682  0.68896337  0.69982568
  0.71245821  0.72740984  0.7435476   0.76055244]
NDCG_rating1: [ 0.49794832  0.50758824  0.51945175  0.53194125  0.54656923  0.56340192
  0.58219422  0.60257104  0.62507566  0.649819  ]
NDCG_rating2: [ 0.52055765  0.52557964  0.53491044  0.54686614  0.56036054  0.57609634
  0.59339364  0.6131808   0.63458116  0.65862722]
Iteration 28 [27.5 s]: loss = 0.405695 [291.93 s],
NDCG_rank: [ 0.68110514  0.67662758  0.67630746  0.68087038  0.68828866  0.69875765
  0.71151607  0.72645478  0.74249863  0.75994575]
NDCG_rating1: [ 0.49469146  0.50542235  0.51717533  0.52995382  0.54472754  0.5616553
  0.58001413  0.60082823  0.6230962   0.64827569]
NDCG_rating2: [ 0.51737815  0.52378993  0.53279591  0.54500266  0.55871403  0.57453607
  0.59198747  0.61186098  0.63337597  0.65743099]
Iteration 29 [27.5 s]: loss = 0.398998 [291.60 s],
NDCG_rank: [ 0.67749208  0.67127519  0.67200784  0.6766898   0.68487333  0.69604807
  0.7093314   0.72385333  0.74028534  0.75781977]
NDCG_rating1: [ 0.49609476  0.50692777  0.51799322  0.52999309  0.5451211   0.56210455
  0.58061307  0.60171165  0.62382121  0.64884442]
NDCG_rating2: [ 0.51784633  0.52356272  0.53238474  0.54489283  0.55812949  0.5740007
  0.59175022  0.61145271  0.63286899  0.65714458]
Iteration 30 [27.6 s]: loss = 0.392358 [290.56 s],
NDCG_rank: [ 0.67274703  0.66909183  0.67091966  0.67561076  0.68396072  0.69521835
  0.70804892  0.72264041  0.73924139  0.75674043]
NDCG_rating1: [ 0.49676858  0.50745429  0.51840382  0.53087465  0.54553401  0.56276842
  0.58137665  0.60201165  0.62424167  0.64941751]
NDCG_rating2: [ 0.51831232  0.5233499   0.53269213  0.54519789  0.55833377  0.57446465
  0.59233114  0.61186369  0.63346093  0.65741929]
Iteration 31 [27.6 s]: loss = 0.385977 [289.99 s],
NDCG_rank: [ 0.66926598  0.66510746  0.66773338  0.67347372  0.68226025  0.69327984
  0.70677106  0.72182619  0.73815809  0.75584995]
NDCG_rating1: [ 0.49516153  0.50602673  0.51733721  0.52960026  0.54464357  0.56167836
  0.57977466  0.60077232  0.62317388  0.64841803]
NDCG_rating2: [ 0.51488567  0.52221852  0.53197048  0.54434256  0.55737393  0.57404664
  0.5917617   0.61152354  0.63315805  0.65723047]
Iteration 32 [27.5 s]: loss = 0.380020 [289.28 s],
NDCG_rank: [ 0.66919398  0.66698269  0.66812649  0.67384097  0.68188152  0.69296811
  0.70654651  0.7211691   0.73762749  0.75550471]
NDCG_rating1: [ 0.4953373   0.5056624   0.51744499  0.52997748  0.54496169  0.56179634
  0.58036232  0.60063289  0.623194    0.64828772]
NDCG_rating2: [ 0.51539787  0.52183605  0.53185376  0.5439983   0.55751888  0.57401173
  0.59144214  0.61124524  0.63279631  0.65681662]
Iteration 33 [27.5 s]: loss = 0.374254 [289.34 s],
NDCG_rank: [ 0.66847924  0.66543958  0.6673504   0.67301054  0.68131862  0.69258702
  0.7057825   0.72073068  0.73724974  0.75506466]
NDCG_rating1: [ 0.49500369  0.5046634   0.51699121  0.53004496  0.54461573  0.56189943
  0.57998156  0.60100353  0.62297327  0.64793695]
NDCG_rating2: [ 0.51845821  0.52355793  0.53275761  0.54535304  0.55907582  0.5753747
  0.59305305  0.6125921   0.63419288  0.6580053 ]
Iteration 34 [27.5 s]: loss = 0.368676 [290.49 s],
NDCG_rank: [ 0.66503943  0.6632375   0.66566392  0.67128488  0.67988541  0.69110689
  0.70478661  0.71957576  0.7357881   0.75391822]
NDCG_rating1: [ 0.49355543  0.50273993  0.5149822   0.52805846  0.54265368  0.55969621
  0.57822046  0.59892719  0.62138066  0.64651744]
NDCG_rating2: [ 0.51730614  0.52313483  0.53331272  0.54547298  0.55872038  0.57479304
  0.59280075  0.61236134  0.63369984  0.65795015]
Iteration 35 [27.5 s]: loss = 0.363409 [291.69 s],
NDCG_rank: [ 0.66662415  0.6640077   0.66506506  0.67076039  0.67962903  0.69064968
  0.70386205  0.71895273  0.73555722  0.75359884]
NDCG_rating1: [ 0.49417643  0.50405567  0.51532548  0.52895625  0.54383366  0.56054757
  0.57893674  0.59929968  0.62225589  0.64719467]
NDCG_rating2: [ 0.5173706   0.52321655  0.53397982  0.54613328  0.55961025  0.57567855
  0.59346059  0.6127737   0.63458493  0.65833694]
Iteration 36 [28.4 s]: loss = 0.358567 [298.14 s],
NDCG_rank: [ 0.66205141  0.66068648  0.66312947  0.66897696  0.67779435  0.68918089
  0.7027031   0.71791658  0.73458013  0.75241753]
NDCG_rating1: [ 0.49234357  0.50173997  0.51404388  0.52672003  0.54169281  0.5587895
  0.57734668  0.59774512  0.62060512  0.64559319]
NDCG_rating2: [ 0.51934993  0.52536355  0.53528377  0.5473853   0.56066185  0.57688451
  0.59492046  0.61409971  0.63568793  0.65936443]
Iteration 37 [28.2 s]: loss = 0.353755 [292.89 s],
NDCG_rank: [ 0.66319247  0.65957949  0.66073501  0.66677883  0.6768212   0.68818709
  0.70168806  0.71672466  0.73334182  0.75143625]
NDCG_rating1: [ 0.4934394   0.50200729  0.51445702  0.52742518  0.54285379  0.55944629
  0.57821391  0.5987135   0.6215923   0.64663044]
NDCG_rating2: [ 0.52000143  0.52571094  0.53604588  0.54805554  0.56157908  0.57739832
  0.59541894  0.61473606  0.63595848  0.65989209]
Iteration 38 [27.5 s]: loss = 0.349342 [284.92 s],
NDCG_rank: [ 0.66020508  0.65782318  0.66034494  0.66753264  0.67586481  0.68778879
  0.70156674  0.71690534  0.73350336  0.75124525]
NDCG_rating1: [ 0.49302907  0.50212382  0.51360651  0.52708362  0.54180829  0.5588888
  0.57774073  0.5979245   0.6209145   0.64609416]
NDCG_rating2: [ 0.52059193  0.52592583  0.53632876  0.54841396  0.56203999  0.57783255
  0.59578843  0.614724    0.63658244  0.66037845]
Iteration 39 [27.6 s]: loss = 0.345083 [287.50 s],
NDCG_rank: [ 0.66002617  0.65606475  0.65887025  0.66603157  0.67486572  0.6861285
  0.69994003  0.71475981  0.73162821  0.74998419]
NDCG_rating1: [ 0.49278063  0.50173963  0.51332845  0.52661583  0.54212831  0.55930652
  0.57791233  0.59831338  0.62087864  0.64609409]
NDCG_rating2: [ 0.52018191  0.52574287  0.53635     0.54853609  0.56202449  0.57773078
  0.59592035  0.615339    0.63662785  0.66038432]
Iteration 40 [27.6 s]: loss = 0.341123 [290.01 s],
NDCG_rank: [ 0.65884041  0.6569296   0.65869185  0.66520964  0.67432237  0.68577
  0.69962219  0.71506827  0.73183415  0.7498667 ]
NDCG_rating1: [ 0.49385472  0.50211419  0.51386746  0.52715404  0.5420718   0.55949764
  0.57793321  0.59830489  0.62102827  0.64636373]
NDCG_rating2: [ 0.52230965  0.52715537  0.53774202  0.54939479  0.56328324  0.57895829
  0.59662527  0.61606326  0.6379616   0.66146043]
Iteration 41 [27.5 s]: loss = 0.337320 [289.26 s],
NDCG_rank: [ 0.65883983  0.65720189  0.65800613  0.66472574  0.67375672  0.68549448
  0.69927833  0.7144494   0.73128751  0.74947333]
NDCG_rating1: [ 0.49334382  0.50153476  0.51292473  0.52586017  0.54177909  0.55882293
  0.57767522  0.59795578  0.62057689  0.64584675]
NDCG_rating2: [ 0.52261874  0.52879671  0.53904992  0.5509372   0.5643627   0.57987192
  0.59768187  0.61716602  0.63877144  0.66245871]
Iteration 42 [27.5 s]: loss = 0.333883 [286.70 s],
NDCG_rank: [ 0.65707305  0.65448393  0.65727354  0.66306621  0.67212167  0.68378227
  0.69786881  0.71321829  0.73040766  0.74828731]
NDCG_rating1: [ 0.49289917  0.50032628  0.51321145  0.5258211   0.54163361  0.55882394
  0.57730383  0.59773498  0.62043255  0.64562013]
NDCG_rating2: [ 0.52380633  0.52886956  0.53972878  0.55155184  0.56540206  0.58094842
  0.59846002  0.61800921  0.63947338  0.66326671]
Iteration 43 [27.6 s]: loss = 0.330507 [286.23 s],
NDCG_rank: [ 0.65549179  0.65238741  0.65608718  0.66315034  0.6720857   0.68419661
  0.69804761  0.71346072  0.73017686  0.7480534 ]
NDCG_rating1: [ 0.49283817  0.50056708  0.51210935  0.52558095  0.54094284  0.55823235
  0.57659626  0.59712405  0.62015163  0.64530621]
NDCG_rating2: [ 0.52355825  0.52973241  0.53933417  0.55164414  0.5654138   0.58073493
  0.5988669   0.61823513  0.63988562  0.66347782]
Iteration 44 [27.6 s]: loss = 0.327336 [285.39 s],
NDCG_rank: [ 0.6563178   0.65291796  0.65594     0.66260506  0.6722062   0.68395809
  0.69739623  0.71287576  0.72986558  0.74796163]
NDCG_rating1: [ 0.49381479  0.50044236  0.51223584  0.52547968  0.54125716  0.55825782
  0.57678875  0.59729266  0.62015478  0.64534316]
NDCG_rating2: [ 0.52543445  0.53069317  0.54105103  0.5531804   0.56691404  0.58245939
  0.60003751  0.61935473  0.64125472  0.66460861]
Iteration 45 [27.6 s]: loss = 0.324305 [286.93 s],
NDCG_rank: [ 0.65457837  0.65218812  0.65510758  0.66219311  0.67178935  0.68331282
  0.69695136  0.7123717   0.72944645  0.747659  ]
NDCG_rating1: [ 0.49209459  0.49947905  0.5117502   0.52513296  0.54083739  0.55762618
  0.57624818  0.59709052  0.61982437  0.64519934]
NDCG_rating2: [ 0.52641955  0.53227747  0.54194016  0.55394243  0.56766589  0.58321263
  0.60091085  0.61993196  0.64186414  0.66518932]
Iteration 46 [27.5 s]: loss = 0.321579 [288.36 s],
NDCG_rank: [ 0.65402121  0.6518389   0.6548578   0.66174217  0.67113598  0.68242283
  0.69646666  0.71189082  0.72880058  0.74708703]
NDCG_rating1: [ 0.49342521  0.50051921  0.51226867  0.5258041   0.54112857  0.55807873
  0.57679852  0.59755248  0.62028217  0.64561406]
NDCG_rating2: [ 0.52702232  0.53244799  0.54245574  0.55446902  0.56798382  0.58376735
  0.60125416  0.62028178  0.64207626  0.66548511]
Iteration 47 [27.7 s]: loss = 0.318865 [286.34 s],
NDCG_rank: [ 0.6530405   0.65047294  0.653791    0.6602085   0.66980823  0.68157612
  0.69555523  0.71102968  0.72800138  0.74634893]
NDCG_rating1: [ 0.49454148  0.50010011  0.51269218  0.52612259  0.54168177  0.55830408
  0.57701009  0.59754426  0.62053663  0.64576941]
NDCG_rating2: [ 0.52870483  0.53338976  0.54340517  0.55519651  0.56850982  0.58453395
  0.60223934  0.62146943  0.64295256  0.66627114]
Iteration 48 [27.5 s]: loss = 0.316344 [287.98 s],
NDCG_rank: [ 0.65420012  0.65054934  0.65367389  0.66077755  0.66972214  0.68221986
  0.69568685  0.71143804  0.72849362  0.74677116]
NDCG_rating1: [ 0.49218798  0.4996151   0.51162366  0.52527166  0.5406317   0.55748287
  0.57621584  0.596988    0.61966546  0.64512595]
NDCG_rating2: [ 0.52705219  0.53341883  0.54316316  0.55538212  0.56896917  0.58442644
  0.60208982  0.62149741  0.64294186  0.66643569]
Iteration 49 [27.6 s]: loss = 0.313973 [287.79 s],
NDCG_rank: [ 0.6501248   0.64760769  0.65188061  0.65913642  0.66902799  0.68068474
  0.69500587  0.7105745   0.72752231  0.74582582]
NDCG_rating1: [ 0.49376416  0.50038701  0.51174882  0.52544798  0.54102287  0.55793981
  0.57657276  0.59708705  0.62028679  0.64564882]
NDCG_rating2: [ 0.53037853  0.53521802  0.54508443  0.55696164  0.57068887  0.58622287
  0.60351112  0.62299973  0.64422648  0.66773234]
Iteration 50 [27.7 s]: loss = 0.311694 [284.86 s],
NDCG_rank: [ 0.65069643  0.6486696   0.6527639   0.65938836  0.66920126  0.68103096
  0.69527354  0.71100221  0.72784978  0.7460487 ]
NDCG_rating1: [ 0.49154367  0.49928164  0.51118289  0.52456028  0.54019982  0.55704185
  0.57599452  0.59657537  0.61942052  0.64510021]
NDCG_rating2: [ 0.52790492  0.53414601  0.54452609  0.55673649  0.57040025  0.58588391
  0.60327622  0.62267954  0.64415888  0.66747333]
Iteration 51 [27.5 s]: loss = 0.309590 [284.83 s],
NDCG_rank: [ 0.65013576  0.64861203  0.65210496  0.6590515   0.66843895  0.68021814
  0.69434123  0.70991631  0.72683344  0.74529997]
NDCG_rating1: [ 0.49205241  0.4999969   0.51223148  0.52548251  0.54090398  0.55821967
  0.57685871  0.59738418  0.62045815  0.64585868]
NDCG_rating2: [ 0.53041375  0.5363485   0.5456603   0.55788014  0.57141666  0.58697252
  0.60434658  0.6236913   0.64515664  0.66849498]
Iteration 52 [27.6 s]: loss = 0.307620 [285.36 s],
NDCG_rank: [ 0.65178588  0.65033611  0.65326995  0.65946915  0.66851433  0.68012049
  0.69429834  0.71017039  0.7271618   0.74560303]
NDCG_rating1: [ 0.49414148  0.50047725  0.51319736  0.5255707   0.5410295   0.55831203
  0.57701088  0.59774509  0.62064325  0.64611882]
NDCG_rating2: [ 0.52968773  0.5355587   0.54551266  0.55772401  0.57123129  0.58695414
  0.60455523  0.62394013  0.64515049  0.66832227]
Iteration 53 [27.6 s]: loss = 0.305707 [285.77 s],
NDCG_rank: [ 0.65070461  0.6484027   0.65185791  0.65870467  0.66834254  0.68051326
  0.69447232  0.70962254  0.72678727  0.74535362]
NDCG_rating1: [ 0.49276711  0.49958669  0.51143957  0.52509045  0.5406157   0.55772783
  0.57640196  0.5972855   0.62002806  0.64540367]
NDCG_rating2: [ 0.53273455  0.53853008  0.54791732  0.560062    0.57333424  0.58925674
  0.60648953  0.62570524  0.64730586  0.67006291]
Iteration 54 [27.5 s]: loss = 0.303671 [285.95 s],
NDCG_rank: [ 0.64959714  0.64755381  0.65185634  0.65935799  0.66877969  0.68054005
  0.69455797  0.71011458  0.72671978  0.74515857]
NDCG_rating1: [ 0.49253538  0.50023576  0.51245152  0.52551709  0.54120052  0.5580271
  0.57737233  0.59774147  0.62028716  0.64570365]
NDCG_rating2: [ 0.53297697  0.53804585  0.54789413  0.56033424  0.57390862  0.58940183
  0.60694059  0.62611646  0.6473334   0.67029864]
Iteration 55 [27.7 s]: loss = 0.302108 [284.92 s],
NDCG_rank: [ 0.6500006   0.64702806  0.65090363  0.65810923  0.66883642  0.6809909
  0.69459206  0.7098414   0.72665837  0.74512709]
NDCG_rating1: [ 0.49278633  0.50058461  0.51245639  0.52536818  0.54111925  0.55816608
  0.57680408  0.59737034  0.62038875  0.64574255]
NDCG_rating2: [ 0.53343478  0.53965072  0.54844312  0.56072863  0.57401054  0.59002444
  0.60721903  0.62629964  0.64767342  0.6707256 ]
Iteration 56 [27.6 s]: loss = 0.300446 [287.12 s],
NDCG_rank: [ 0.64920195  0.64602667  0.65043016  0.6578773   0.66792863  0.67981643
  0.69399044  0.70917807  0.72599378  0.74466913]
NDCG_rating1: [ 0.49284823  0.49878785  0.51147516  0.52455889  0.54014284  0.55754944
  0.57659222  0.59695851  0.62001664  0.64540999]
NDCG_rating2: [ 0.53367249  0.53912578  0.54884005  0.5609404   0.57432216  0.59023955
  0.60756071  0.62670496  0.64790838  0.67089442]
Iteration 57 [27.9 s]: loss = 0.298860 [287.93 s],
NDCG_rank: [ 0.64747385  0.646301    0.65081056  0.6573301   0.66773345  0.67984355
  0.69393306  0.70922912  0.72599689  0.74456027]
NDCG_rating1: [ 0.49392169  0.5007192   0.51290642  0.5261241   0.5421244   0.55865854
  0.57750283  0.59780316  0.62088671  0.64626269]
NDCG_rating2: [ 0.53583639  0.54108572  0.54960263  0.5620114   0.57548331  0.59146891
  0.60850034  0.62748298  0.64868956  0.67183036]
Iteration 58 [27.8 s]: loss = 0.297304 [281.82 s],
NDCG_rank: [ 0.648341    0.64662755  0.65058272  0.65728296  0.66737967  0.67950517
  0.69331472  0.70867938  0.72591828  0.74451648]
NDCG_rating1: [ 0.49318436  0.50112068  0.51327853  0.52618734  0.54171065  0.55869533
  0.57762868  0.59811977  0.62087643  0.64643563]
NDCG_rating2: [ 0.53692935  0.54194699  0.55077196  0.56314298  0.57620465  0.59215231
  0.60922652  0.6282415   0.64940763  0.67260355]
Iteration 59 [27.6 s]: loss = 0.295932 [283.00 s],
NDCG_rank: [ 0.64484176  0.64434498  0.6488236   0.6558699   0.66627561  0.67807799
  0.69206066  0.70785333  0.72511302  0.74373794]
NDCG_rating1: [ 0.49408708  0.50094779  0.5132723   0.52615891  0.54213528  0.55919442
  0.57807276  0.59868644  0.62127436  0.64658636]
NDCG_rating2: [ 0.53828579  0.54308526  0.55193081  0.56394304  0.57709351  0.59304909
  0.61017904  0.62894724  0.65013988  0.67313602]
Iteration 60 [27.5 s]: loss = 0.294430 [282.99 s],
NDCG_rank: [ 0.64827124  0.64523881  0.64925974  0.65702833  0.66712469  0.67960821
  0.6935265   0.70888417  0.72609115  0.74435487]
NDCG_rating1: [ 0.49388648  0.50169214  0.51319309  0.52615189  0.54175212  0.55891906
  0.57764032  0.59823934  0.62095312  0.64634549]
NDCG_rating2: [ 0.5394822   0.54405364  0.55241604  0.56470008  0.57793907  0.59359195
  0.61063687  0.62942076  0.6506033   0.67370825]
Iteration 61 [27.3 s]: loss = 0.293267 [282.94 s],
NDCG_rank: [ 0.6464595   0.64518309  0.6491963   0.65631513  0.66655738  0.67869068
  0.69299623  0.7085249   0.72562728  0.74412206]
NDCG_rating1: [ 0.49238319  0.50062191  0.51299343  0.52608678  0.54130867  0.55823288
  0.57716204  0.59778807  0.62052984  0.64609209]
NDCG_rating2: [ 0.5389483   0.54432476  0.5531806   0.56490042  0.57778905  0.59383311
  0.61086788  0.62954598  0.65069707  0.67370905]
Iteration 62 [27.5 s]: loss = 0.291967 [281.52 s],
NDCG_rank: [ 0.64760874  0.64676549  0.65116494  0.6576846   0.66713709  0.67945857
  0.6938084   0.70926809  0.72621317  0.74478218]
NDCG_rating1: [ 0.49206185  0.50052745  0.51258961  0.52565483  0.54112438  0.55776012
  0.57698439  0.59725826  0.62024777  0.6457832 ]
NDCG_rating2: [ 0.5403126   0.54512287  0.55399849  0.56570474  0.57909931  0.5945472
  0.61187066  0.63042378  0.65164471  0.67454037]
Iteration 63 [27.5 s]: loss = 0.290568 [282.96 s],
NDCG_rank: [ 0.648558    0.64577359  0.64970084  0.65712623  0.66696293  0.6790122
  0.69320797  0.70925179  0.72619323  0.7446956 ]
NDCG_rating1: [ 0.49321423  0.50184912  0.51355721  0.52676449  0.54213998  0.55915583
  0.57778761  0.59840506  0.62120957  0.64663476]
NDCG_rating2: [ 0.5423413   0.54536461  0.55500589  0.56617376  0.57920738  0.5955856
  0.61248069  0.63115502  0.65228115  0.67514294]
Iteration 64 [27.5 s]: loss = 0.289489 [280.48 s],
NDCG_rank: [ 0.64691008  0.64383192  0.6473437   0.65454071  0.66512995  0.67741814
  0.69178887  0.70749014  0.72475818  0.74330163]
NDCG_rating1: [ 0.49399904  0.50206053  0.51349792  0.52613406  0.54180568  0.55866211
  0.57780184  0.59840636  0.62128371  0.64658899]
NDCG_rating2: [ 0.54225798  0.54609111  0.55539297  0.56661889  0.58001537  0.59594161
  0.61274796  0.63146185  0.65251035  0.67567117]
Iteration 65 [27.7 s]: loss = 0.288515 [281.35 s],
NDCG_rank: [ 0.64532441  0.64436882  0.64957938  0.65621008  0.66616055  0.67772029
  0.692357    0.70811281  0.72540492  0.74381555]
NDCG_rating1: [ 0.49337522  0.50264803  0.51400738  0.52697069  0.54281412  0.55950778
  0.57835888  0.59873301  0.62160744  0.64707009]
NDCG_rating2: [ 0.5434113   0.54621704  0.55558483  0.5671741   0.58018032  0.5958925
  0.61301949  0.63173124  0.6525224   0.67547289]
Iteration 66 [27.4 s]: loss = 0.287329 [279.97 s],
NDCG_rank: [ 0.64642083  0.64420979  0.64818534  0.65573666  0.66559291  0.67774289
  0.69172096  0.70750352  0.72480852  0.74348022]
NDCG_rating1: [ 0.49599001  0.50365538  0.51461937  0.52776674  0.54328724  0.56005031
  0.57914451  0.59953045  0.62255421  0.64774702]
NDCG_rating2: [ 0.54389835  0.54740525  0.55630047  0.56760576  0.58038493  0.59620362
  0.61344859  0.63210889  0.65298293  0.67585915]
Iteration 67 [27.5 s]: loss = 0.286182 [280.01 s],
NDCG_rank: [ 0.6441387   0.64310242  0.64694557  0.65469111  0.66557919  0.67745644
  0.69137009  0.70737818  0.72447889  0.74309567]
NDCG_rating1: [ 0.49395911  0.50321371  0.5147594   0.52728061  0.54269252  0.55967933
  0.57842437  0.59892845  0.62183667  0.64711216]
NDCG_rating2: [ 0.5450347   0.54802527  0.55661327  0.56788314  0.58108755  0.59669023
  0.61382163  0.63272495  0.65339431  0.67597498]
Iteration 68 [27.5 s]: loss = 0.285345 [280.99 s],
NDCG_rank: [ 0.6452414   0.64395956  0.64880059  0.6563411   0.66632587  0.67866372
  0.69263845  0.70852305  0.72578669  0.74394743]
NDCG_rating1: [ 0.49464991  0.50253782  0.51429876  0.52738635  0.54232219  0.55954489
  0.57847007  0.59903158  0.62199081  0.64684107]
NDCG_rating2: [ 0.546072    0.54889166  0.5579394   0.56940795  0.58227114  0.59785808
  0.61473797  0.63322239  0.65424781  0.67697876]
Iteration 69 [27.5 s]: loss = 0.284318 [281.17 s],
NDCG_rank: [ 0.64571808  0.64264296  0.64731924  0.65475532  0.66573599  0.67743572
  0.69165911  0.70773176  0.72493857  0.743015  ]
NDCG_rating1: [ 0.49511369  0.50347071  0.51517763  0.52834     0.54318469  0.56036578
  0.57933518  0.59971127  0.62229586  0.64783478]
NDCG_rating2: [ 0.54569531  0.54905881  0.55757949  0.56890552  0.58176842  0.59741711
  0.61459661  0.63312401  0.6540961   0.67651062]
Iteration 70 [27.5 s]: loss = 0.283279 [279.77 s],
NDCG_rank: [ 0.64352902  0.64310233  0.64704313  0.65423972  0.66458284  0.67723154
  0.69113815  0.7072458   0.72467849  0.74307947]
NDCG_rating1: [ 0.49427543  0.5037975   0.515627    0.5281526   0.5433773   0.56013861
  0.57927598  0.59998356  0.62261718  0.64764142]
NDCG_rating2: [ 0.54613394  0.54931623  0.55806333  0.56975311  0.58234015  0.59797619
  0.61505168  0.63363935  0.65489724  0.67732046]
Iteration 71 [27.6 s]: loss = 0.282451 [281.55 s],
NDCG_rank: [ 0.6430775   0.64155908  0.64579584  0.65342669  0.6635739   0.67612058
  0.69069223  0.70676486  0.72394621  0.74241882]
NDCG_rating1: [ 0.49510332  0.50397275  0.51542564  0.52862128  0.54336925  0.5605197
  0.57938963  0.59992323  0.62280666  0.64777425]
NDCG_rating2: [ 0.54622859  0.54921669  0.55789754  0.56911103  0.58189731  0.59734575
  0.61437663  0.63314463  0.65425239  0.67675048]
Iteration 72 [27.4 s]: loss = 0.281666 [279.21 s],
NDCG_rank: [ 0.64421322  0.64237464  0.6467952   0.65443222  0.66506514  0.67755088
  0.69171259  0.7074933   0.7248504   0.7434091 ]
NDCG_rating1: [ 0.49630632  0.50412636  0.51613751  0.52822627  0.54339351  0.5606011
  0.57946837  0.60023937  0.62285773  0.64796406]
NDCG_rating2: [ 0.54613834  0.54975165  0.55877298  0.56979796  0.58251342  0.59800368
  0.61502343  0.63399222  0.65487914  0.67745259]
Iteration 73 [27.5 s]: loss = 0.280680 [278.84 s],
NDCG_rank: [ 0.64476567  0.6427292   0.64746476  0.65499671  0.66519975  0.67745039
  0.69160284  0.7074779   0.72474723  0.74315321]
NDCG_rating1: [ 0.49623778  0.50441164  0.51666694  0.5286891   0.54396756  0.56078415
  0.57969211  0.6003017   0.62294305  0.64811897]
NDCG_rating2: [ 0.54814031  0.55026757  0.55898971  0.57011219  0.58296344  0.59812465
  0.61504118  0.63407396  0.65482342  0.67742281]
Iteration 74 [27.4 s]: loss = 0.279927 [279.93 s],
NDCG_rank: [ 0.64383307  0.64327045  0.64744685  0.65582009  0.66594001  0.67896494
  0.69270033  0.70818977  0.72522875  0.74366504]
NDCG_rating1: [ 0.49569193  0.50427529  0.51593946  0.52847277  0.54332086  0.56047447
  0.57956427  0.60003841  0.62276655  0.64780573]
NDCG_rating2: [ 0.54775514  0.5507841   0.55952357  0.5704797   0.58335039  0.59861695
  0.61568949  0.63434741  0.65558959  0.67815916]
Iteration 75 [27.5 s]: loss = 0.279123 [281.59 s],
NDCG_rank: [ 0.64274138  0.64226151  0.64690246  0.65432103  0.66485496  0.67722689
  0.69154762  0.70725687  0.72442617  0.74278392]
NDCG_rating1: [ 0.49726879  0.50471674  0.5164413   0.52886929  0.54397818  0.56073951
  0.57980365  0.60055171  0.62320252  0.64797405]
NDCG_rating2: [ 0.54652541  0.54995091  0.55842257  0.5695994   0.58243895  0.59793919
  0.61490605  0.6337842   0.6548157   0.67732639]
Iteration 76 [27.4 s]: loss = 0.278404 [279.82 s],
NDCG_rank: [ 0.64510777  0.64321836  0.6473123   0.65511473  0.66560809  0.67802512
  0.69211836  0.70743088  0.72471221  0.74327668]
NDCG_rating1: [ 0.49695688  0.50528272  0.51638365  0.52878761  0.54380049  0.561338
  0.57994781  0.60044462  0.62322602  0.64828055]
NDCG_rating2: [ 0.54701938  0.55076291  0.55901332  0.57034425  0.58330849  0.59846934
  0.61549145  0.63441362  0.65562244  0.67819922]
Iteration 77 [27.6 s]: loss = 0.277644 [278.89 s],
NDCG_rank: [ 0.6401379   0.64082658  0.64579675  0.65397954  0.66464915  0.67684365
  0.69083703  0.70705952  0.72410062  0.74268271]
NDCG_rating1: [ 0.49651542  0.5048125   0.51643605  0.5286049   0.5436534   0.56058031
  0.5795923   0.60035277  0.62295719  0.64790733]
NDCG_rating2: [ 0.54740141  0.55099289  0.55952142  0.57091836  0.58380473  0.59886316
  0.61617447  0.63488283  0.65577618  0.678311  ]
Iteration 78 [27.4 s]: loss = 0.276918 [279.53 s],
NDCG_rank: [ 0.64297909  0.64218625  0.64696518  0.65462879  0.66524153  0.67826864
  0.69220478  0.70750741  0.72474485  0.74296723]
NDCG_rating1: [ 0.49738702  0.5052352   0.51637249  0.52937972  0.54384405  0.56089356
  0.57995346  0.60076306  0.62348054  0.64847312]
NDCG_rating2: [ 0.54681971  0.5512291   0.5595227   0.57053649  0.58357428  0.5988396
  0.61602956  0.63444348  0.6557526   0.67828884]
Iteration 79 [27.5 s]: loss = 0.276124 [278.32 s],
NDCG_rank: [ 0.64080072  0.64074706  0.64530625  0.65428236  0.6647222   0.67693058
  0.69082914  0.70691587  0.72378314  0.74236683]
NDCG_rating1: [ 0.49789828  0.5054128   0.51717984  0.52928687  0.54413242  0.56141111
  0.58033707  0.60113211  0.62386801  0.64860682]
NDCG_rating2: [ 0.54730739  0.55130617  0.5593333   0.57039482  0.5833544   0.59887208
  0.61586502  0.63444482  0.65548945  0.67820689]
Iteration 80 [27.4 s]: loss = 0.275518 [279.09 s],
NDCG_rank: [ 0.64315988  0.64230713  0.64681579  0.65450478  0.66506271  0.67727568
  0.69178686  0.70767936  0.72442385  0.74296866]
NDCG_rating1: [ 0.49641134  0.50551538  0.51649986  0.52899234  0.54409434  0.56138475
  0.58019643  0.60116235  0.62356911  0.64841133]
NDCG_rating2: [ 0.54640592  0.55247372  0.56029476  0.57063358  0.58342328  0.59918783
  0.61634315  0.63502933  0.65585806  0.67856023]
Iteration 81 [27.6 s]: loss = 0.274945 [278.70 s],
NDCG_rank: [ 0.64307467  0.64225818  0.64612577  0.65441707  0.66513309  0.67763973
  0.69153745  0.70749345  0.72470423  0.74293339]
NDCG_rating1: [ 0.49651605  0.50656517  0.5174439   0.52952392  0.54444941  0.56137797
  0.5806892   0.60141983  0.62412177  0.64903383]
NDCG_rating2: [ 0.54739072  0.55155732  0.55987153  0.57094642  0.58378236  0.59937519
  0.61623455  0.63509058  0.65602758  0.67851983]
Iteration 82 [29.2 s]: loss = 0.274317 [288.29 s],
NDCG_rank: [ 0.64296179  0.64116662  0.64546526  0.65343207  0.66384858  0.67672929
  0.69106683  0.70667228  0.72389547  0.74234735]
NDCG_rating1: [ 0.49812278  0.50714404  0.51792154  0.53033759  0.54513249  0.56228645
  0.58158532  0.60211902  0.62478725  0.64958918]
NDCG_rating2: [ 0.54788055  0.5524026   0.56041879  0.57137252  0.58419601  0.59952634
  0.61670408  0.63538665  0.65640899  0.67902262]
Iteration 83 [28.2 s]: loss = 0.273512 [280.12 s],
NDCG_rank: [ 0.63898898  0.64084239  0.64568697  0.65391609  0.66425911  0.67697345
  0.69132315  0.70716754  0.72386614  0.74231832]
NDCG_rating1: [ 0.49827622  0.50706532  0.51826687  0.53071906  0.54591128  0.56275724
  0.58183764  0.60226702  0.62497138  0.64977787]
NDCG_rating2: [ 0.54875345  0.552726    0.56131461  0.57182253  0.5847184   0.59974321
  0.61714838  0.63585162  0.65666701  0.67919868]
Iteration 84 [27.5 s]: loss = 0.272978 [277.33 s],
NDCG_rank: [ 0.64194178  0.64169504  0.64596949  0.65384353  0.66418281  0.67690392
  0.69120558  0.70718291  0.72424705  0.74250534]
NDCG_rating1: [ 0.49924246  0.5083787   0.51822783  0.53079581  0.54550294  0.56298884
  0.58202118  0.6025596   0.6251564   0.65003312]
NDCG_rating2: [ 0.54895621  0.55360793  0.5614656   0.5722324   0.58504801  0.60048888
  0.61755844  0.63621103  0.65725339  0.67965662]
Iteration 85 [27.5 s]: loss = 0.272484 [277.45 s],
NDCG_rank: [ 0.64019261  0.63929893  0.64512675  0.6533078   0.66399982  0.67659705
  0.69056862  0.70657843  0.72333298  0.74162964]
NDCG_rating1: [ 0.49979994  0.5084809   0.51843885  0.53086536  0.54586112  0.56290361
  0.58222991  0.60274274  0.62525531  0.65033936]
NDCG_rating2: [ 0.54903545  0.5529152   0.56117815  0.57180755  0.58476131  0.60023181
  0.61718837  0.63591896  0.65678794  0.67940513]
Iteration 86 [27.5 s]: loss = 0.271827 [274.87 s],
NDCG_rank: [ 0.63974172  0.64145221  0.64586353  0.65324896  0.66371365  0.67670172
  0.69121463  0.70708472  0.72375725  0.74239794]
NDCG_rating1: [ 0.50063255  0.50859812  0.51868048  0.53146684  0.54602667  0.56306742
  0.58231224  0.60297219  0.62543274  0.65034769]
NDCG_rating2: [ 0.55020481  0.55375004  0.56221072  0.57248413  0.58526967  0.60081482
  0.61797477  0.63661429  0.65745446  0.68009521]
Iteration 87 [27.5 s]: loss = 0.271309 [277.53 s],
NDCG_rank: [ 0.64044384  0.64136554  0.64509006  0.65344539  0.66410669  0.67643469
  0.69075835  0.70652085  0.72349248  0.74195488]
NDCG_rating1: [ 0.49949998  0.50850997  0.51892872  0.53117509  0.54597423  0.5626948
  0.58205707  0.60269868  0.62505492  0.6499927 ]
NDCG_rating2: [ 0.5491455   0.5531686   0.56151457  0.57189909  0.5850861   0.60040395
  0.61760379  0.63627154  0.65702989  0.67991233]
Iteration 88 [27.3 s]: loss = 0.270692 [276.56 s],
NDCG_rank: [ 0.64320139  0.64131623  0.64646338  0.65351106  0.66400073  0.67678894
  0.69092101  0.70715456  0.72394764  0.7425461 ]
NDCG_rating1: [ 0.5000779   0.50894513  0.51898171  0.53147887  0.54615857  0.56315227
  0.58257171  0.60327389  0.62556195  0.65031719]
NDCG_rating2: [ 0.54859179  0.55313506  0.5619733   0.57246516  0.58509804  0.60063455
  0.61754455  0.63638809  0.65706759  0.67982198]
Iteration 89 [27.5 s]: loss = 0.270253 [278.18 s],
NDCG_rank: [ 0.63856482  0.64035844  0.64571068  0.65359211  0.66358233  0.67651416
  0.69076019  0.70679507  0.72366169  0.74208469]
NDCG_rating1: [ 0.49990528  0.50892171  0.51925768  0.53179243  0.5463417   0.5636713
  0.58289019  0.60313536  0.62556982  0.65064344]
NDCG_rating2: [ 0.55029442  0.55393235  0.56273936  0.57319016  0.58583274  0.60121628
  0.61831835  0.63683503  0.6576638   0.68024829]
Iteration 90 [27.4 s]: loss = 0.269727 [276.29 s],
NDCG_rank: [ 0.64038756  0.64009429  0.64523647  0.65225973  0.66343349  0.67605862
  0.69043894  0.70664446  0.72328671  0.74172272]
NDCG_rating1: [ 0.50034548  0.50915873  0.51980448  0.53233629  0.54674126  0.56410772
  0.58301527  0.6038173   0.62613558  0.65098175]
NDCG_rating2: [ 0.55019947  0.55427765  0.56253595  0.57299054  0.58571099  0.60133342
  0.6184169   0.636892    0.65761233  0.68039911]
Iteration 91 [27.5 s]: loss = 0.269210 [276.09 s],
NDCG_rank: [ 0.63948389  0.64012742  0.6451598   0.65320082  0.66339594  0.67601909
  0.69044191  0.70657987  0.72353657  0.74198389]
NDCG_rating1: [ 0.50034988  0.50937331  0.51909265  0.53219888  0.54682128  0.56382392
  0.58292134  0.60341581  0.62554476  0.65073389]
NDCG_rating2: [ 0.55032209  0.55450082  0.56280585  0.5732871   0.58620389  0.60179446
  0.61869274  0.63721853  0.65808407  0.68055573]
Iteration 92 [27.5 s]: loss = 0.268682 [274.84 s],
NDCG_rank: [ 0.64050359  0.64162111  0.64618018  0.65388732  0.66412809  0.67639692
  0.69091022  0.70677756  0.72386208  0.74227933]
NDCG_rating1: [ 0.50148874  0.51001375  0.51986381  0.53277041  0.5473693   0.56437349
  0.58331625  0.60392     0.6265424   0.65123728]
NDCG_rating2: [ 0.54880057  0.55459951  0.56280182  0.57319634  0.58593746  0.60158609
  0.61855662  0.63716436  0.65797695  0.68043037]
Iteration 93 [27.5 s]: loss = 0.268175 [275.74 s],
NDCG_rank: [ 0.63949458  0.63928197  0.645422    0.65356971  0.66405655  0.67628371
  0.69063831  0.70656139  0.72352559  0.74207885]
NDCG_rating1: [ 0.50130543  0.51017634  0.51989782  0.53251291  0.54731046  0.56424347
  0.58326568  0.60415614  0.62650419  0.65145671]
NDCG_rating2: [ 0.54874775  0.55418606  0.56247133  0.57318206  0.586153    0.60143512
  0.61811232  0.6369508   0.65789802  0.68038032]
Iteration 94 [27.5 s]: loss = 0.267871 [273.19 s],
NDCG_rank: [ 0.6395037   0.63998243  0.64554465  0.65324519  0.66391473  0.67665203
  0.69089511  0.70655752  0.72356314  0.74215465]
NDCG_rating1: [ 0.50002853  0.50978701  0.51960959  0.53246572  0.54721772  0.56423139
  0.58291376  0.60369186  0.62633824  0.65110978]
NDCG_rating2: [ 0.54941842  0.55544914  0.56343679  0.5738588   0.58637291  0.60223004
  0.61894074  0.6375075   0.65829023  0.68081838]
Iteration 95 [27.4 s]: loss = 0.267418 [275.74 s],
NDCG_rank: [ 0.6393446   0.63975936  0.64545528  0.6531547   0.66386435  0.67660999
  0.69112929  0.70662955  0.72372139  0.742457  ]
NDCG_rating1: [ 0.50073569  0.50988213  0.52009935  0.53264696  0.54702918  0.56429102
  0.58325655  0.60403128  0.62631933  0.65125228]
NDCG_rating2: [ 0.54874586  0.55444908  0.56239201  0.57317369  0.58622116  0.60155818
  0.61851245  0.6370638   0.6580096   0.68062284]
Iteration 96 [27.4 s]: loss = 0.266855 [275.17 s],
NDCG_rank: [ 0.64152705  0.64109773  0.6456075   0.6535345   0.66437277  0.67682084
  0.69109002  0.70716032  0.72395401  0.74228414]
NDCG_rating1: [ 0.50013733  0.50967209  0.51985474  0.53289813  0.54772096  0.5642736
  0.5834153   0.6041811   0.62663561  0.65151175]
NDCG_rating2: [ 0.54740136  0.55370658  0.56170699  0.57279725  0.58518565  0.60106018
  0.61794423  0.63643266  0.65742364  0.6798688 ]
Iteration 97 [27.5 s]: loss = 0.266533 [275.97 s],
NDCG_rank: [ 0.63997723  0.64132207  0.6459975   0.65426516  0.66419324  0.67689168
  0.69160953  0.70748734  0.72436724  0.74277349]
NDCG_rating1: [ 0.50028008  0.50979395  0.51962738  0.53245366  0.54741904  0.56423489
  0.58305545  0.60378541  0.62644241  0.65132451]
NDCG_rating2: [ 0.5490628   0.55467568  0.56277034  0.57321691  0.58647735  0.60222114
  0.61846278  0.63729335  0.6583176   0.68083613]
Iteration 98 [27.4 s]: loss = 0.266035 [274.59 s],
NDCG_rank: [ 0.64173332  0.64081019  0.64542292  0.65329901  0.66406679  0.67643239
  0.69095135  0.70688803  0.72378764  0.74239559]
NDCG_rating1: [ 0.50015399  0.51035843  0.52035691  0.53318649  0.54796503  0.56461688
  0.58370263  0.60426937  0.6267775   0.65179381]
NDCG_rating2: [ 0.5474589   0.55365495  0.56198479  0.57241151  0.58560922  0.60126874
  0.61826652  0.63679662  0.65772677  0.68003491]
Iteration 99 [27.6 s]: loss = 0.265703 [273.92 s],
NDCG_rank: [ 0.64019859  0.64066226  0.64591055  0.65409587  0.66481144  0.67664441
  0.69112225  0.70716505  0.72421305  0.74243625]
NDCG_rating1: [ 0.50130637  0.51065449  0.52102423  0.53404263  0.5487378   0.56529155
  0.58401154  0.60465539  0.62737847  0.65227826]
NDCG_rating2: [ 0.54988284  0.55502969  0.56282809  0.57311387  0.58640938  0.60202955
  0.61855863  0.63735019  0.65807637  0.68068344]
End. Best Iteration 3: NDCG = 0.8023. 



liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.75,0.25,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.75,0.25,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.0 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [75.7], Init: NDCG = 
(array([ 0.55763756,  0.56245844,  0.57063755,  0.58154022,  0.59439509,
        0.60906819,  0.6258685 ,  0.64402047,  0.66459288,  0.68655205]), array([ 0.55786781,  0.56286784,  0.57187161,  0.58263873,  0.59548408,
        0.61059896,  0.62723321,  0.64556413,  0.66597229,  0.6880472 ]), array([ 0.5645258 ,  0.57002971,  0.57737604,  0.58772413,  0.59988646,
        0.61406722,  0.63062925,  0.64887626,  0.66872546,  0.69058501]))
Iteration 0 [24.9 s]: loss = 2.084877 [75.50 s],
NDCG_rank: [ 0.66410495  0.66484055  0.66998407  0.67771515  0.68823702  0.69985127
  0.71326524  0.72823972  0.7445101   0.76156567]
NDCG_rating1: [ 0.7077238   0.69824733  0.69573324  0.69819258  0.7049004   0.71471667
  0.72629591  0.73948095  0.75435801  0.77080938]
NDCG_rating2: [ 0.40915355  0.42147091  0.43791077  0.45422934  0.47296883  0.49389215
  0.51575433  0.53974008  0.56597475  0.59453684]
Iteration 1 [20.0 s]: loss = 0.770843 [76.72 s],
NDCG_rank: [ 0.71301088  0.70741662  0.70858482  0.71437246  0.72234965  0.73177826
  0.74375084  0.75674102  0.77073427  0.78611799]
NDCG_rating1: [ 0.75495101  0.7391682   0.73660914  0.73854303  0.74449126  0.75207204
  0.76243297  0.77426816  0.78751074  0.80180846]
NDCG_rating2: [ 0.38545876  0.40448065  0.42360054  0.44236242  0.46240085  0.48349275
  0.50632054  0.53092079  0.55755068  0.58639462]
Iteration 2 [20.0 s]: loss = 0.738304 [76.62 s],
NDCG_rank: [ 0.74635231  0.7361799   0.7342031   0.73704675  0.74235728  0.75053371
  0.7609354   0.77335424  0.78676827  0.80122417]
NDCG_rating1: [ 0.76980872  0.75343143  0.74914689  0.75001596  0.75426455  0.76195224
  0.77149663  0.78259524  0.79507134  0.80886103]
NDCG_rating2: [ 0.38189556  0.40215368  0.42154407  0.44090658  0.46069436  0.4815556
  0.50509655  0.5295358   0.55608591  0.58522578]
Iteration 3 [19.9 s]: loss = 0.726262 [76.30 s],
NDCG_rank: [ 0.75719733  0.74731595  0.74386558  0.7452728   0.74990441  0.75773788
  0.76754629  0.77910044  0.79193893  0.80586852]
NDCG_rating1: [ 0.77446605  0.75791051  0.75335936  0.75307532  0.75708337  0.76407821
  0.77385564  0.78498834  0.79743336  0.81100948]
NDCG_rating2: [ 0.3837753   0.4017668   0.42126086  0.44026241  0.46008478  0.48101229
  0.50471726  0.52923453  0.55584603  0.5851255 ]
Iteration 4 [20.2 s]: loss = 0.717242 [76.28 s],
NDCG_rank: [ 0.76348277  0.75347028  0.74825178  0.74871031  0.75404241  0.76097307
  0.77056922  0.78189238  0.79462748  0.80822589]
NDCG_rating1: [ 0.77551624  0.75914812  0.75332369  0.75330058  0.75715794  0.76461012
  0.77423596  0.78544949  0.79788256  0.81117109]
NDCG_rating2: [ 0.38354263  0.4009315   0.42056581  0.4393867   0.45925205  0.48061517
  0.50382872  0.52818748  0.55506378  0.58457566]
Iteration 5 [20.1 s]: loss = 0.709880 [76.24 s],
NDCG_rank: [ 0.7668305   0.75529825  0.75030917  0.75059124  0.75502765  0.76253987
  0.77187849  0.78316003  0.79582739  0.80947442]
NDCG_rating1: [ 0.77703902  0.76052892  0.75460826  0.75427107  0.75818182  0.76563554
  0.77485834  0.7863836   0.79854527  0.81198151]
NDCG_rating2: [ 0.38332473  0.40019274  0.4191651   0.43867839  0.45865164  0.47957078
  0.50294473  0.52743091  0.55457135  0.58391769]
Iteration 6 [20.1 s]: loss = 0.704915 [76.09 s],
NDCG_rank: [ 0.76787786  0.75526233  0.75069138  0.75063006  0.75496527  0.76235382
  0.77171274  0.78307681  0.79589002  0.80951384]
NDCG_rating1: [ 0.7760275   0.76030526  0.75345459  0.75429453  0.75783133  0.7649718
  0.77446871  0.78559526  0.79803162  0.81160768]
NDCG_rating2: [ 0.38357973  0.40023025  0.4190889   0.4382794   0.45826281  0.4794702
  0.5027618   0.52736411  0.55464201  0.58379912]
Iteration 7 [20.1 s]: loss = 0.700317 [76.09 s],
NDCG_rank: [ 0.7674974   0.75628839  0.75090848  0.75112791  0.75489042  0.76231053
  0.77165792  0.78282472  0.79548867  0.80934657]
NDCG_rating1: [ 0.77867688  0.76050118  0.75425519  0.75435094  0.7579826   0.76555141
  0.77482415  0.78620842  0.79843135  0.81178592]
NDCG_rating2: [ 0.38486669  0.40002618  0.41924532  0.43831947  0.45829162  0.4797002
  0.50283549  0.52768302  0.55461341  0.58405963]
Iteration 8 [20.0 s]: loss = 0.694583 [74.69 s],
NDCG_rank: [ 0.76833189  0.75571238  0.7506229   0.74975739  0.75436278  0.76170798
  0.77113043  0.78232893  0.79511021  0.80907702]
NDCG_rating1: [ 0.7762237   0.75962024  0.75376428  0.75374861  0.75762273  0.76496444
  0.77454854  0.7856263   0.79812147  0.81146229]
NDCG_rating2: [ 0.38613038  0.40130754  0.42010063  0.43877114  0.45927113  0.4804351
  0.50345281  0.52798172  0.55501232  0.58438212]
Iteration 9 [19.6 s]: loss = 0.686357 [74.35 s],
NDCG_rank: [ 0.76920129  0.75468034  0.7494388   0.75006847  0.75379683  0.76119748
  0.7707156   0.78212337  0.79446907  0.80850163]
NDCG_rating1: [ 0.77584922  0.75901873  0.75373152  0.75411333  0.75788446  0.7650311
  0.77466744  0.78559204  0.79797297  0.81133584]
NDCG_rating2: [ 0.38826535  0.40348     0.42170196  0.44077853  0.46114052  0.4825876
  0.50506041  0.52954839  0.55620317  0.58545797]
Iteration 10 [19.7 s]: loss = 0.674174 [74.04 s],
NDCG_rank: [ 0.76615196  0.75365063  0.74796405  0.74799667  0.75261179  0.75969737
  0.76962888  0.78107671  0.79372367  0.80785517]
NDCG_rating1: [ 0.77510339  0.75881121  0.75327699  0.75357471  0.75773378  0.76500493
  0.77423076  0.78556696  0.79790779  0.81134277]
NDCG_rating2: [ 0.39218314  0.40755147  0.42557229  0.44413428  0.46402227  0.48567335
  0.50832845  0.53256375  0.55900495  0.5882507 ]
Iteration 11 [19.7 s]: loss = 0.658551 [73.89 s],
NDCG_rank: [ 0.76451001  0.75167015  0.74650774  0.74648601  0.75114425  0.75856389
  0.76846754  0.77991152  0.79264595  0.80685607]
NDCG_rating1: [ 0.77535651  0.75954798  0.75369088  0.75363925  0.75755845  0.76500503
  0.77437357  0.78542975  0.79779495  0.8114105 ]
NDCG_rating2: [ 0.40133428  0.41891362  0.4370094   0.45502331  0.47482713  0.4957253
  0.51831895  0.54214547  0.56797557  0.59622386]
Iteration 12 [19.6 s]: loss = 0.641043 [74.83 s],
NDCG_rank: [ 0.75996777  0.74782669  0.74276788  0.74380568  0.74883688  0.75666102
  0.76660556  0.77848259  0.79118161  0.8053604 ]
NDCG_rating1: [ 0.77457578  0.75876807  0.75357967  0.7535914   0.75760856  0.76495419
  0.77431787  0.78554267  0.79771805  0.81122727]
NDCG_rating2: [ 0.4272816   0.44516423  0.4604354   0.47853189  0.49680627  0.51643409
  0.5377913   0.5604622   0.58528211  0.61249685]
Iteration 13 [19.9 s]: loss = 0.623835 [74.80 s],
NDCG_rank: [ 0.75703881  0.74464628  0.74069114  0.74193483  0.74679616  0.75452265
  0.76436733  0.77632124  0.78947893  0.80387008]
NDCG_rating1: [ 0.77619886  0.7602981   0.75430264  0.75391911  0.75783284  0.76499286
  0.77435149  0.78535772  0.79784226  0.81140997]
NDCG_rating2: [ 0.46106857  0.47725668  0.49092813  0.50615833  0.52303029  0.54108925
  0.56110138  0.58286939  0.60624027  0.63221625]
Iteration 14 [19.6 s]: loss = 0.607872 [74.27 s],
NDCG_rank: [ 0.75366939  0.74214572  0.73827037  0.73938518  0.74489294  0.75270522
  0.76277404  0.7743622   0.78796919  0.80232386]
NDCG_rating1: [ 0.7758445   0.76028164  0.7544056   0.75390442  0.75813002  0.76450129
  0.77387337  0.78526041  0.79760137  0.81107842]
NDCG_rating2: [ 0.49132702  0.50605843  0.51852375  0.53262357  0.54720146  0.56448061
  0.58283728  0.60343189  0.62594153  0.65073862]
Iteration 15 [19.8 s]: loss = 0.593264 [74.08 s],
NDCG_rank: [ 0.7536433   0.74066506  0.73651592  0.73786331  0.74276555  0.75099804
  0.76135276  0.77357813  0.78670845  0.8013968 ]
NDCG_rating1: [ 0.77547568  0.75948363  0.75361392  0.75373203  0.75719301  0.76383894
  0.7732453   0.78448898  0.79718326  0.81060735]
NDCG_rating2: [ 0.51481115  0.52538899  0.53588321  0.54893222  0.56309818  0.57914376
  0.59680152  0.61705923  0.63883423  0.66262646]
Iteration 16 [19.6 s]: loss = 0.580004 [73.97 s],
NDCG_rank: [ 0.75171113  0.73897794  0.73529168  0.7371246   0.74248341  0.75011263
  0.76013759  0.77196904  0.78522642  0.79997944]
NDCG_rating1: [ 0.77449749  0.75879414  0.75275488  0.75228587  0.75597649  0.76300791
  0.77219415  0.78348242  0.79630106  0.80984119]
NDCG_rating2: [ 0.53311186  0.54288685  0.55264695  0.56449283  0.57793011  0.59360885
  0.61142183  0.63056089  0.65147923  0.67475155]
Iteration 17 [19.8 s]: loss = 0.567880 [73.80 s],
NDCG_rank: [ 0.75106655  0.73720222  0.73309906  0.73441607  0.74020055  0.74838629
  0.75867976  0.77074832  0.78452952  0.79902624]
NDCG_rating1: [ 0.77358722  0.7572284   0.75141838  0.75088849  0.75434147  0.76110087
  0.77035208  0.78175227  0.79448941  0.80841037]
NDCG_rating2: [ 0.55538508  0.56106039  0.56880867  0.57943715  0.59213309  0.60670993
  0.62378585  0.6423897   0.66261943  0.68509438]
Iteration 18 [19.6 s]: loss = 0.556719 [75.37 s],
NDCG_rank: [ 0.74821279  0.73602537  0.73284303  0.73387901  0.73859739  0.74668866
  0.75701888  0.76939608  0.78292762  0.79776505]
NDCG_rating1: [ 0.77284768  0.75651262  0.75003473  0.74943243  0.75282647  0.7595658
  0.76911652  0.78043105  0.79308839  0.80704392]
NDCG_rating2: [ 0.56509842  0.57055031  0.57737531  0.58728461  0.5995146   0.61363717
  0.62994053  0.64834352  0.66851462  0.69082342]
Iteration 19 [19.8 s]: loss = 0.546290 [75.41 s],
NDCG_rank: [ 0.74309609  0.73328218  0.73030767  0.7307335   0.73691823  0.74510655
  0.75606817  0.76814123  0.78147275  0.79632735]
NDCG_rating1: [ 0.77002599  0.75368296  0.74794908  0.74722174  0.75054361  0.75727644
  0.76706442  0.77856732  0.79145525  0.8053165 ]
NDCG_rating2: [ 0.57177155  0.57640667  0.58269136  0.59238086  0.60427     0.61846936
  0.63472098  0.65269304  0.67269054  0.69456438]
Iteration 20 [19.6 s]: loss = 0.536351 [75.17 s],
NDCG_rank: [ 0.74165254  0.7315433   0.72766809  0.72973908  0.73485041  0.74368893
  0.75372861  0.76603025  0.7799781   0.79499268]
NDCG_rating1: [ 0.76607537  0.74940705  0.744192    0.74325449  0.74712878  0.75389405
  0.76402829  0.7753983   0.78880492  0.80296705]
NDCG_rating2: [ 0.58099218  0.58444429  0.59039053  0.60009343  0.61105116  0.62483693
  0.64090489  0.65856466  0.67815635  0.69961199]
Iteration 21 [19.7 s]: loss = 0.526741 [76.11 s],
NDCG_rank: [ 0.7386161   0.73097269  0.72617076  0.72773713  0.73375826  0.74227066
  0.75289779  0.76482109  0.77903213  0.79379907]
NDCG_rating1: [ 0.76430608  0.74641408  0.7417895   0.7411003   0.74468241  0.75208474
  0.76215684  0.77378044  0.78719081  0.80124326]
NDCG_rating2: [ 0.58429463  0.58886578  0.59490486  0.60401002  0.61485538  0.62831177
  0.64397601  0.66117882  0.68067472  0.70235928]
Iteration 22 [19.7 s]: loss = 0.517159 [75.63 s],
NDCG_rank: [ 0.73471278  0.72639446  0.72308826  0.72564928  0.73202127  0.7405903
  0.75141868  0.76351721  0.77716577  0.79235897]
NDCG_rating1: [ 0.76150074  0.74367615  0.7386865   0.73854267  0.74239367  0.74988805
  0.76025534  0.77223347  0.7858131   0.7999383 ]
NDCG_rating2: [ 0.589877    0.59292324  0.59933767  0.60851936  0.6187005   0.63180881
  0.64737483  0.6648429   0.68382438  0.70502542]
Iteration 23 [19.7 s]: loss = 0.507530 [74.92 s],
NDCG_rank: [ 0.73692497  0.7252522   0.72243358  0.72381019  0.72978171  0.73826659
  0.74929459  0.76177536  0.77597499  0.79120166]
NDCG_rating1: [ 0.75434654  0.73978116  0.73427202  0.73423591  0.73832293  0.74634642
  0.75652945  0.76884066  0.78233547  0.79691965]
NDCG_rating2: [ 0.59255405  0.59488314  0.60090245  0.61012592  0.62047703  0.6332888
  0.64880619  0.66610292  0.68526054  0.70601327]
Iteration 24 [19.8 s]: loss = 0.497613 [75.02 s],
NDCG_rank: [ 0.73638397  0.72336276  0.72084149  0.7225428   0.72823869  0.73676407
  0.74806492  0.76066764  0.7749325   0.79009248]
NDCG_rating1: [ 0.75050484  0.73599438  0.73075432  0.73045234  0.73582238  0.74372537
  0.75405002  0.76657399  0.78019588  0.7948948 ]
NDCG_rating2: [ 0.5982666   0.59979576  0.60526489  0.61436563  0.62486915  0.63746464
  0.65266166  0.66944628  0.68838786  0.70911031]
Iteration 25 [19.7 s]: loss = 0.487753 [74.60 s],
NDCG_rank: [ 0.7339184   0.72144254  0.71802689  0.72058291  0.72618574  0.73514835
  0.74606998  0.759055    0.77315391  0.78829654]
NDCG_rating1: [ 0.74046387  0.72800018  0.72266374  0.72328396  0.7295892   0.73779142
  0.7487307   0.76158863  0.77561749  0.79068278]
NDCG_rating2: [ 0.60059652  0.59915356  0.60489628  0.61418976  0.62452319  0.63697385
  0.65245476  0.66939201  0.68799124  0.70863476]
Iteration 26 [19.7 s]: loss = 0.477738 [75.03 s],
NDCG_rank: [ 0.73075178  0.71866297  0.7160887   0.71845318  0.72454721  0.73322942
  0.74434709  0.75727738  0.771692    0.78689982]
NDCG_rating1: [ 0.73372156  0.72146321  0.71722066  0.71924972  0.725631    0.73402848
  0.74499412  0.75805088  0.77231813  0.78773158]
NDCG_rating2: [ 0.60061853  0.60009162  0.60597069  0.61484594  0.62560098  0.63772724
  0.6529648   0.6700848   0.68876517  0.70961638]
Iteration 27 [19.8 s]: loss = 0.467685 [74.87 s],
NDCG_rank: [ 0.72503577  0.714818    0.71268991  0.71475512  0.72121768  0.73037001
  0.7416022   0.75462556  0.76885472  0.78463177]
NDCG_rating1: [ 0.72615043  0.71444291  0.71133763  0.71324392  0.72017473  0.72934685
  0.74054557  0.7539195   0.76851256  0.78394594]
NDCG_rating2: [ 0.60309403  0.6028795   0.60781173  0.61652864  0.62673426  0.63957302
  0.65408835  0.6711866   0.68984045  0.71036615]



liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.25,0.75,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.25,0.75,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.0 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [79.7], Init: NDCG = 
(array([ 0.55570458,  0.56125634,  0.57010183,  0.58039216,  0.59309618,
        0.60820782,  0.62463295,  0.64308897,  0.66350438,  0.68572631]), array([ 0.56858701,  0.56979104,  0.57683159,  0.58784378,  0.59972879,
        0.6146834 ,  0.63094666,  0.64923864,  0.66956631,  0.6911906 ]), array([ 0.56696734,  0.56916457,  0.57549822,  0.58448283,  0.59674625,
        0.61127438,  0.62742632,  0.64547654,  0.66557021,  0.68742905]))
Iteration 0 [25.5 s]: loss = 6.827742 [74.73 s],
NDCG_rank: [ 0.66929365  0.66839948  0.67173584  0.67760858  0.68593027  0.69708652
  0.70973056  0.72355775  0.73934714  0.75643055]
NDCG_rating1: [ 0.66484291  0.66191644  0.66175366  0.66770087  0.67544943  0.6857046
  0.69794826  0.71256927  0.72923498  0.74698468]
NDCG_rating2: [ 0.4110288   0.42399133  0.43919525  0.45598636  0.47421706  0.49484231
  0.51697231  0.54072134  0.56649301  0.59521778]
Iteration 1 [20.1 s]: loss = 1.068664 [75.68 s],
NDCG_rank: [ 0.7188439   0.7104922   0.711921    0.71618972  0.72324114  0.73320894
  0.74455988  0.75748039  0.77142018  0.78686199]
NDCG_rating1: [ 0.74159819  0.72959297  0.72533957  0.72705316  0.73253614  0.74066235
  0.75185208  0.76382783  0.77804296  0.79269939]
NDCG_rating2: [ 0.39393599  0.40945803  0.42633972  0.4446781   0.46449379  0.48562043
  0.50855676  0.53279373  0.559349    0.58837274]
Iteration 2 [20.0 s]: loss = 0.927885 [76.35 s],
NDCG_rank: [ 0.74103379  0.72996149  0.72957359  0.73213624  0.73815304  0.74719662
  0.7576112   0.77012283  0.78357348  0.7980096 ]
NDCG_rating1: [ 0.76409366  0.74768281  0.74331434  0.74379342  0.74846972  0.7568008
  0.76674458  0.77843269  0.79105549  0.80516371]
NDCG_rating2: [ 0.38573442  0.40373499  0.42289754  0.44207941  0.46198771  0.48370066
  0.50645722  0.53113749  0.55774445  0.58691127]
Iteration 3 [20.0 s]: loss = 0.896292 [78.22 s],
NDCG_rank: [ 0.75280094  0.7435199   0.74022056  0.74203535  0.74615848  0.75443875
  0.76464197  0.77618412  0.78950929  0.80356487]
NDCG_rating1: [ 0.77209682  0.75508663  0.7508683   0.75097611  0.75550682  0.76289974
  0.77247819  0.78327585  0.79586507  0.80974868]
NDCG_rating2: [ 0.38446538  0.40343786  0.42280995  0.44215443  0.46253067  0.48325782
  0.50606605  0.53095255  0.55742537  0.58661385]
Iteration 4 [20.1 s]: loss = 0.885662 [75.82 s],
NDCG_rank: [ 0.76060291  0.74976962  0.74472541  0.74590867  0.75060729  0.75804664
  0.7679101   0.77946434  0.79232569  0.80646246]
NDCG_rating1: [ 0.77411703  0.75767786  0.75259605  0.75245203  0.75691076  0.7645147
  0.77371247  0.78483737  0.79733008  0.8107334 ]
NDCG_rating2: [ 0.38522442  0.4045627   0.42384083  0.44269755  0.46275006  0.48358723
  0.50660518  0.53118082  0.55790171  0.58709681]
Iteration 5 [20.0 s]: loss = 0.880275 [75.34 s],
NDCG_rank: [ 0.76435401  0.75219958  0.74799986  0.74891128  0.75356276  0.76070003
  0.77012559  0.78155571  0.79410542  0.80790387]
NDCG_rating1: [ 0.77610647  0.7593053   0.75448623  0.75402037  0.75814101  0.7651075
  0.77436833  0.7854947   0.79791712  0.81144693]
NDCG_rating2: [ 0.38737731  0.40525661  0.42492557  0.44306289  0.46279043  0.48392263
  0.50697144  0.53137033  0.55816361  0.5873311 ]
Iteration 6 [20.0 s]: loss = 0.876867 [77.16 s],
NDCG_rank: [ 0.76549601  0.75367188  0.74934293  0.74992692  0.75419098  0.76099334
  0.77058087  0.78217511  0.79455213  0.8085546 ]
NDCG_rating1: [ 0.77712203  0.76059157  0.75501733  0.75456213  0.7588485   0.76555369
  0.77478352  0.78589341  0.79852801  0.81185599]
NDCG_rating2: [ 0.3868148   0.40543126  0.42439474  0.44304046  0.46265582  0.48373471
  0.50679321  0.5311576   0.55789075  0.58724349]
Iteration 7 [20.1 s]: loss = 0.874355 [77.18 s],
NDCG_rank: [ 0.76513258  0.75325603  0.74867945  0.74936212  0.75363825  0.76101007
  0.77050992  0.78181338  0.7946123   0.80853343]
NDCG_rating1: [ 0.77415036  0.75936283  0.75418303  0.75376839  0.75828518  0.76526362
  0.7744403   0.78544233  0.79784184  0.8114445 ]
NDCG_rating2: [ 0.38591719  0.40503216  0.42353062  0.4423897   0.46197127  0.4833546
  0.50642737  0.53090112  0.5577673   0.58693021]
Iteration 8 [19.8 s]: loss = 0.871994 [77.37 s],
NDCG_rank: [ 0.76788163  0.75540837  0.75001574  0.75026287  0.75497936  0.76224925
  0.77123155  0.78271334  0.79543151  0.80932682]
NDCG_rating1: [ 0.77548668  0.760042    0.75402472  0.75421546  0.75844051  0.76533691
  0.77471776  0.78558613  0.79830967  0.81179172]
NDCG_rating2: [ 0.38533361  0.40469832  0.42325921  0.44244082  0.46193179  0.48331811
  0.50629553  0.53101517  0.55771882  0.58676907]
Iteration 9 [20.0 s]: loss = 0.869761 [77.01 s],
NDCG_rank: [ 0.76745176  0.75446155  0.75071123  0.75066012  0.75532526  0.76244185
  0.77168294  0.78286935  0.79545229  0.80924304]
NDCG_rating1: [ 0.7746264   0.7598366   0.75380776  0.75355838  0.75770036  0.76541735
  0.7743606   0.78563067  0.79816147  0.8116794 ]
NDCG_rating2: [ 0.3864577   0.40523845  0.42357477  0.44241839  0.46224299  0.48389236
  0.50637085  0.53143984  0.55790969  0.58685784]
Iteration 10 [19.7 s]: loss = 0.867337 [78.31 s],
NDCG_rank: [ 0.76699301  0.75417597  0.74978323  0.75069064  0.75522043  0.76220514
  0.77124017  0.78298519  0.79550736  0.80928712]
NDCG_rating1: [ 0.77484651  0.76013886  0.75464303  0.75365766  0.75786437  0.7651308
  0.77442899  0.78554174  0.79805803  0.81146199]
NDCG_rating2: [ 0.38769718  0.40614613  0.42428837  0.44315126  0.4631708   0.48416603
  0.50668254  0.53142513  0.55834716  0.58753795]
Iteration 11 [20.2 s]: loss = 0.864456 [78.28 s],
NDCG_rank: [ 0.76685592  0.75459359  0.7507565   0.75064436  0.75519302  0.76241792
  0.77102841  0.78309781  0.79588571  0.8095856 ]
NDCG_rating1: [ 0.77445693  0.76040778  0.7545372   0.75423041  0.75850177  0.76528191
  0.77468476  0.78567064  0.79843769  0.81176541]
NDCG_rating2: [ 0.38851218  0.40755824  0.42546878  0.44439465  0.46413142  0.48502834
  0.50765744  0.53244342  0.55912744  0.5882225 ]
Iteration 12 [20.1 s]: loss = 0.860836 [77.89 s],
NDCG_rank: [ 0.76720148  0.75527319  0.75063335  0.75099892  0.75490101  0.76231866
  0.7716367   0.78279713  0.79552005  0.80936456]
NDCG_rating1: [ 0.77393906  0.75946677  0.75382138  0.75377645  0.75786876  0.76494026
  0.77449292  0.78539671  0.79797564  0.8113301 ]
NDCG_rating2: [ 0.39142002  0.41122315  0.42954191  0.44888848  0.46835109  0.4894245
  0.51184195  0.53619964  0.562629    0.59139987]
Iteration 13 [19.7 s]: loss = 0.855328 [77.49 s],
NDCG_rank: [ 0.76482821  0.753149    0.74949668  0.75040303  0.75434557  0.76178446
  0.77083983  0.78210908  0.79495258  0.80907297]
NDCG_rating1: [ 0.77499743  0.75948978  0.75424546  0.75370746  0.75805934  0.76502785
  0.77446588  0.78559741  0.79805458  0.81144132]
NDCG_rating2: [ 0.39551074  0.41473049  0.43290362  0.45207199  0.471454    0.49294314
  0.51540545  0.53941092  0.56585009  0.59443464]
Iteration 14 [19.9 s]: loss = 0.846750 [78.31 s],
NDCG_rank: [ 0.76517377  0.75355902  0.74940361  0.74973156  0.75412786  0.7611747
  0.7704148   0.78216992  0.79489944  0.80870231]
NDCG_rating1: [ 0.77432172  0.75918329  0.7545726   0.75396918  0.75825727  0.76507752
  0.77457133  0.78553909  0.79814924  0.81162406]
NDCG_rating2: [ 0.40336581  0.42248003  0.44079139  0.45933628  0.47915539  0.50041197
  0.52229784  0.54615178  0.57217124  0.60047177]
Iteration 15 [20.2 s]: loss = 0.834272 [78.47 s],
NDCG_rank: [ 0.76578093  0.75304051  0.7486954   0.74782571  0.75289505  0.76004051
  0.76958567  0.78161335  0.79434418  0.80788115]
NDCG_rating1: [ 0.77444781  0.75971874  0.75466322  0.75388075  0.75838152  0.76539948
  0.77472251  0.78568262  0.79806141  0.81170245]
NDCG_rating2: [ 0.41116459  0.4310065   0.44902725  0.46848594  0.48718938  0.50758444
  0.52942577  0.55299445  0.57856852  0.60612995]
Iteration 16 [19.8 s]: loss = 0.819770 [77.08 s],
NDCG_rank: [ 0.76335983  0.75154909  0.74707267  0.74716961  0.75191247  0.75936858
  0.76908578  0.7805115   0.79301515  0.80701729]
NDCG_rating1: [ 0.77401264  0.75982166  0.75395379  0.75405345  0.75822416  0.76497701
  0.77465722  0.78558164  0.79800453  0.81151264]
NDCG_rating2: [ 0.41748524  0.43719218  0.45537969  0.47420818  0.49334608  0.51340591
  0.53477907  0.55776426  0.58328962  0.61073532]
Iteration 17 [20.4 s]: loss = 0.805374 [76.79 s],
NDCG_rank: [ 0.7643682   0.75205672  0.74690148  0.7469422   0.75161025  0.75893145
  0.76848105  0.77987174  0.79305775  0.80668624]
NDCG_rating1: [ 0.77531752  0.76058927  0.75409508  0.75408909  0.75824012  0.76483798
  0.77475014  0.78562764  0.79766136  0.81133658]
NDCG_rating2: [ 0.42324118  0.44359549  0.46179408  0.48069218  0.49912527  0.51899409
  0.54023259  0.56337843  0.5883231   0.61515009]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.1,0.9,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.1,0.9,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [4.9 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [79.6], Init: NDCG = 
(array([ 0.55721748,  0.56470745,  0.57207369,  0.58293312,  0.59582795,
        0.61108135,  0.62806879,  0.64678254,  0.66707125,  0.68905858]), array([ 0.56160911,  0.56548747,  0.57408439,  0.58395523,  0.59567094,
        0.60999075,  0.62679919,  0.6448253 ,  0.66536456,  0.68765431]), array([ 0.56190413,  0.56860492,  0.57546246,  0.5855042 ,  0.59835107,
        0.61299183,  0.62963001,  0.6476606 ,  0.66781755,  0.68939946]))
Iteration 0 [24.4 s]: loss = 7.622239 [75.86 s],
NDCG_rank: [ 0.62396807  0.626896    0.63305306  0.6420292   0.65347059  0.66622093
  0.6799903   0.69524649  0.7118071   0.73046883]
NDCG_rating1: [ 0.6718899   0.6677176   0.66686834  0.67225522  0.67966591  0.68966493
  0.70168663  0.71595307  0.73216019  0.74998234]
NDCG_rating2: [ 0.72166209  0.71651725  0.71611582  0.71803572  0.7249884   0.73374162
  0.74454866  0.75693565  0.7709971   0.78630928]
Iteration 1 [19.7 s]: loss = 1.136624 [74.05 s],
NDCG_rank: [ 0.67839795  0.67787857  0.68110293  0.68950667  0.70017768  0.71173199
  0.72449018  0.73840027  0.75347791  0.76995409]
NDCG_rating1: [ 0.747666    0.73391445  0.72933861  0.72973455  0.73518152  0.74290647
  0.7532946   0.76582606  0.77966498  0.79460372]
NDCG_rating2: [ 0.73443985  0.7283666   0.72610198  0.72726705  0.73296668  0.74139135
  0.7516428   0.76375977  0.77777453  0.79245863]
Iteration 2 [19.5 s]: loss = 0.981779 [74.37 s],
NDCG_rank: [ 0.7257264   0.71752166  0.71764342  0.72234778  0.72938988  0.73888953
  0.74999539  0.76210057  0.77596334  0.79084703]
NDCG_rating1: [ 0.76079467  0.74675685  0.74379332  0.74378312  0.74896208  0.75639527
  0.76645927  0.7783841   0.79111596  0.80516733]
NDCG_rating2: [ 0.74147112  0.73233535  0.72886197  0.72941911  0.73453799  0.74298976
  0.7534117   0.76545989  0.77923336  0.79381252]
Iteration 3 [19.8 s]: loss = 0.948461 [74.67 s],
NDCG_rank: [ 0.74675734  0.73686799  0.73511568  0.73799283  0.74353664  0.75151914
  0.76162495  0.77382357  0.78691861  0.80121315]
NDCG_rating1: [ 0.76859125  0.75418987  0.74992929  0.75031077  0.75454783  0.76228144
  0.77178722  0.78278843  0.79559562  0.80920012]
NDCG_rating2: [ 0.74118593  0.73133884  0.72753567  0.72940946  0.73459388  0.74277161
  0.75334488  0.76561694  0.7794639   0.79393447]
Iteration 4 [20.4 s]: loss = 0.937237 [82.53 s],
NDCG_rank: [ 0.76255076  0.75085849  0.74478334  0.74536791  0.75026667  0.75735397
  0.76725107  0.77902917  0.79212713  0.80596962]
NDCG_rating1: [ 0.77434908  0.7593535   0.7541683   0.7531084   0.75701841  0.76451794
  0.77375784  0.78489507  0.79745997  0.8110376 ]
NDCG_rating2: [ 0.73872898  0.73015081  0.72681879  0.72886511  0.73452391  0.74234897
  0.75308549  0.76564377  0.77930019  0.7938899 ]
Iteration 5 [20.4 s]: loss = 0.931688 [82.84 s],
NDCG_rank: [ 0.76277122  0.75259051  0.74792986  0.74802976  0.75265351  0.75960544
  0.76918698  0.78099796  0.79364844  0.8076533 ]
NDCG_rating1: [ 0.77474966  0.75989751  0.75421736  0.75367579  0.75786343  0.76455862
  0.7739639   0.78558508  0.79771311  0.81132055]
NDCG_rating2: [ 0.73651477  0.7282263   0.72609742  0.72846369  0.73382478  0.74237144
  0.75307111  0.76520264  0.77912174  0.79354618]
Iteration 6 [20.2 s]: loss = 0.928178 [83.45 s],
NDCG_rank: [ 0.76590603  0.7548372   0.74917179  0.74954719  0.7537629   0.76100218
  0.77053073  0.78198484  0.79495933  0.80863263]
NDCG_rating1: [ 0.77498077  0.76010306  0.75357793  0.75324743  0.75756186  0.76490681
  0.77413555  0.78553764  0.79788663  0.81132692]
NDCG_rating2: [ 0.73622204  0.72860128  0.72581994  0.72827233  0.73430016  0.74257735
  0.75315856  0.76528334  0.77928345  0.79369428]
Iteration 7 [20.3 s]: loss = 0.925670 [83.24 s],
NDCG_rank: [ 0.76562026  0.75367423  0.74927859  0.74934985  0.75380773  0.76150076
  0.77091807  0.78212788  0.79495985  0.80857154]
NDCG_rating1: [ 0.77433587  0.75999469  0.75378908  0.75345066  0.75763909  0.76467543
  0.77419086  0.78545333  0.7980613   0.81159397]
NDCG_rating2: [ 0.73334313  0.72692811  0.72474291  0.72721397  0.73341029  0.74207378
  0.75276785  0.76514826  0.77889164  0.79336447]
Iteration 8 [20.3 s]: loss = 0.923393 [83.48 s],
NDCG_rank: [ 0.76679905  0.754617    0.75019679  0.75002239  0.75452161  0.76192146
  0.77137055  0.78238102  0.79510324  0.8088503 ]
NDCG_rating1: [ 0.77333316  0.75954692  0.75397144  0.75328331  0.75746073  0.76477617
  0.77408235  0.7851337   0.7978468   0.81114599]
NDCG_rating2: [ 0.73276238  0.72652251  0.72476039  0.72741383  0.73343137  0.74206391
  0.75281795  0.76521471  0.77893172  0.79346083]
Iteration 9 [20.3 s]: loss = 0.921556 [83.83 s],
NDCG_rank: [ 0.76638086  0.75497929  0.75053161  0.75045998  0.75469789  0.76235934
  0.77139435  0.78289166  0.79542457  0.8092883 ]
NDCG_rating1: [ 0.77457327  0.76021846  0.75439853  0.75362464  0.75760927  0.76483818
  0.77431578  0.78537493  0.79786471  0.81149927]
NDCG_rating2: [ 0.73227627  0.72652091  0.72500255  0.72712464  0.7333035   0.74210614
  0.75272853  0.7653473   0.77925252  0.79354641]
Iteration 10 [20.3 s]: loss = 0.919794 [83.14 s],
NDCG_rank: [ 0.77019646  0.75697303  0.75160914  0.75125664  0.75589467  0.76293787
  0.77214165  0.78345222  0.79615577  0.80994525]
NDCG_rating1: [ 0.77483775  0.76085059  0.75444752  0.75389745  0.75791181  0.76515651
  0.77495276  0.78551985  0.79818181  0.81167542]
NDCG_rating2: [ 0.73200492  0.72666669  0.72413934  0.72681663  0.7329472   0.74172633
  0.75222941  0.76473786  0.77876263  0.79293304]
Iteration 11 [20.4 s]: loss = 0.918062 [84.50 s],
NDCG_rank: [ 0.76921665  0.75580552  0.75144166  0.75180169  0.75608226  0.76282915
  0.77186051  0.7831785   0.79617034  0.80981182]
NDCG_rating1: [ 0.77499334  0.76054113  0.75515138  0.75410851  0.75847672  0.76518228
  0.7746371   0.78574918  0.79828804  0.81160898]
NDCG_rating2: [ 0.7302853   0.72390923  0.72200274  0.72442657  0.73116808  0.7395777
  0.75040451  0.76276058  0.77670776  0.79153667]
Iteration 12 [21.0 s]: loss = 0.916409 [84.66 s],
NDCG_rank: [ 0.76858092  0.75594043  0.75085764  0.75139846  0.75550492  0.76278367
  0.77204728  0.78279796  0.79577512  0.80958484]
NDCG_rating1: [ 0.77473048  0.76008749  0.75474524  0.75419753  0.75846664  0.76540059
  0.77474839  0.78585734  0.79832171  0.81149594]
NDCG_rating2: [ 0.7274677   0.72015008  0.71888634  0.72146119  0.72763369  0.73597229
  0.74718033  0.75951973  0.77367161  0.78881289]
Iteration 13 [21.0 s]: loss = 0.914655 [84.81 s],
NDCG_rank: [ 0.76859381  0.75545098  0.75068476  0.75052289  0.75505082  0.76193646
  0.77155894  0.7823864   0.79567058  0.80945504]
NDCG_rating1: [ 0.77457201  0.75960913  0.75431445  0.75402161  0.75808672  0.76553263
  0.77463852  0.78578015  0.79821996  0.81170556]
NDCG_rating2: [ 0.7246418   0.71701639  0.71539711  0.71818299  0.72475401  0.73330037
  0.74441417  0.75683066  0.77115085  0.78623078]
Iteration 14 [21.2 s]: loss = 0.913033 [84.60 s],
NDCG_rank: [ 0.76905378  0.75467517  0.74977556  0.75124682  0.75524838  0.76201636
  0.77131152  0.78271218  0.79569844  0.80936801]
NDCG_rating1: [ 0.77607624  0.75997372  0.75416553  0.75461137  0.75858822  0.76604424
  0.77507737  0.78595807  0.79855339  0.81191666]
NDCG_rating2: [ 0.71912339  0.71205904  0.71060379  0.71366095  0.71983956  0.72909147
  0.74047857  0.75348611  0.76779552  0.78290979]
Iteration 15 [20.9 s]: loss = 0.911230 [84.51 s],
NDCG_rank: [ 0.76696062  0.75381811  0.74892969  0.74953462  0.75428802  0.76204804
  0.7709843   0.78199997  0.7948334   0.80880852]
NDCG_rating1: [ 0.77473614  0.76052198  0.75437625  0.75441275  0.75858017  0.76590737
  0.77480319  0.78585968  0.79834254  0.811846  ]
NDCG_rating2: [ 0.71590633  0.70777017  0.70644873  0.70966151  0.71633633  0.72541206
  0.7372208   0.75002092  0.76489867  0.78031365]
Iteration 16 [20.8 s]: loss = 0.909433 [84.84 s],
NDCG_rank: [ 0.76699054  0.75408046  0.75031102  0.74980635  0.75397869  0.76172827
  0.77084743  0.78222766  0.79508648  0.80914819]
NDCG_rating1: [ 0.77397459  0.75916343  0.7540123   0.7536097   0.75783139  0.76498493
  0.77442878  0.78550242  0.79805019  0.81152743]
NDCG_rating2: [ 0.71002084  0.70374657  0.70223246  0.70628732  0.7134293   0.72320399
  0.73416991  0.74738014  0.76245327  0.77809785]
Iteration 17 [21.1 s]: loss = 0.907333 [81.56 s],
NDCG_rank: [ 0.76826052  0.75311495  0.7494057   0.74992229  0.7539878   0.7614417
  0.77054142  0.78164821  0.79447164  0.80860355]
NDCG_rating1: [ 0.77407395  0.75994321  0.75427651  0.7535971   0.75809383  0.76542505
  0.7744874   0.78565654  0.79806276  0.81162822]
NDCG_rating2: [ 0.706805    0.70180345  0.69997747  0.70378977  0.71103523  0.72011262
  0.73159469  0.7452037   0.76027798  0.77625626]
Iteration 18 [20.1 s]: loss = 0.905032 [80.69 s],
NDCG_rank: [ 0.76935253  0.75395608  0.74910774  0.7495636   0.75383722  0.76158053
  0.77082476  0.78203125  0.79488164  0.8088884 ]
NDCG_rating1: [ 0.77595581  0.76029327  0.75417037  0.75356934  0.75828296  0.76546071
  0.77492712  0.78584861  0.79833111  0.81179808]
NDCG_rating2: [ 0.70339847  0.6972722   0.69570994  0.6999726   0.70760633  0.71668121
  0.72820805  0.74161228  0.75679079  0.77319576]
Iteration 19 [20.2 s]: loss = 0.901948 [77.34 s],
NDCG_rank: [ 0.76702544  0.75340394  0.74855113  0.74845066  0.75359959  0.76087656
  0.7702997   0.78169921  0.79425991  0.8082916 ]
NDCG_rating1: [ 0.77618943  0.76049617  0.75474574  0.75393725  0.75858968  0.76567341
  0.77489969  0.7860972   0.79848533  0.81194404]
NDCG_rating2: [ 0.7000432   0.69240385  0.69222784  0.69589587  0.70330903  0.71284563
  0.72468393  0.73836128  0.75385155  0.77018958]
Iteration 20 [19.9 s]: loss = 0.897715 [76.73 s],
NDCG_rank: [ 0.7663491   0.75231091  0.74789807  0.74829521  0.75297037  0.76063135
  0.77010552  0.78126699  0.79371255  0.80798001]
NDCG_rating1: [ 0.77617906  0.76028143  0.75443308  0.75409911  0.75840585  0.76557582
  0.77508047  0.7859328   0.79851585  0.81183753]
NDCG_rating2: [ 0.69657617  0.69016693  0.68960966  0.69345066  0.70099343  0.71035242
  0.72251141  0.73668938  0.75182636  0.76836539]
Iteration 21 [21.1 s]: loss = 0.891718 [84.39 s],
NDCG_rank: [ 0.76407044  0.751121    0.74733917  0.74789433  0.75198573  0.75903827
  0.76898089  0.78030497  0.79298799  0.80711953]
NDCG_rating1: [ 0.77707109  0.76079723  0.75467546  0.754046    0.75859789  0.7657383
  0.77488481  0.78602277  0.79836304  0.81202515]
NDCG_rating2: [ 0.69187465  0.68538357  0.68561546  0.68989909  0.69711407  0.70694697
  0.71899134  0.73309456  0.74875312  0.76563749]
Iteration 22 [21.1 s]: loss = 0.883491 [85.06 s],
NDCG_rank: [ 0.76281555  0.7492032   0.74578977  0.74645999  0.75097282  0.75827194
  0.76788823  0.77933505  0.79238184  0.8067969 ]
NDCG_rating1: [ 0.7768306   0.75997124  0.75434442  0.75386547  0.75868713  0.7656726
  0.77468647  0.78586564  0.79815201  0.81175628]
NDCG_rating2: [ 0.68835178  0.68193047  0.68253542  0.68673381  0.69447966  0.70463396
  0.71664297  0.73065079  0.74666312  0.76353534]
Iteration 23 [20.9 s]: loss = 0.873271 [77.44 s],
NDCG_rank: [ 0.76466188  0.75086734  0.74618104  0.74639287  0.7506441   0.75790605
  0.76773792  0.77939899  0.79218238  0.80639766]
NDCG_rating1: [ 0.77676583  0.76064518  0.75466442  0.75463059  0.75864346  0.76592498
  0.77516526  0.78600147  0.79827257  0.8119743 ]
NDCG_rating2: [ 0.68613722  0.68017149  0.68018465  0.68467835  0.69236266  0.70222392
  0.71467333  0.72876739  0.74473066  0.76167542]
Iteration 24 [19.8 s]: loss = 0.861945 [72.95 s],
NDCG_rank: [ 0.7603303   0.74971792  0.74468413  0.74501218  0.74942299  0.75670812
  0.76651967  0.77822439  0.79134439  0.80570793]
NDCG_rating1: [ 0.77642939  0.760444    0.7546777   0.75456159  0.75838442  0.76558391
  0.7750388   0.78588347  0.7981398   0.81186344]
NDCG_rating2: [ 0.68173521  0.67576395  0.67693084  0.68155802  0.68888399  0.69917224
  0.71186413  0.72604292  0.74197528  0.75921191]
Iteration 25 [19.6 s]: loss = 0.850399 [73.13 s],
NDCG_rank: [ 0.75904963  0.74758526  0.743487    0.74378741  0.74798253  0.7556175
  0.76585699  0.77730896  0.79048383  0.8046527 ]
NDCG_rating1: [ 0.77623413  0.76021412  0.75421497  0.75386375  0.7581518   0.76540127
  0.77485364  0.78562285  0.79817164  0.8117264 ]
NDCG_rating2: [ 0.68048567  0.67417397  0.67612833  0.67986858  0.68834622  0.69860098
  0.7111346   0.72547744  0.74147509  0.75874595]
Iteration 26 [19.8 s]: loss = 0.839279 [73.19 s],
NDCG_rank: [ 0.76137075  0.74869272  0.74329826  0.74392366  0.74792269  0.75511103
  0.76511649  0.7766405   0.79004496  0.80453111]
NDCG_rating1: [ 0.77541126  0.76011312  0.7542396   0.75387235  0.75736292  0.76453718
  0.77405793  0.78514678  0.79774301  0.81116053]
NDCG_rating2: [ 0.67694394  0.67227255  0.67405925  0.67863223  0.68565292  0.69620543
  0.70947417  0.72376646  0.73987818  0.75730503]
Iteration 27 [19.6 s]: loss = 0.828934 [73.04 s],
NDCG_rank: [ 0.75812773  0.74651711  0.74129154  0.74190951  0.74651345  0.75369561
  0.76366212  0.77548608  0.78862269  0.80292061]
NDCG_rating1: [ 0.77563137  0.76015146  0.75368732  0.75355998  0.75699879  0.76399341
  0.77371859  0.78455915  0.79734592  0.81085421]
NDCG_rating2: [ 0.67630187  0.67143072  0.67295322  0.67699795  0.68424374  0.69507941
  0.70812593  0.72265796  0.73851304  0.75613665]
Iteration 28 [19.5 s]: loss = 0.819487 [72.90 s],
NDCG_rank: [ 0.75744793  0.74499979  0.74000233  0.7406858   0.74509049  0.75282468
  0.76293388  0.77502184  0.78827049  0.80276231]
NDCG_rating1: [ 0.77315492  0.75844964  0.75242306  0.75262957  0.7560861   0.76272141
  0.77230148  0.7837369   0.79640041  0.80970071]
NDCG_rating2: [ 0.67199545  0.66692372  0.66928484  0.6736876   0.68185536  0.69260076
  0.70543729  0.72015038  0.73607169  0.75398862]
Iteration 29 [19.6 s]: loss = 0.810139 [73.46 s],
NDCG_rank: [ 0.75609211  0.74365611  0.73894356  0.7401006   0.7437677   0.75148325
  0.76151648  0.77326502  0.78659472  0.80112319]
NDCG_rating1: [ 0.77302758  0.7571211   0.75134374  0.75173357  0.75492039  0.76187014
  0.77113843  0.78249073  0.79511683  0.80880862]
NDCG_rating2: [ 0.66830594  0.66453163  0.66569221  0.67101627  0.67888893  0.68965387
  0.70283738  0.71772609  0.73414276  0.75205364]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.9,0.1,0] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.9,0.1,0]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [4.9 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [76.6], Init: NDCG = 
(array([ 0.55864512,  0.56383331,  0.57278133,  0.58334771,  0.59560587,
        0.61019658,  0.62704325,  0.64525839,  0.66559712,  0.68809604]), array([ 0.56115606,  0.56596982,  0.5733304 ,  0.5832088 ,  0.59574753,
        0.61055355,  0.62698341,  0.6454108 ,  0.66547043,  0.68809098]), array([ 0.55152231,  0.55836006,  0.56646487,  0.57782757,  0.59052328,
        0.6055527 ,  0.62264989,  0.64154889,  0.66232269,  0.68447731]))
Iteration 0 [24.4 s]: loss = 1.314306 [73.76 s],
NDCG_rank: [ 0.67152076  0.67014279  0.67489821  0.68239887  0.69235674  0.70382334
  0.71685844  0.73094601  0.7463478   0.76322254]
NDCG_rating1: [ 0.69583493  0.6883099   0.68750536  0.69129713  0.69839874  0.70735049
  0.71919656  0.73284325  0.74822527  0.76513058]
NDCG_rating2: [ 0.72929207  0.71933441  0.71752084  0.72051332  0.72642474  0.73536052
  0.7452321   0.7582728   0.77215331  0.78733932]
Iteration 1 [20.1 s]: loss = 0.706759 [72.93 s],
NDCG_rank: [ 0.72170579  0.71404288  0.71423643  0.71861744  0.72645046  0.73560089
  0.7473779   0.76052415  0.77404289  0.78906423]
NDCG_rating1: [ 0.75395049  0.73964691  0.73606079  0.73694945  0.74247605  0.75062716
  0.76127038  0.77321154  0.78637933  0.80064706]
NDCG_rating2: [ 0.7406244   0.73031972  0.72728888  0.72888602  0.73387711  0.7421429
  0.75248205  0.76476329  0.77845678  0.7932272 ]
Iteration 2 [20.4 s]: loss = 0.682647 [80.63 s],
NDCG_rank: [ 0.7529538   0.74104723  0.73731809  0.73983279  0.74569425  0.75365446
  0.76381137  0.77538694  0.78864729  0.80256517]
NDCG_rating1: [ 0.76486433  0.75053604  0.74690683  0.74817273  0.75305099  0.76030086
  0.76997313  0.78127649  0.79410232  0.80785834]
NDCG_rating2: [ 0.7413259   0.7320132   0.72944375  0.73004307  0.73508949  0.74341586
  0.75391652  0.7658217   0.77941032  0.79418286]
Iteration 3 [20.7 s]: loss = 0.669330 [81.19 s],
NDCG_rank: [ 0.76230838  0.75076635  0.74678275  0.7472457   0.75234461  0.75979668
  0.76989177  0.78116023  0.79389313  0.80768616]
NDCG_rating1: [ 0.77024609  0.75513499  0.7507553   0.75080887  0.75501292  0.76300578
  0.7723773   0.78360787  0.79637325  0.80987011]
NDCG_rating2: [ 0.74198966  0.73165189  0.72878238  0.73011061  0.73549507  0.74361619
  0.75413341  0.76631386  0.77995765  0.79437795]
Iteration 4 [20.8 s]: loss = 0.658359 [80.89 s],
NDCG_rank: [ 0.76621579  0.75435706  0.74918844  0.74943587  0.75355027  0.76138357
  0.77106668  0.78241218  0.79514075  0.80873196]
NDCG_rating1: [ 0.77154657  0.75705033  0.75227057  0.75167171  0.75604074  0.76335203
  0.77293964  0.78437027  0.79701618  0.81034141]
NDCG_rating2: [ 0.73960188  0.73012117  0.72816462  0.72970138  0.73535017  0.74362823
  0.75405578  0.76626986  0.78005073  0.79474425]
Iteration 5 [20.8 s]: loss = 0.651259 [81.55 s],
NDCG_rank: [ 0.76523571  0.75261245  0.74829038  0.74826937  0.75296525  0.76057964
  0.77027401  0.78158014  0.79412137  0.80789631]
NDCG_rating1: [ 0.76952228  0.75650878  0.75102147  0.74999026  0.75483198  0.76246054
  0.77212209  0.7835446   0.79618469  0.80948657]
NDCG_rating2: [ 0.73754736  0.72911926  0.72700948  0.72903522  0.73467391  0.74327113
  0.7537716   0.76598462  0.77954428  0.79435077]
Iteration 6 [20.6 s]: loss = 0.645257 [80.71 s],
NDCG_rank: [ 0.76115033  0.75142653  0.74623269  0.74710147  0.75133691  0.75920258
  0.76866441  0.78010672  0.79307005  0.80703228]
NDCG_rating1: [ 0.76793315  0.75534325  0.7499411   0.74936866  0.75424181  0.76231187
  0.77198657  0.78315167  0.79565597  0.80912492]
NDCG_rating2: [ 0.73472351  0.72823723  0.72541732  0.72773972  0.73399344  0.74237939
  0.75317936  0.76495004  0.77888139  0.79370234]
Iteration 7 [20.8 s]: loss = 0.638571 [82.67 s],
NDCG_rank: [ 0.76009951  0.75031374  0.74553864  0.74576974  0.75016407  0.75817628
  0.76822707  0.77955884  0.79222518  0.80627058]
NDCG_rating1: [ 0.76959208  0.75565458  0.75060152  0.74988318  0.75475701  0.76247773
  0.77218069  0.78319256  0.7956877   0.80940633]
NDCG_rating2: [ 0.73318281  0.72572865  0.72283631  0.724846    0.73091761  0.73944085
  0.75033187  0.7625441   0.77666172  0.79160265]
Iteration 8 [20.7 s]: loss = 0.630952 [80.78 s],
NDCG_rank: [ 0.75880878  0.74680246  0.74273643  0.74399774  0.74906562  0.75689517
  0.76695027  0.77864118  0.7914132   0.80534282]
NDCG_rating1: [ 0.76659274  0.75457142  0.74971409  0.7500982   0.75437359  0.76216385
  0.77168484  0.78299548  0.79565918  0.80933406]
NDCG_rating2: [ 0.72710741  0.7169288   0.71438309  0.71650045  0.72239127  0.73139974
  0.7425594   0.75500525  0.76932256  0.78474734]
Iteration 9 [20.8 s]: loss = 0.622132 [80.87 s],
NDCG_rank: [ 0.75488596  0.74455517  0.74073394  0.74139404  0.74716341  0.75518213
  0.76539715  0.77733322  0.79038595  0.80435747]
NDCG_rating1: [ 0.7672106   0.75567444  0.75012628  0.75036271  0.75487037  0.76259748
  0.77211623  0.78328164  0.79588335  0.80949184]
NDCG_rating2: [ 0.71409791  0.70617949  0.70233883  0.70419643  0.71120465  0.72107265
  0.73216628  0.74518388  0.75993215  0.77580319]
Iteration 10 [21.0 s]: loss = 0.611575 [80.26 s],
NDCG_rank: [ 0.75376943  0.74412404  0.74006998  0.74097552  0.74659831  0.75448802
  0.76467895  0.77665137  0.78954786  0.8035657 ]
NDCG_rating1: [ 0.77025427  0.75680553  0.75113456  0.75097091  0.75560746  0.76326296
  0.77262827  0.78378621  0.79649282  0.81012624]
NDCG_rating2: [ 0.70069429  0.69113057  0.68864761  0.69220428  0.69928412  0.70841074
  0.72041527  0.73406454  0.74962776  0.76629463]
Iteration 11 [20.6 s]: loss = 0.599169 [80.37 s],
NDCG_rank: [ 0.75407222  0.7430838   0.73980813  0.74034841  0.74565424  0.75347672
  0.76362456  0.77557012  0.78898529  0.80314002]
NDCG_rating1: [ 0.77318506  0.75925465  0.75272848  0.75199656  0.75680389  0.76396924
  0.77303136  0.78457344  0.79721691  0.81076888]
NDCG_rating2: [ 0.68570892  0.67782529  0.67608817  0.68066215  0.68825427  0.69809234
  0.71067438  0.72497036  0.74073227  0.7583788 ]
Iteration 12 [20.3 s]: loss = 0.585432 [80.48 s],
NDCG_rank: [ 0.74985353  0.73981873  0.73710447  0.73846742  0.7437705   0.75166109
  0.76222189  0.77415527  0.78730391  0.8019674 ]
NDCG_rating1: [ 0.77517257  0.75941558  0.75362055  0.75271582  0.75680345  0.76424113
  0.77328387  0.78489705  0.79735575  0.81104316]
NDCG_rating2: [ 0.67356032  0.665946    0.66589003  0.66997245  0.67808226  0.68872463
  0.70187707  0.71684377  0.73325388  0.75145929]
Iteration 13 [20.4 s]: loss = 0.571150 [80.19 s],
NDCG_rank: [ 0.75029781  0.73999416  0.73707227  0.73797984  0.74318111  0.75120807
  0.76130353  0.77360015  0.78712218  0.80126333]
NDCG_rating1: [ 0.77434153  0.75966309  0.75398869  0.75316592  0.75693899  0.76391442
  0.77328605  0.78489553  0.79743917  0.81097158]
NDCG_rating2: [ 0.65984618  0.65396094  0.65470519  0.65985182  0.66895402  0.68009184
  0.69330385  0.70871917  0.72599416  0.74451711]
Iteration 14 [20.5 s]: loss = 0.557387 [80.84 s],
NDCG_rank: [ 0.74894483  0.7391857   0.73536601  0.73727331  0.74258053  0.75041513
  0.76074548  0.77310369  0.78629897  0.80074874]
NDCG_rating1: [ 0.77514364  0.75947429  0.7533835   0.75276521  0.75634518  0.76355919
  0.77315471  0.78451311  0.79725532  0.81085352]
NDCG_rating2: [ 0.64483264  0.63916173  0.64094173  0.64750751  0.65755419  0.66926169
  0.68328145  0.69947629  0.71684483  0.73591683]
Iteration 15 [20.4 s]: loss = 0.544229 [80.32 s],
NDCG_rank: [ 0.74765441  0.73728086  0.73360369  0.73568983  0.74073148  0.74863278
  0.75939201  0.77166227  0.78530161  0.79963778]
NDCG_rating1: [ 0.77511898  0.75894705  0.75308074  0.75205304  0.75602499  0.7632335
  0.77290936  0.78420312  0.79690753  0.81023488]
NDCG_rating2: [ 0.63185238  0.62804222  0.63142742  0.63912737  0.64919172  0.66140166
  0.67595033  0.69248225  0.71038893  0.72974996]
Iteration 16 [20.3 s]: loss = 0.531621 [80.83 s],
NDCG_rank: [ 0.74539052  0.73467547  0.7319897   0.73403621  0.73952325  0.7476459
  0.75820421  0.77030196  0.78388962  0.79873154]
NDCG_rating1: [ 0.77404431  0.7574341   0.75212855  0.75136211  0.75517345  0.7625737
  0.77210616  0.78380733  0.79614535  0.80981097]
NDCG_rating2: [ 0.62130423  0.6208139   0.62479285  0.63300695  0.64364417  0.65644572
  0.67124284  0.68800977  0.70581394  0.72557309]
Iteration 17 [20.4 s]: loss = 0.519919 [80.47 s],
NDCG_rank: [ 0.74542165  0.73373602  0.73110192  0.73296964  0.73808729  0.74657794
  0.75709744  0.76919543  0.78308196  0.79759167]
NDCG_rating1: [ 0.77240299  0.75657194  0.75081878  0.75023697  0.75431348  0.76161523
  0.77107181  0.78272886  0.79528092  0.80908095]
NDCG_rating2: [ 0.61435189  0.61300992  0.61835354  0.62637063  0.63779903  0.65091842
  0.66602482  0.68272304  0.70109207  0.72112887]
Iteration 18 [20.4 s]: loss = 0.508769 [80.29 s],
NDCG_rank: [ 0.74470852  0.73290374  0.73010811  0.73141904  0.73650635  0.74456934
  0.75587729  0.76769439  0.78179037  0.7964644 ]
NDCG_rating1: [ 0.77240645  0.75524071  0.7497853   0.74951863  0.75376719  0.76099679
  0.77063386  0.78200321  0.79463317  0.80845513]
NDCG_rating2: [ 0.60607261  0.60590545  0.61195496  0.62068761  0.63226321  0.6457947
  0.6607433   0.67797589  0.69684428  0.71695119]
Iteration 19 [20.3 s]: loss = 0.498305 [80.24 s],
NDCG_rank: [ 0.73977037  0.73065387  0.72755482  0.72913859  0.73468914  0.74314384
  0.7538505   0.7662301   0.78010757  0.79514383]
NDCG_rating1: [ 0.76878297  0.75309406  0.74796611  0.74781671  0.75199366  0.7595052
  0.76882704  0.78050071  0.79326154  0.80710476]
NDCG_rating2: [ 0.59979692  0.60350399  0.60927214  0.61878822  0.63015364  0.64362783
  0.6591219   0.67655404  0.69520006  0.71552488]
Iteration 20 [20.3 s]: loss = 0.488670 [80.16 s],
NDCG_rank: [ 0.73981129  0.72906552  0.72584407  0.72784061  0.73265141  0.74095953
  0.75205876  0.76473792  0.77860767  0.79353667]
NDCG_rating1: [ 0.7675765   0.75229477  0.74666512  0.74568519  0.75087439  0.75818074
  0.76762583  0.77919725  0.79196845  0.80611851]
NDCG_rating2: [ 0.59440195  0.59955441  0.60462225  0.61418667  0.62636115  0.64019284
  0.65586459  0.67352237  0.69259449  0.71291934]
Iteration 21 [20.3 s]: loss = 0.479627 [79.23 s],
NDCG_rank: [ 0.73355191  0.72560219  0.7229478   0.72515538  0.7304498   0.73904577
  0.7501321   0.76275101  0.7766256   0.79180762]
NDCG_rating1: [ 0.76678414  0.7507571   0.74608737  0.74552568  0.7502087   0.75787077
  0.76749817  0.7787671   0.7915486   0.80557139]
NDCG_rating2: [ 0.59230565  0.59656024  0.60410264  0.61355147  0.62530776  0.63940511
  0.65536314  0.67287476  0.69219724  0.71263096]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v5.03_3loss/MLP.py --learner adam --batch_size_random 323348 --reg_layers [0,0,0,0] --loss_weights [0.8,0.1,0.1] --lr 0.0001
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=323348, epochs=100, layers='[64,32,16,8]', learner='adam', loss_weights='[0.8,0.1,0.1]', lr=0.0001, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [5.0 s]. #user=13679, #item=12922, #train=323348, #test=316795
Time: [81.8], Init: NDCG = 
(array([ 0.55006058,  0.55883846,  0.56671426,  0.57762355,  0.5903597 ,
        0.60567987,  0.62300951,  0.64178679,  0.66188338,  0.68482273]), array([ 0.56163404,  0.56737925,  0.57571314,  0.58518376,  0.59804214,
        0.61280811,  0.62918888,  0.64753995,  0.66764874,  0.68980831]), array([ 0.55867463,  0.56329999,  0.57081355,  0.58142215,  0.59416166,
        0.60902987,  0.62607951,  0.64504387,  0.66540713,  0.68745402]))
Iteration 0 [25.9 s]: loss = 1.328461 [81.68 s],
NDCG_rank: [ 0.55034999  0.55138935  0.55879372  0.56759289  0.57941493  0.59390207
  0.61068087  0.62916902  0.64997236  0.67237739]
NDCG_rating1: [ 0.68767388  0.68160027  0.68086265  0.68423663  0.69135028  0.70011405
  0.71207168  0.72575065  0.74093212  0.75826965]
NDCG_rating2: [ 0.41529426  0.43342459  0.44962698  0.46715168  0.48562039  0.50486722
  0.52632011  0.54961707  0.57503508  0.60313708]
Iteration 1 [20.7 s]: loss = 0.665335 [79.75 s],
NDCG_rank: [ 0.6767038   0.67749     0.68264674  0.6904844   0.70024722  0.71150385
  0.72421876  0.73758491  0.75264796  0.76928439]
NDCG_rating1: [ 0.75324271  0.7378683   0.73367897  0.73488928  0.73977425  0.74775457
  0.75840635  0.77047985  0.78415709  0.79851529]
NDCG_rating2: [ 0.38537036  0.40754841  0.42630338  0.44512679  0.46430327  0.4856647
  0.50847433  0.53285611  0.55943178  0.58815607]
Iteration 2 [20.3 s]: loss = 0.639027 [80.15 s],
NDCG_rank: [ 0.74601466  0.73747397  0.7348403   0.73696322  0.74296138  0.75134397
  0.76209988  0.7740355   0.78712139  0.80156805]
NDCG_rating1: [ 0.76367709  0.75069931  0.7463002   0.74748691  0.75208235  0.75954009
  0.76938736  0.78083833  0.79355287  0.80745177]
NDCG_rating2: [ 0.38326772  0.40351968  0.42234208  0.44130544  0.4615628   0.48280203
  0.50574427  0.53054095  0.55731046  0.58644754]
Iteration 3 [20.1 s]: loss = 0.621701 [80.29 s],
NDCG_rank: [ 0.76427261  0.75125839  0.74752831  0.7484755   0.75256789  0.76007497
  0.76997983  0.78136243  0.79426898  0.80794553]
NDCG_rating1: [ 0.77238453  0.75623783  0.75141966  0.75145097  0.75560274  0.76287791
  0.7726255   0.78411437  0.79629666  0.80979971]
NDCG_rating2: [ 0.37970304  0.40094903  0.42038528  0.43930913  0.45982605  0.48110762
  0.50416922  0.52909029  0.55595124  0.58504888]
Iteration 4 [20.2 s]: loss = 0.612360 [80.17 s],
NDCG_rank: [ 0.76889158  0.7552291   0.74962469  0.75017926  0.75418542  0.76168489
  0.77145594  0.78231582  0.79533895  0.80911067]
NDCG_rating1: [ 0.77222511  0.75734001  0.75133206  0.75104463  0.7555335   0.76291386
  0.77283501  0.78393935  0.79657254  0.81010292]
NDCG_rating2: [ 0.3787585   0.39937184  0.41929623  0.43847238  0.45879666  0.47995336
  0.50303888  0.52808508  0.55498679  0.58414632]
Iteration 5 [19.8 s]: loss = 0.607879 [78.17 s],
NDCG_rank: [ 0.76473671  0.75365056  0.74842675  0.748216    0.75317275  0.7608958
  0.77013151  0.78160414  0.794385    0.80817776]
NDCG_rating1: [ 0.77173209  0.75661329  0.75151081  0.75109482  0.75552313  0.76301123
  0.77265575  0.78390583  0.79658765  0.80996603]
NDCG_rating2: [ 0.37895039  0.39938217  0.41878638  0.43827285  0.45799932  0.47990468
  0.50317855  0.52787338  0.55487972  0.58409584]
Iteration 6 [19.9 s]: loss = 0.604698 [80.66 s],
NDCG_rank: [ 0.76555234  0.75337934  0.74829471  0.74840924  0.75263057  0.76023951
  0.76997178  0.78145747  0.7941642   0.80801308]
NDCG_rating1: [ 0.77102179  0.75656595  0.75160675  0.7512268   0.75474914  0.7628719
  0.77234329  0.78369071  0.79647455  0.80986203]
NDCG_rating2: [ 0.38040682  0.39957244  0.4193874   0.43852488  0.45857035  0.48014288
  0.50317428  0.52827524  0.55541619  0.5846459 ]
Iteration 7 [20.3 s]: loss = 0.601644 [80.30 s],
NDCG_rank: [ 0.76633621  0.75176815  0.7470331   0.74782529  0.75172299  0.75953547
  0.7695809   0.78071292  0.79345451  0.80736087]
NDCG_rating1: [ 0.77162769  0.75702473  0.75117233  0.7507288   0.75566664  0.76303665
  0.77266398  0.78370881  0.79633301  0.8098453 ]
NDCG_rating2: [ 0.38181138  0.39947561  0.4197566   0.43924887  0.4589078   0.48045051
  0.50383552  0.52868214  0.55565851  0.5850904 ]
Iteration 8 [20.3 s]: loss = 0.598196 [80.52 s],
NDCG_rank: [ 0.76211312  0.7504119   0.74561903  0.74606959  0.75100837  0.75876622
  0.76818514  0.77978353  0.79238751  0.80622517]
NDCG_rating1: [ 0.77202199  0.75670082  0.75143074  0.75127782  0.75572833  0.76329081
  0.7730002   0.78416186  0.79647797  0.80986096]
NDCG_rating2: [ 0.38253425  0.40233088  0.42213735  0.44205315  0.46243033  0.48455489
  0.50850862  0.53367533  0.56092472  0.59009573]
Iteration 9 [20.1 s]: loss = 0.593638 [80.18 s],
NDCG_rank: [ 0.76044601  0.74864023  0.74363228  0.7444651   0.74918121  0.75713848
  0.76711903  0.77806651  0.79122743  0.80536365]
NDCG_rating1: [ 0.77287661  0.75798833  0.75215684  0.75194988  0.75617646  0.7641043
  0.77356156  0.78459472  0.79706801  0.81045977]
NDCG_rating2: [ 0.38675892  0.40679372  0.42734243  0.44762438  0.46855092  0.49064618
  0.51452916  0.53929184  0.56648057  0.59495716]
Iteration 10 [20.1 s]: loss = 0.588743 [79.72 s],
NDCG_rank: [ 0.75805038  0.74521234  0.7409574   0.74209065  0.74738627  0.75517313
  0.76518967  0.77677666  0.78989021  0.80426004]
NDCG_rating1: [ 0.77287189  0.75744146  0.75238993  0.75200854  0.75681207  0.76425003
  0.77392206  0.78490977  0.79729823  0.81050842]
NDCG_rating2: [ 0.39531076  0.41436411  0.43516846  0.45588029  0.47626091  0.49789981
  0.52124568  0.5456006   0.57192732  0.59997691]
Iteration 11 [20.4 s]: loss = 0.583873 [79.73 s],
NDCG_rank: [ 0.75615343  0.74355334  0.73953777  0.74090899  0.74586757  0.75425764
  0.7642839   0.77630298  0.7892662   0.80333851]
NDCG_rating1: [ 0.77326556  0.7584777   0.75314311  0.75306128  0.75688805  0.76442817
  0.77398015  0.78493222  0.79746368  0.81094293]
NDCG_rating2: [ 0.40284763  0.4220629   0.44145347  0.46136589  0.48198998  0.50292231
  0.52576497  0.54964568  0.5754582   0.6033987 ]
Iteration 12 [20.3 s]: loss = 0.579066 [82.32 s],
NDCG_rank: [ 0.7507616   0.74096248  0.73731805  0.73925319  0.74460499  0.75240859
  0.76262187  0.77473169  0.78788112  0.80229756]
NDCG_rating1: [ 0.77511503  0.75936477  0.75363546  0.75361168  0.75743216  0.76493387
  0.77423305  0.78535967  0.79782415  0.81132079]
NDCG_rating2: [ 0.40900541  0.42595503  0.44600769  0.46545175  0.48520775  0.50588582
  0.52805562  0.55208787  0.57767173  0.60554076]






