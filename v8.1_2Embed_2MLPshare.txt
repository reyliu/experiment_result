liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v8.1_2Embed_share/MLP.py --learner adam --reg_layers [0,0,0,0] --lr 0.00001 --batch_size_random 1280000
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=1280000, epochs=100, layers='[64,32,16,8]', learner='adam', lr=1e-05, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [317.1 s]. #user=13679, #item=12922, #train_user=15651858, #train_item=20462698, #test=316795
Time: [147.3], Init: 
NDCGu: [ 0.55681133  0.56108653  0.56954637  0.57976091  0.59285265  0.60815191
  0.62535542  0.64383637  0.66396302  0.68664638]
NDCGi: [ 0.53819497  0.54720713  0.55693461  0.56841082  0.58013995  0.593701
  0.60770162  0.62314556  0.63939408  0.65704503]
Iteration 0 [74.5 s]: rank_loss = 0.692597 [141.31 s],
NDCGu: [ 0.67933333  0.67429976  0.67578501  0.68100754  0.68879544  0.69890227
  0.71084202  0.7250037   0.74045842  0.75820807]
NDCGi: [ 0.52499944  0.5391768   0.55097254  0.56387176  0.57723152  0.59116836
  0.60552012  0.62149018  0.63772558  0.65539122]
Iteration 0 [80.9 s]: rank_loss = 0.692380 [145.81 s],
NDCGu: [ 0.66265004  0.65992489  0.66135134  0.66713408  0.67434068  0.68539306
  0.69782409  0.71220802  0.72875811  0.74671522]
NDCGi: [ 0.62669735  0.6278306   0.63341469  0.64123854  0.65053686  0.66146318
  0.67322251  0.6862571   0.69976344  0.71432051]
Iteration 1 [74.7 s]: rank_loss = 0.681194 [142.50 s],
NDCGu: [ 0.71620423  0.71353277  0.71436381  0.71839387  0.72521266  0.73479262
  0.7456505   0.75819106  0.77222337  0.78771411]
NDCGi: [ 0.61945047  0.62154349  0.62850434  0.63581742  0.64509538  0.65615221
  0.66726412  0.67982354  0.69362431  0.7082388 ]
Iteration 1 [86.0 s]: rank_loss = 0.682576 [149.37 s],
NDCGu: [ 0.72071503  0.71529647  0.7153154   0.7192076   0.7260495   0.73521479
  0.74596198  0.75890426  0.7731561   0.78818958]
NDCGi: [ 0.65280517  0.65153045  0.65703322  0.66376573  0.67239742  0.68247245
  0.69347891  0.70501225  0.7181075   0.73173141]
Iteration 2 [73.6 s]: rank_loss = 0.643045 [142.42 s],
NDCGu: [ 0.73584189  0.728578    0.72803405  0.73092589  0.73641162  0.74513591
  0.75595259  0.76772471  0.78156822  0.79596298]
NDCGi: [ 0.65444924  0.6533768   0.65829116  0.66484297  0.67360036  0.68342871
  0.69460074  0.70585117  0.71849287  0.73200914]
Iteration 2 [88.0 s]: rank_loss = 0.658053 [146.77 s],
NDCGu: [ 0.73531145  0.72850624  0.72744907  0.73014747  0.73595041  0.74473027
  0.75546047  0.76747833  0.78103801  0.79561376]
NDCGi: [ 0.67136904  0.66724369  0.6700573   0.67515015  0.68235418  0.69199646
  0.70204204  0.71289331  0.72551282  0.7387037 ]
Iteration 3 [73.7 s]: rank_loss = 0.621071 [139.01 s],
NDCGu: [ 0.75245664  0.74117939  0.7380115   0.73919634  0.74373857  0.75176215
  0.76211103  0.77375596  0.78700315  0.80113177]
NDCGi: [ 0.67369053  0.66946396  0.67114659  0.67680868  0.68389177  0.69326994
  0.70310329  0.71430091  0.72622709  0.73948702]
Iteration 3 [85.6 s]: rank_loss = 0.646128 [139.07 s],
NDCGu: [ 0.74844924  0.73887087  0.73627717  0.73787264  0.74260994  0.75067462
  0.76093362  0.77273954  0.78639042  0.80038296]
NDCGi: [ 0.67993717  0.67351628  0.6754031   0.68028592  0.68739717  0.69648786
  0.70607381  0.71690892  0.72849853  0.74171707]
Iteration 4 [71.3 s]: rank_loss = 0.615788 [139.98 s],
NDCGu: [ 0.75765006  0.74439314  0.74051089  0.7412056   0.74569182  0.75373732
  0.76383374  0.77538787  0.78853052  0.80272973]
NDCGi: [ 0.68105626  0.67531608  0.67592782  0.68062415  0.68811251  0.69679682
  0.70630092  0.71714536  0.72887737  0.7422045 ]
Iteration 4 [85.4 s]: rank_loss = 0.642377 [140.32 s],
NDCGu: [ 0.75835753  0.74444328  0.74093569  0.74151156  0.74644702  0.75368528
  0.76368919  0.77541723  0.78878796  0.80301975]
NDCGi: [ 0.68293822  0.67695543  0.67815188  0.68343683  0.68958415  0.6979086
  0.70776878  0.71825668  0.73001164  0.74326878]
Iteration 5 [71.4 s]: rank_loss = 0.613104 [140.57 s],
NDCGu: [ 0.75970926  0.74566884  0.74251191  0.74294036  0.74694417  0.75478499
  0.7648639   0.77643764  0.78940354  0.80367416]
NDCGi: [ 0.68434708  0.67760902  0.67890577  0.68383909  0.69041616  0.69864803
  0.70827921  0.71874085  0.73019572  0.74329879]
Iteration 5 [85.9 s]: rank_loss = 0.640829 [140.81 s],
NDCGu: [ 0.75989069  0.74562036  0.74203765  0.74196582  0.74653207  0.75418041
  0.764294    0.77598786  0.7891922   0.80315265]
NDCGi: [ 0.68550627  0.67932123  0.67932701  0.6844786   0.69101209  0.69965384
  0.70866924  0.71912683  0.73104738  0.7437131 ]
Iteration 6 [71.2 s]: rank_loss = 0.611647 [142.86 s],
NDCGu: [ 0.76030636  0.74610995  0.74276043  0.7428549   0.74765075  0.75506881
  0.76522539  0.77679713  0.78963195  0.80377807]
NDCGi: [ 0.68628143  0.67869514  0.67899247  0.68453858  0.69127007  0.69970891
  0.7084967   0.71896076  0.73085995  0.74373259]
Iteration 6 [84.8 s]: rank_loss = 0.639002 [141.31 s],
NDCGu: [ 0.76032303  0.74595955  0.74273641  0.74284276  0.74685049  0.75483101
  0.76512433  0.77648338  0.78940605  0.8035278 ]
NDCGi: [ 0.68686147  0.67960106  0.67938356  0.68540329  0.69169545  0.70003596
  0.70915226  0.71921685  0.73115633  0.74370925]
Iteration 7 [72.5 s]: rank_loss = 0.610158 [140.89 s],
NDCGu: [ 0.76012022  0.74601553  0.74291885  0.74284092  0.74736321  0.75490856
  0.76489375  0.77647218  0.78943716  0.80358221]
NDCGi: [ 0.68603576  0.67984471  0.68047246  0.68544752  0.69199631  0.70014472
  0.70912966  0.71931937  0.73095033  0.74382841]
Iteration 7 [85.3 s]: rank_loss = 0.638077 [141.25 s],
NDCGu: [ 0.7602724   0.74608175  0.74260371  0.74307234  0.74728938  0.75468443
  0.76483087  0.77654413  0.78941709  0.80345671]
NDCGi: [ 0.68615727  0.68004414  0.68082286  0.68563008  0.69196939  0.70009145
  0.70930898  0.71951477  0.73137062  0.74385301]
Iteration 8 [71.3 s]: rank_loss = 0.607711 [141.34 s],
NDCGu: [ 0.76204673  0.7468374   0.74310044  0.74320023  0.74761643  0.75555657
  0.76534498  0.77674906  0.7897346   0.80359507]
NDCGi: [ 0.68705704  0.68093112  0.6810736   0.68557315  0.69198228  0.70042703
  0.70926456  0.71947804  0.7314491   0.74415892]
Iteration 8 [84.7 s]: rank_loss = 0.636273 [141.08 s],
NDCGu: [ 0.76152698  0.74628607  0.74233955  0.74290691  0.74717507  0.75532922
  0.76489734  0.77634076  0.78942103  0.80345169]
NDCGi: [ 0.68381981  0.68056558  0.67937118  0.68420607  0.69108064  0.69956029
  0.70885375  0.71873527  0.73041583  0.74328187]
Iteration 9 [71.2 s]: rank_loss = 0.606674 [141.10 s],
NDCGu: [ 0.76183449  0.74614621  0.74185147  0.74282802  0.74719324  0.75495141
  0.76486452  0.77633618  0.78930571  0.8034775 ]
NDCGi: [ 0.68383711  0.68020503  0.67946631  0.68432396  0.6910027   0.69926951
  0.70872666  0.71869147  0.73051087  0.74348469]
Iteration 9 [84.6 s]: rank_loss = 0.634837 [141.29 s],
NDCGu: [ 0.76256522  0.74638897  0.74225615  0.74248734  0.74714593  0.75473393
  0.76486896  0.77635293  0.78906726  0.80333112]
NDCGi: [ 0.68319676  0.68007817  0.67952354  0.68424435  0.69091887  0.69931284
  0.70831892  0.71837673  0.73029067  0.74350305]
Iteration 10 [71.2 s]: rank_loss = 0.604586 [145.36 s],
NDCGu: [ 0.76126191  0.74648113  0.74222702  0.74229564  0.74692288  0.75469406
  0.76469012  0.77628265  0.78908896  0.80339833]
NDCGi: [ 0.68361582  0.68025297  0.67982672  0.68447497  0.69079578  0.69932918
  0.70821077  0.71826634  0.73031282  0.74345702]
Iteration 10 [86.2 s]: rank_loss = 0.633152 [141.19 s],
NDCGu: [ 0.76149239  0.74616472  0.74176232  0.74161182  0.74628158  0.75435469
  0.7643173   0.77596881  0.78863018  0.80327311]
NDCGi: [ 0.68403704  0.67967147  0.68009339  0.68455925  0.69071266  0.69949155
  0.7085742   0.7185266   0.73053855  0.74354796]
Iteration 11 [71.2 s]: rank_loss = 0.603310 [141.30 s],
NDCGu: [ 0.76171689  0.74642262  0.7415869   0.74140923  0.74621375  0.7543538
  0.76423522  0.77592699  0.78896022  0.80282543]
NDCGi: [ 0.68430489  0.6793138   0.68027746  0.68464544  0.69118669  0.69951413
  0.7084195   0.71841983  0.73045413  0.74352843]
Iteration 11 [85.3 s]: rank_loss = 0.631272 [141.03 s],
NDCGu: [ 0.76179801  0.74728309  0.74197345  0.7414351   0.74620362  0.7540739
  0.76399851  0.77571956  0.78889318  0.80291911]
NDCGi: [ 0.68459979  0.68015388  0.68006079  0.68500184  0.69062106  0.69952954
  0.7085325   0.7185903   0.7302772   0.74345113]
Iteration 12 [74.4 s]: rank_loss = 0.600906 [150.10 s],
NDCGu: [ 0.76331199  0.7475003   0.74201932  0.74189002  0.74619828  0.75397684
  0.76424001  0.77561749  0.78848303  0.80290334]
NDCGi: [ 0.68577805  0.67967855  0.68004003  0.68476884  0.69119072  0.69949224
  0.70847351  0.7185877   0.73020664  0.74337684]
Iteration 12 [86.9 s]: rank_loss = 0.629213 [141.22 s],
NDCGu: [ 0.76229167  0.74741367  0.7417915   0.74180126  0.74597425  0.75395758
  0.76390458  0.7752768   0.78859056  0.80271295]
NDCGi: [ 0.68348849  0.67908809  0.67938144  0.68405678  0.69036133  0.69879533
  0.70768142  0.71818561  0.72976411  0.74285003]
Iteration 13 [71.5 s]: rank_loss = 0.598865 [143.48 s],
NDCGu: [ 0.76309598  0.74802892  0.74124574  0.74143933  0.74540839  0.75341972
  0.76338011  0.77531961  0.78836608  0.8024959 ]
NDCGi: [ 0.68378554  0.67977784  0.67990855  0.68442125  0.69105918  0.69882504
  0.70764952  0.71824023  0.72972191  0.74287208]
Iteration 13 [84.9 s]: rank_loss = 0.627814 [141.18 s],
NDCGu: [ 0.76193448  0.74712697  0.7412978   0.74086231  0.74485741  0.75278863
  0.76279296  0.77476786  0.78806314  0.80213208]
NDCGi: [ 0.68220804  0.67946284  0.67934407  0.68403005  0.69023686  0.6984287
  0.70720906  0.71760966  0.72969053  0.74281911]
Iteration 14 [71.5 s]: rank_loss = 0.597541 [141.30 s],
NDCGu: [ 0.76110973  0.74573654  0.74137881  0.74114719  0.74465225  0.75274141
  0.76278914  0.77470542  0.78796862  0.80197785]
NDCGi: [ 0.68302375  0.67929314  0.67871418  0.68396147  0.68992865  0.69781494
  0.70692046  0.7176945   0.72933607  0.74249771]
Iteration 14 [85.9 s]: rank_loss = 0.626169 [141.36 s],
NDCGu: [ 0.76184486  0.74643106  0.74132252  0.74109862  0.74474177  0.75232279
  0.76265906  0.7742762   0.78773872  0.80199187]
NDCGi: [ 0.68272353  0.67893282  0.67881091  0.68374246  0.69001327  0.69785012
  0.70675669  0.71710297  0.72898223  0.74248936]
Iteration 15 [71.5 s]: rank_loss = 0.595795 [141.61 s],
NDCGu: [ 0.7618543   0.74639966  0.74054369  0.74092794  0.74443984  0.75221838
  0.76247469  0.7744551   0.78755402  0.80174579]
NDCGi: [ 0.68033191  0.67894461  0.67907502  0.683713    0.68989068  0.69790551
  0.70688278  0.71726689  0.72902932  0.74228674]
Iteration 15 [84.8 s]: rank_loss = 0.624842 [141.58 s],
NDCGu: [ 0.76047615  0.74588446  0.74048478  0.74052317  0.74381222  0.75188299
  0.76213388  0.77399319  0.78741081  0.80143906]
NDCGi: [ 0.68240551  0.67782667  0.67774764  0.68272873  0.68924739  0.69728128
  0.70631533  0.71677034  0.72878656  0.74181142]
Iteration 16 [71.2 s]: rank_loss = 0.594569 [141.85 s],
NDCGu: [ 0.76084624  0.74609962  0.74034146  0.74008233  0.74396173  0.75205544
  0.76239025  0.7739421   0.78717265  0.80147033]
NDCGi: [ 0.68070574  0.67782355  0.67845316  0.68258911  0.6892154   0.69712074
  0.70632551  0.7164297   0.72844905  0.74167093]
Iteration 16 [84.5 s]: rank_loss = 0.622641 [141.65 s],
NDCGu: [ 0.76076794  0.74580459  0.74012749  0.73997719  0.74371537  0.75173034
  0.76202482  0.77356768  0.78673553  0.80103008]
NDCGi: [ 0.68096542  0.67635394  0.6770647   0.68187248  0.68863385  0.69652032
  0.70593944  0.71625792  0.72805093  0.74147091]
Iteration 17 [70.9 s]: rank_loss = 0.592120 [141.67 s],
NDCGu: [ 0.76055759  0.74620721  0.7397522   0.73958393  0.74399391  0.75160936
  0.76172567  0.77334512  0.78701354  0.80087827]
NDCGi: [ 0.6809931   0.67713834  0.67752994  0.68212917  0.68872486  0.69673457
  0.70558972  0.71609289  0.7282387   0.74147164]
Iteration 17 [85.0 s]: rank_loss = 0.620738 [141.32 s],
NDCGu: [ 0.75988503  0.74584089  0.73942099  0.73923445  0.7437224   0.75135253
  0.76157105  0.77334269  0.78668442  0.80092673]
NDCGi: [ 0.68082085  0.676826    0.67682161  0.6810554   0.68825966  0.69625316
  0.70512073  0.71586993  0.72790999  0.74101858]
Iteration 18 [70.9 s]: rank_loss = 0.589942 [142.00 s],
NDCGu: [ 0.76101508  0.74564422  0.73948795  0.73937247  0.74353143  0.75100357
  0.76137887  0.77295983  0.78668561  0.80078273]
NDCGi: [ 0.68110732  0.67700526  0.6770953   0.68146959  0.68819249  0.696298
  0.70559739  0.7160779   0.72795572  0.74095224]
Iteration 18 [85.7 s]: rank_loss = 0.618648 [141.58 s],
NDCGu: [ 0.76094214  0.74524633  0.73921716  0.73918421  0.74318511  0.75091263
  0.76098544  0.77281101  0.78603366  0.80043884]
NDCGi: [ 0.68161273  0.67575561  0.67652735  0.68183867  0.68843682  0.69567767
  0.70537067  0.71577453  0.72755767  0.74079318]
Iteration 19 [71.6 s]: rank_loss = 0.588225 [140.90 s],
NDCGu: [ 0.76161313  0.74443511  0.73839428  0.73858367  0.74289758  0.75025899
  0.76051995  0.77261495  0.78591412  0.80016884]
NDCGi: [ 0.6808147   0.67494709  0.67660726  0.68157496  0.68806019  0.695866
  0.70519746  0.71581747  0.72765431  0.74047744]
Iteration 19 [84.9 s]: rank_loss = 0.616414 [141.67 s],
NDCGu: [ 0.76081722  0.74447426  0.73891062  0.73877609  0.74295281  0.7503303
  0.76034711  0.77216033  0.78578345  0.7999111 ]
NDCGi: [ 0.68288982  0.67591078  0.67694064  0.68104377  0.68792901  0.69574912
  0.70499202  0.71582712  0.72732364  0.74051004]
Iteration 20 [71.1 s]: rank_loss = 0.585654 [142.05 s],
NDCGu: [ 0.76073547  0.74470464  0.73814822  0.73847254  0.74246655  0.75000233
  0.76034425  0.77214617  0.78537381  0.79986231]
NDCGi: [ 0.68251244  0.67462142  0.67602439  0.68032267  0.68784351  0.69525925
  0.70452592  0.71533288  0.72728771  0.74028088]
Iteration 20 [85.3 s]: rank_loss = 0.613811 [141.36 s],
NDCGu: [ 0.75847252  0.74326904  0.73792895  0.73774383  0.74195235  0.7494096
  0.75972594  0.77148512  0.7847983   0.79925541]
NDCGi: [ 0.68148407  0.67602472  0.67702253  0.68035573  0.68713974  0.69521227
  0.70477629  0.71552031  0.72710097  0.73999388]
Iteration 21 [71.0 s]: rank_loss = 0.583536 [141.70 s],
NDCGu: [ 0.76212978  0.74438524  0.73751279  0.73793469  0.74178761  0.74947049
  0.75983477  0.77171104  0.78491915  0.79946748]
NDCGi: [ 0.68269033  0.67573661  0.67662274  0.68026576  0.68715936  0.69494629
  0.70453801  0.7155725   0.72705389  0.74009125]
Iteration 21 [85.7 s]: rank_loss = 0.610925 [143.64 s],
NDCGu: [ 0.75927759  0.74340544  0.73683242  0.73704159  0.74169663  0.74884964
  0.7594564   0.7711308   0.7845716   0.79917862]
NDCGi: [ 0.68475987  0.67587542  0.67679441  0.68082508  0.68669917  0.69474105
  0.70446924  0.71560566  0.72719971  0.74020176]

