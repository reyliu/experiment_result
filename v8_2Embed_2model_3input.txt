liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v8_2Embed/MLP.py --learner adam --reg_layers [0,0,0,0] --lr 0.00001 --batch_size_random 1280000
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=1280000, epochs=100, layers='[64,32,16,8]', learner='adam', lr=1e-05, path='Data/yelp/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [315.5 s]. #user=13679, #item=12922, #train_user=15651858, #train_item=20462698, #test=316795
Time: [140.4], Init: 
NDCGu: [ 0.5601918   0.56436136  0.57203276  0.58241911  0.5954195   0.61046047
  0.62703058  0.64544642  0.66590939  0.68830196]
NDCGi: [ 0.5304236   0.54050119  0.55166416  0.5634143   0.57634396  0.59021293
  0.60445235  0.62033882  0.63660386  0.65401409]
Iteration 0 [72.7 s]: rank_loss = 0.692204 [137.10 s],
NDCGu: [ 0.67116855  0.67003463  0.67317608  0.67939872  0.68859995  0.69974897
  0.71285233  0.72697688  0.74261745  0.76027064]
NDCGi: [ 0.53145058  0.53929411  0.54960862  0.56218128  0.57531379  0.58940209
  0.60365937  0.61917312  0.63568526  0.6533846 ]
Iteration 0 [78.7 s]: rank_loss = 0.692700 [137.14 s],
NDCGu: [ 0.67170905  0.66973825  0.67289065  0.67925778  0.68867237  0.69979074
  0.71259871  0.72682979  0.74273007  0.76000624]
NDCGi: [ 0.58814586  0.59611556  0.60535947  0.61567688  0.62736258  0.63965675
  0.65287649  0.666728    0.68114906  0.6970535 ]
Iteration 1 [73.1 s]: rank_loss = 0.676456 [137.17 s],
NDCGu: [ 0.7015503   0.70553354  0.7085737   0.71373551  0.72234236  0.73241836
  0.7440048   0.75657129  0.7704423   0.78569463]
NDCGi: [ 0.59176357  0.59941277  0.60755405  0.6168717   0.62805077  0.64053748
  0.65340994  0.66725898  0.68201186  0.69774877]
Iteration 1 [85.2 s]: rank_loss = 0.687447 [137.81 s],
NDCGu: [ 0.70100823  0.70476201  0.70760541  0.71329166  0.72187851  0.73190475
  0.7435865   0.75622141  0.7700931   0.78559386]
NDCGi: [ 0.63270884  0.63940621  0.64614372  0.65384502  0.66326048  0.6743248
  0.68597671  0.69818504  0.71149119  0.72527129]
Iteration 2 [72.0 s]: rank_loss = 0.641279 [138.65 s],
NDCGu: [ 0.72854211  0.72451611  0.7251548   0.72836673  0.73557976  0.74387756
  0.75494501  0.76709593  0.78042392  0.79500235]
NDCGi: [ 0.63796245  0.64199901  0.64819439  0.65637511  0.6654272   0.67623057
  0.68745833  0.69937994  0.71268256  0.72657684]
Iteration 2 [84.7 s]: rank_loss = 0.666881 [136.40 s],
NDCGu: [ 0.72605969  0.72229189  0.72355755  0.72687607  0.73395229  0.74252754
  0.75374568  0.76589521  0.77953965  0.79427673]
NDCGi: [ 0.65543631  0.65679478  0.6607461   0.66814299  0.67662797  0.68609599
  0.69691189  0.70873102  0.72146197  0.73456176]
Iteration 3 [72.3 s]: rank_loss = 0.621986 [137.41 s],
NDCGu: [ 0.74303414  0.73610531  0.73528265  0.73633729  0.74148381  0.7499573
  0.76036059  0.77181195  0.78508445  0.79947461]
NDCGi: [ 0.65438     0.65743486  0.66150088  0.66895344  0.67786203  0.68689275
  0.69724113  0.70936388  0.72199365  0.73527636]
Iteration 3 [83.7 s]: rank_loss = 0.648851 [136.05 s],
NDCGu: [ 0.73986061  0.73422568  0.73349359  0.7350707   0.74056892  0.74910765
  0.75938527  0.77098307  0.78435555  0.79860192]
NDCGi: [ 0.66691503  0.66612543  0.66956947  0.67598083  0.68369719  0.69227767
  0.70187829  0.71358131  0.72583234  0.73913605]
Iteration 4 [71.7 s]: rank_loss = 0.615242 [136.91 s],
NDCGu: [ 0.75284433  0.74147605  0.73890793  0.74000585  0.74406786  0.7523434
  0.76261487  0.77409408  0.78720876  0.80142546]
NDCGi: [ 0.66573677  0.66643404  0.66993635  0.67630625  0.68424681  0.69274974
  0.70254831  0.71408377  0.72623829  0.73938327]
Iteration 4 [85.3 s]: rank_loss = 0.643672 [137.51 s],
NDCGu: [ 0.75146493  0.74098339  0.73819663  0.738965    0.74353728  0.75149081
  0.76190819  0.77376794  0.7867353   0.80098717]
NDCGi: [ 0.67396097  0.67249131  0.6748424   0.67976423  0.68633893  0.69491665
  0.70491732  0.71564683  0.72803048  0.74138973]
Iteration 5 [71.1 s]: rank_loss = 0.612943 [137.54 s],
NDCGu: [ 0.75839652  0.7439017   0.74147587  0.74160266  0.74543319  0.7535309
  0.76380354  0.77500253  0.78854874  0.80272537]
NDCGi: [ 0.67476141  0.67264921  0.6758012   0.68010048  0.68678856  0.69520845
  0.7050132   0.71645727  0.72871244  0.74182696]
Iteration 5 [89.3 s]: rank_loss = 0.641319 [156.43 s],
NDCGu: [ 0.7561254   0.74340543  0.74065641  0.74105623  0.74501138  0.75304102
  0.76306909  0.77470996  0.78792637  0.80238451]
NDCGi: [ 0.68022922  0.67461036  0.67731396  0.68158335  0.68828097  0.69671722
  0.70643948  0.71737037  0.72917783  0.74203518]
Iteration 6 [76.3 s]: rank_loss = 0.611399 [155.32 s],
NDCGu: [ 0.75820252  0.74544506  0.74145539  0.74155181  0.74589453  0.75398338
  0.76365319  0.77542015  0.78867926  0.80276119]
NDCGi: [ 0.68070593  0.67434166  0.67741562  0.6817566   0.68835588  0.69665166
  0.70635249  0.71753955  0.72928727  0.74225677]
Iteration 6 [89.4 s]: rank_loss = 0.640136 [156.68 s],
NDCGu: [ 0.75779407  0.74479494  0.74110942  0.74148459  0.74567404  0.7536452
  0.76330934  0.77503734  0.78824532  0.80239075]
NDCGi: [ 0.68074185  0.67554206  0.67741046  0.68210261  0.68921989  0.69773971
  0.70689852  0.71806598  0.7295699   0.74273267]
Iteration 7 [75.8 s]: rank_loss = 0.609498 [143.59 s],
NDCGu: [ 0.75949199  0.74601747  0.74159691  0.74202212  0.74628783  0.75410418
  0.76388398  0.77552253  0.78887756  0.80298044]
NDCGi: [ 0.68182692  0.67595358  0.67757164  0.68248332  0.68958252  0.69810632
  0.70713258  0.71797073  0.7298645   0.74294473]
Iteration 7 [85.4 s]: rank_loss = 0.638261 [137.06 s],
NDCGu: [ 0.75914549  0.74533344  0.74176493  0.74173665  0.74585515  0.75381784
  0.76378867  0.77545254  0.78863906  0.80272948]
NDCGi: [ 0.68438579  0.67759497  0.67829699  0.6836761   0.6904917   0.69886183
  0.7079667   0.71823091  0.73029291  0.74312585]
Iteration 8 [71.3 s]: rank_loss = 0.607878 [137.67 s],
NDCGu: [ 0.76000608  0.74596126  0.74193285  0.74142353  0.74624604  0.75411095
  0.76398914  0.77601434  0.78894349  0.80300676]
NDCGi: [ 0.68353657  0.67741736  0.67826813  0.68373362  0.6903066   0.69875361
  0.70807794  0.71843142  0.73034599  0.74343417]
Iteration 8 [84.4 s]: rank_loss = 0.636806 [136.92 s],
NDCGu: [ 0.76002966  0.74613526  0.74174487  0.74122101  0.74574459  0.75379903
  0.76380705  0.77569264  0.7887736   0.80299596]
NDCGi: [ 0.68409526  0.67767498  0.67831371  0.6833599   0.68978624  0.69814324
  0.70780077  0.71855231  0.73020291  0.74325374]
Iteration 9 [71.3 s]: rank_loss = 0.606182 [137.07 s],
NDCGu: [ 0.760135    0.7455081   0.74156914  0.74178455  0.74579966  0.75370439
  0.76364716  0.77566262  0.78895508  0.80296954]
NDCGi: [ 0.68603297  0.67881231  0.67904466  0.68383891  0.69014036  0.69853601
  0.70800575  0.71898548  0.73049446  0.74350103]
Iteration 9 [85.1 s]: rank_loss = 0.635526 [137.20 s],
NDCGu: [ 0.75971555  0.74538317  0.74156799  0.74166995  0.74546085  0.75356769
  0.7635507   0.77529792  0.78858659  0.80274828]
NDCGi: [ 0.68745836  0.67953061  0.67986653  0.68451995  0.69048971  0.69842158
  0.70762593  0.71885639  0.73035708  0.74350119]
Iteration 10 [71.6 s]: rank_loss = 0.604633 [140.06 s],
NDCGu: [ 0.76187253  0.74647     0.74185907  0.74187537  0.74620899  0.75414364
  0.76380033  0.77564121  0.78879463  0.80301377]
NDCGi: [ 0.68691868  0.67914702  0.67986079  0.68439252  0.69080298  0.69875902
  0.7076642   0.71889453  0.73045909  0.74334727]
Iteration 10 [85.3 s]: rank_loss = 0.634650 [136.90 s],
NDCGu: [ 0.76123581  0.74588371  0.74149139  0.74135573  0.74577438  0.7535856
  0.76335584  0.77527173  0.7884196   0.80283198]
NDCGi: [ 0.68543234  0.6796179   0.67922914  0.6836574   0.69088149  0.69832665
  0.70767802  0.71831117  0.73000924  0.74342428]
Iteration 11 [71.3 s]: rank_loss = 0.603368 [136.86 s],
NDCGu: [ 0.76105942  0.74582781  0.74138063  0.74114233  0.74549673  0.75311006
  0.76312575  0.7748881   0.78838342  0.80239905]
NDCGi: [ 0.68531666  0.68034056  0.68001024  0.68400076  0.69115737  0.69857652
  0.70794851  0.71854459  0.73035368  0.74363038]
Iteration 11 [84.5 s]: rank_loss = 0.632329 [136.87 s],
NDCGu: [ 0.7597429   0.74539012  0.74079614  0.74060096  0.7451152   0.75287199
  0.76304535  0.77462732  0.78808623  0.80211937]
NDCGi: [ 0.68762523  0.68033591  0.68060978  0.68457125  0.69151724  0.69874571
  0.70833719  0.71886573  0.73058304  0.7437762 ]
Iteration 12 [71.6 s]: rank_loss = 0.601629 [136.72 s],
NDCGu: [ 0.76038245  0.74530795  0.74139266  0.74144485  0.7454164   0.7529766
  0.7630662   0.77512144  0.78819235  0.80230612]
NDCGi: [ 0.68787585  0.68037448  0.68063231  0.68443894  0.69141415  0.69906663
  0.70839746  0.71901574  0.73062817  0.74389245]
Iteration 12 [85.7 s]: rank_loss = 0.630366 [142.04 s],
NDCGu: [ 0.76007777  0.7450366   0.74092211  0.74124927  0.74480201  0.75271045
  0.76289878  0.77478707  0.78793312  0.80213797]
NDCGi: [ 0.68883016  0.68074772  0.68033832  0.68419731  0.69138644  0.69946459
  0.70819411  0.71903936  0.73087207  0.74351665]
Iteration 13 [72.7 s]: rank_loss = 0.600337 [137.94 s],
NDCGu: [ 0.76104244  0.74536623  0.7414306   0.74117962  0.74512898  0.75289732
  0.76318976  0.77488173  0.78809662  0.80224775]
NDCGi: [ 0.68853615  0.68025655  0.67961796  0.68417299  0.69136275  0.69933204
  0.70813804  0.71878735  0.73045909  0.74319619]
Iteration 13 [85.2 s]: rank_loss = 0.629035 [138.70 s],
NDCGu: [ 0.75966618  0.74515101  0.74098028  0.74098067  0.74454548  0.75244063
  0.76288434  0.77450422  0.78775703  0.80199993]
NDCGi: [ 0.68557742  0.67851103  0.67946902  0.68395247  0.69056652  0.6987847
  0.70759239  0.71802813  0.73008168  0.74296227]
Iteration 14 [71.2 s]: rank_loss = 0.598113 [136.51 s],
NDCGu: [ 0.76168482  0.74606842  0.74056887  0.7412506   0.74517753  0.75265464
  0.76290784  0.77489309  0.7881332   0.80226815]
NDCGi: [ 0.68572673  0.67929071  0.67953429  0.68396485  0.69104807  0.69895713
  0.70775887  0.71818225  0.73022597  0.7432098 ]
Iteration 14 [84.7 s]: rank_loss = 0.626260 [137.49 s],
NDCGu: [ 0.7606994   0.74607383  0.7404214   0.74054704  0.74463428  0.75200721
  0.76261831  0.77456271  0.7877519   0.80191013]
NDCGi: [ 0.68567795  0.67983774  0.67999271  0.68405859  0.69035887  0.6989722
  0.70759126  0.71866972  0.73022544  0.74327193]
Iteration 15 [71.3 s]: rank_loss = 0.596635 [137.21 s],
NDCGu: [ 0.76090319  0.74483151  0.74040956  0.74063906  0.7446383   0.75218631
  0.76245894  0.77415243  0.78756492  0.80149085]
NDCGi: [ 0.68641586  0.67996579  0.67994315  0.68431354  0.69064741  0.6988962
  0.70777223  0.71852546  0.73034661  0.74350683]
Iteration 15 [84.7 s]: rank_loss = 0.624030 [141.48 s],
NDCGu: [ 0.76122795  0.74453854  0.73981083  0.7401921   0.74447801  0.75203974
  0.76210845  0.7740542   0.78713514  0.80103894]
NDCGi: [ 0.68734174  0.6803278   0.68025115  0.684263    0.69108293  0.69872696
  0.70813041  0.71877427  0.73033204  0.74313983]

